<link rel="import" href="../../bower_components/polymer/polymer.html"/>
<link rel="import" href="px-demo-theme-util.html"/>

<script>
  (function(){
    /*
     * Each element `origin` should be the protocol + hostname + port (if other
     * than 80) where both the iFrame and parent will be hosted. This cannot
     * be dynamic to prevent cross-site scripting attacks. When developing,
     * comment out the 'https://www.predix-ui.com' origin and set the variable
     * to the origin you develop from (e.g. 'http://localhost:8000').
     *
     * Make sure the origin is changed back before pushing changes or this will
     * not work in production.
     */

    function inFrame() {
      try { return window.self !== window.top; }
      catch (e) { return true; }
    };

    Polymer({
      is: 'px-demo-theme-switcher',

      properties: {
        isDarkTheme: {
          type: Boolean,
          value: false,
          observer: '_themeChanged'
        }
      },

      _themeChanged: function(isDarkTheme, wasDarkTheme) {
        if (isDarkTheme === false && typeof wasDarkTheme === 'undefined') {
          return;
        }
        if (isDarkTheme && !wasDarkTheme) {
          var darkTheme = PxDemo.ThemeUtil.getDarkThemeProperties();
          if (darkTheme === null) {
            console.log('Dark theme not loaded. Try again later.');
            return;
          }
          Polymer.updateStyles(darkTheme);
        }
        else if (!isDarkTheme && wasDarkTheme) {
          var defaultTheme = PxDemo.ThemeUtil.getDefaultThemeProperties();
          if (defaultTheme === null) {
            console.log('Theme not loaded. Try again later.');
            return;
          }
          Polymer.updateStyles(defaultTheme);
        }
      }
    });

  })();
</script>
