<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="import" href="px-context-browser-actions.html"><link rel="import" href="css/px-context-browser-item-styles.html"></head><body><dom-module id="px-context-browser-item"><template><style include="px-context-browser-item-styles"></style><template is="dom-if" if="[[!styleAsFavorite]]"><section class="context-browser-item" asset-action="activate"><div class="context-browser-text"><div class="context-browser-text__label regular">[[label]]</div></div><div class="actions"><template is="dom-if" if="[[canFavorite]]"><px-context-browser-action-favorite class="action" active$="{{favorited}}" asset-action="favorite"></px-context-browser-action-favorite></template><template is="dom-if" if="[[canSelect]]"><px-context-browser-action-select class="action" asset-action="select"></px-context-browser-action-select></template><template is="dom-if" if="[[canOpen]]" restamp=""><px-context-browser-action-open class="action action--open" asset-action="activate"></px-context-browser-action-open></template></div></section></template><template is="dom-if" if="[[styleAsFavorite]]"><section class="context-browser-item" asset-action="select"><div class="context-browser-text"><div class="context-browser-text__label regular">[[label]]</div><div id="breadcrumbs" class="context-browser-text__breadcrumbs context-browser-label--breadcrumbs zeta">[[_truncatedBreadcrumbs]]</div></div><div class="actions"><template is="dom-if" if="[[canFavorite]]"><px-context-browser-action-favorite class="action" active$="{{favorited}}" asset-action="favorite"></px-context-browser-action-favorite></template></div></section></template></template></dom-module><script>Polymer({is:'px-context-browser-item',behaviors:[Polymer.IronResizableBehavior],properties:{label:{type:String},breadcrumbs:{type:Array},_breadcrumbsFontStyles:{type:Object},_breadcrumbsWidth:{type:Number},_truncatedBreadcrumbs:{type:String,computed:'_computeTruncatedBreadcrumbs(breadcrumbs, _breadcrumbsFontStyles, _breadcrumbsWidth)'},selected:{type:Boolean,value:!1,reflectToAttribute:!0},favorited:{type:Boolean,value:!1},styleAsFavorite:{type:Boolean,value:!1,reflectToAttribute:!0},canSelect:{type:Boolean,value:!1},canOpen:{type:Boolean,value:!1},canFavorite:{type:Boolean,value:!1},visible:{type:Boolean,value:!0}},observers:['_handleFavoritesItemVisible(visible, styleAsFavorite)'],listeners:{"iron-resize":'_handleResize'},_handleFavoritesItemVisible(a,b){a&&b&&this._updateBreadcrumbsInfo()},_handleResize(){this.visible&&this.styleAsFavorite&&this._updateBreadcrumbsInfo()},_updateBreadcrumbsInfo(){this.debounce('update-breadcrumbs-width',()=>{window.requestAnimationFrame(()=>{setTimeout(()=>{if(!this._breadcrumbsWidth||!this.__breadcrumbsFontStyles){const a=Polymer.dom(this.root).querySelector('#breadcrumbs');if(!a)return;this._breadcrumbsFontStyles=this._getFontStyles(a),this._breadcrumbsWidth=a.getBoundingClientRect().width}})})},5)},_computeTruncatedBreadcrumbs(a,b,c){if(a&&b&&c)return this._truncateBreadcrumbs(a,b,c)},_getFontStyles(a){var b=window.getComputedStyle(a),c=b.fontSize,d=b.fontFamily;return{size:c,family:d}},_truncateBreadcrumbs(a,b,c){if(!a.length)return'';const d=this._getTextWidth('\u2026 > ',b),e=this._getTextWidth(' > ',b),f=a.length;for(let d=f;0<d;){let e=a.slice(-1*d),g=e.join(' > ');d<f&&1<f&&(g='... > '+g);let h=this._getTextWidth(g,b);if(c>h)return g;d--}let g=1<f?'... > ':'';return g+a[f-1]},_getTextWidth(a,b){var c=this._textMeasureCanvas=this._textMeasureCanvas?this._textMeasureCanvas:document.createElement('canvas'),d=c.getContext('2d');return d.font=b.size+' '+b.family,Math.round(d.measureText(a).width)}});</script></body></html>