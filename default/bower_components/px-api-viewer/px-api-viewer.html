<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-location/iron-location.html"><link rel="import" href="../iron-doc-viewer/iron-doc-element.html"><link rel="import" href="../iron-ajax/iron-ajax.html"><link rel="import" href="css/px-api-viewer-styles.html"><link rel="import" href="find-polyfill.html"></head><body><dom-module id="px-api-viewer"><template><iron-ajax auto="" url="[[_getAPIUrl(source, apiSourceFilePath)]]" handle-as="json" on-response="_handleResponse"></iron-ajax><style include="iron-doc-default-theme"></style><style include="px-api-viewer-styles"></style><iron-location hash="{{_hash}}"></iron-location><iron-doc-element id="doc" descriptor="[[_targetElementDescriptor]]" base-href="[[_getBaseHref(disableHashPrefix)]]" fragment-prefix="[[_getFragmentPrefix(source, pagePath)]]"></iron-doc-element></template></dom-module><script>Polymer({is:'px-api-viewer',properties:{_elementDescriptor:{type:Object,notify:!0},source:{type:String,value:'',notify:!0},apiSourceFilePath:{type:String,value:''},hide:{type:Array,value:function(){return[]}},markPrivate:{type:Array,value:function(){return[]}},markReadOnly:{type:Array,value:function(){return[]}},changeDescription:{type:Array,value:function(){return[]}},disableHashPrefix:{type:Boolean,value:!1},pagePath:{type:String,value:''},_targetElementDescriptor:{type:Object},_anchor:{type:String,value:'',computed:'_getAnchorFromHash(_hash)',observer:'_tryScrollToAnchor'},_baseHref:{type:String},_elementDescriptorTrigger:{type:Number,value:0}},observers:['_getTargetElementDesc(source, _elementDescriptor, _elementDescriptorTrigger)'],attached:function(){this._handlePageLoaded=this._handlePageLoaded||this._handlePageLoaded.bind(this),window.addEventListener('page-loaded',this._handlePageLoaded,!1)},detached:function(){window.removeEventListener('page-loaded',this._handlePageLoaded,!1)},_cleanAPIDocs:function(){var a=this._elementDescriptor.elements.find(function(a){return a.tagname===this.source},this);return['methods','properties'].forEach(function(b){var c=a[b];c=this._hideAPI(c),c=this._changeDescription(c),c.forEach(function(a){this._markReadOnly(a),this._markPrivate(a)},this),a[b]=c},this),a},_hideAPI:function(a){var b=[];return b=a.filter(function(a){return-1===this.hide.indexOf(a.name)}.bind(this)),b},_markPrivate:function(a){-1!==this.markPrivate.indexOf(a.name)&&(a.privacy='protected')},_markReadOnly:function(a){-1!==this.markReadOnly.indexOf(a.name)&&(a.metadata.polymer.readOnly=!0)},_changeDescription:function(a){return this.changeDescription.forEach(function(b){var c=a.find(function(a){return b.name===a.name});c&&(c.description=b.desc)}),a},_handleResponse:function(a){var b=a.target.lastResponse;this._elementDescriptor=b,this._cleanAPIDocs(),this.set('_elementDescriptor',b),this.set('_elementDescriptorTrigger',this._elementDescriptorTrigger++),this.fire('pxElementAPIReceived',b[15])},_getAPIUrl:function(){var a=this.importPath.substr(0,this.importPath.indexOf(this.tagName.toLowerCase()));return this.apiSourceFilePath?a+this.apiSourceFilePath:a+this.source+'/'+this.source+'-api.json'},_handlePageLoaded:function(){},_tryScrollToAnchor:function(){},_getAnchorFromHash:function(a){return a&&''!==a&&-1!==a.indexOf(':')?a.split(':')[1]:''},_getTargetElementDesc:function(a,b){'object'===typeof this._targetElementDescriptor&&(this._targetElementDescriptor={});let c;a===void 0||b===void 0||(c=b.elements.filter(function(b){return b.name===a||b.tagname===a})[0]),this.set('_targetElementDescriptor',c)},_getFragmentPrefix:function(a,b){return''===b?''===window.location.hash?'':-1<window.location.hash.indexOf(':')?window.location.hash.slice(1).split(':')[0]+':':window.location.hash.slice(1)+':':b},_getBaseHref:function(a){return a?'':'#'}});</script></body></html>