(function(){'use strict';const a=window.PxAppBehavior=window.PxAppBehavior||{},b={properties:{items:{type:Array},keys:{type:Object,value:function(){return{id:'id',label:'label',children:'children',icon:'icon'}}},_assetGraph:{type:Object,value:null},__rootItems:{type:Array}},observers:['__handleAssetReferenceChanged(items, keys)','__handleKeyUpdated(keys.*)'],created(){this._createAssetGraph=d.assetGraph.bind(this)},__handleAssetReferenceChanged:function(a,b){if('object'===typeof a&&Array.isArray(a))return null!==this._assetGraph&&('function'===typeof this.activate&&this.activate(null),'function'===typeof this.select&&this.select(null),'function'===typeof this.favorite&&this.favorite(null)),this._assetGraph=this._createAssetGraph(),this._assetGraph.addChildren(null,a,{recursive:!0,childrenKey:b.children}),this.__rootItems=a.slice(0),this.fire('px-app-asset-graph-created',{graph:this._assetGraph}),this._assetGraph},__handleKeyUpdated:function(a){this._assetGraph&&('keys.children'===a.path&&this.__handleAssetReferenceChanged(this.items,this.keys),'keys.id'===a.path&&('function'===typeof this.activate&&this.activate(null),'function'===typeof this.select&&this.select(null),'function'===typeof this.favorite&&this.favorite(null)))},addChildren(a,b,c){if(null!==this._assetGraph){if(this._assetGraph.addChildren(a,b,Object.assign({},{recursive:!0,childrenKey:this.keys.children},c||{})),null===a){let a=Array.isArray(b)?b:[b];this.__rootItems=this.__rootItems.concat(a)}this.fire('px-app-asset-children-updated',null===a?{item:null,added:b,children:this.__rootItems}:Object.assign({},this._assetGraph.getInfo(a),{added:b}))}},removeChildren(a,b,c){if(null!==this._assetGraph){const d=Array.isArray(b)?b:[b];if('function'===typeof this.activate||'function'===typeof this.select){let a,b;for(let c=0;c<d.length;c++)!a&&'function'===typeof this.activate&&this.activeMeta&&(this.activeMeta.item===d[c]||this.activeMeta.path&&-1<this.activeMeta.path.indexOf(d[c]))&&(this.activate(null),a=!0),!b&&'function'===typeof this.select&&this.selectedMeta&&(this.selectedMeta.item===d[c]||this.selectedMeta.path&&-1<this.selectedMeta.path.indexOf(d[c]))&&(this.select(null),a=!0)}this._assetGraph.removeChildren(a,b,c),null===a&&(this.__rootItems=this.__rootItems.filter((a)=>-1===d.indexOf(a))),this.fire('px-app-asset-children-updated',null===a?{item:null,removed:b,children:this.__rootItems}:Object.assign({},this._assetGraph.getInfo(a),{removed:b}))}}};a.AssetGraph=b;class c{constructor(){this._options={},this._defaultKeys={id:'id',children:'children'},this._tree=new SymbolTree,this._rootNode={ROOT:!0},this._symbol=Symbol('AssetGraph data')}_node(a){const b=a[this._symbol];return b?b:a[this._symbol]={isExhausted:null,isTerminal:null,isSelectable:null}}_getKey(a,b){return b&&'string'===typeof b&&b.length?b:this._defaultKeys[a]}hasNode(a){return!!(-1<this._tree.index(a))}getInfo(a,b){if(-1<this._tree.index(a)){const d=this._getKey('id',b),e=this.getPath(a),f=e?c.pathToRoute(e,d):null,g=this.getParent(a),h=this.getSiblings(a),i=this.getChildren(a),j='object'===typeof i&&Array.isArray(i)&&0<i.length,k=this.isTerminal(a),l=this.isExhausted(a),m=this.isSelectable(a);return{item:a,path:e,route:f,parent:g,siblings:h,children:i,hasChildren:j,isTerminal:k,isExhausted:l,isSelectable:m}}return null}getParent(a){if(a&&-1<this._tree.index(a)){const b=this._tree.parent(a);return b===this._rootNode?null:b}return null}hasSiblings(a){var b=this.getSiblings(a);return b&&1<b.length}getSiblings(a){return a&&-1<this._tree.index(a)?this._tree.childrenToArray(this._tree.parent(a)):null}getPath(a){return a&&-1<this._tree.index(a)?this._tree.ancestorsToArray(a).reverse().slice(1):null}getRoute(a,b){if(a&&-1<this._tree.index(a)){const d='string'===typeof b&&b.length?b:this._defaultKeys.id,e=this.getPath(a);return e?c.pathToRoute(e,d):null}return null}getNodeAtRoute(a,b){if('object'!==typeof a||!Array.isArray(a)||!a.length)throw new Error('An array of route strings is required.');const c='string'===typeof b&&b.length?b:this._defaultKeys.id;let d=a.slice(0),e=this._tree.childrenToArray(this._rootNode).slice(0),f=null;for(;!f&&0<e.length&&0<d.length;){let a=e.shift();if(a[c]===d[0]&&0<this._tree.childrenCount(a)&&1!==d.length){d.shift(),e=this._tree.childrenToArray(a).slice(0);continue}if(a[c]===d[0]&&1===d.length){f=a;break}}return f}getChildren(a){const b=null===a?this._rootNode:a;return b&&(b.ROOT||-1<this._tree.index(b))?this._tree.childrenToArray(b):null}getRootChildren(){const a=this._rootNode;return a?this._tree.childrenToArray(a):null}hasChildren(a){const b=null===a?this._rootNode:a;return b&&(b.ROOT||-1<this._tree.index(b))?0<this._tree.childrenCount(b):null}addChildren(a,b,c){if('object'!==typeof b||Array.isArray(b)&&!b.length)throw new Error('A child object or array of child objects is required.');if(null!==a&&'object'===typeof a&&!this.hasNode(a))throw new Error('The parent node must be a node in the graph or null.');const d=null===a?this._rootNode:a,e=Array.isArray(b)?b:[b],f='object'===typeof c&&'string'===typeof c.childrenKey&&c.childrenKey.length?c.childrenKey:this._defaultKeys.children,g='object'===typeof c&&'boolean'===typeof c.recursive&&c.recursive;for(let h=0;h<e.length;h++){const a=this._node(e[h]);a.isTerminal=e[h].hasOwnProperty('isTerminal')?e[h].isTerminal:null,a.isExhausted=e[h].hasOwnProperty('isExhausted')?e[h].isExhausted:null,a.isSelectable=e[h].hasOwnProperty('isSelectable')?e[h].isSelectable:null,this._tree.appendChild(d,e[h]),g&&'object'===typeof e[h][f]&&Array.isArray(e[h][f])&&e[h][f].length&&this.addChildren(e[h],e[h][f],{recursive:!0,childrenKey:f})}if('object'===typeof c&&'boolean'===typeof c.isExhausted){const a=c.isExhausted,b=this._node(d);b.isExhausted=a}if('object'===typeof c&&'boolean'===typeof c.isSelectable){const a=c.isSelectable,b=this._node(d);b.isSelectable=a}return this.getChildren(d)}removeChildren(a,b){if('object'!==typeof b||Array.isArray(b)&&!b.length)throw new Error('A child object or array of child objects is required.');if(null!==a&&'object'===typeof a&&!this.hasNode(a))throw new Error('The parent node must be a node in the graph or null.');const c=null===a?this._rootNode:a,d=Array.isArray(b)?b:[b];for(let e=0;e<d.length;e++){if(!this.hasNode(d[e]))throw new Error('Child node(s) cannot be removed from the graph if it they were never added');if(null!==a&&this.getParent(d[e])!==c||null==a&&null!==this.getParent(d[e]))throw new Error('Child node(s) passed to "removeChildren" method must be children of the given parent');this._tree.remove(d[e])}}isExhausted(a){const b=null===a?this._rootNode:a;if(b&&(b.ROOT||-1<this._tree.index(b))){const a=this._node(b);return a&&!0===a.isExhausted}return null}setExhausted(a,b){const c=null===a?this._rootNode:a;if(c&&(c.ROOT||-1<this._tree.index(c))){const a=this._node(c);return a.isExhausted=b,b}return null}isTerminal(a){if(null===a)return!1;if(-1<this._tree.index(a)){const b=this._node(a);return b&&!0===b.isTerminal}return null}setTerminal(a,b){if(null===a)throw new Error('The root node can never be terminal, it must have children.');if(-1<this._tree.index(a)){const c=this._node(a);return c.isTerminal=b,b}return null}isSelectable(a){const b=null===a?this._rootNode:a;if(b&&(b.ROOT||-1<this._tree.index(b))){const a=this._node(b);return a&&!1===a.isSelectable?!1:!0}return null}setSelectable(a,b){const c=null===a?this._rootNode:a;if(c&&(c.ROOT||-1<this._tree.index(c))){const a=this._node(c);return a.isSelectable=b,b}return null}static pathToRoute(a,b){return a.map((a)=>'string'===typeof a[b]&&a[b].length?a[b]:null)}}const d=window.PxApp=window.PxApp||{};d.AssetGraph=c,d.assetGraph=function(a){return new c(a)}})();