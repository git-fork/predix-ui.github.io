<html><head><link rel="import" href="../px-d3-imports/px-d3-imports.html"><link rel="import" href="px-vis-imports.html"><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="px-vis-scheduler.html"><link rel="import" href="../iron-meta/iron-meta.html"><script>var PxVisBehaviorD3=PxVisBehaviorD3||{};PxVisBehaviorD3.svg=[{properties:{svg:{type:Object,notify:!0},pxSvgElem:{type:Object,notify:!0}},generateRandomID:function(a){for(var b=a,c='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',d=c.length,e=0;10>e;e++)b+=c.charAt(Math.floor(Math.random()*d));return(Px.uniqueIds=Px.uniqueIds||[],-1!==Px.uniqueIds.indexOf(b))?this.generateRandomID(a):(Px.uniqueIds.push(b),b)},cloneSVGElem:function(a,b,c){var d=a,e=d.cloneNode();c&&0!==d.parentNode.childNodes.length?d.parentNode.insertBefore(e,d.parentNode.firstChild):d.parentNode.appendChild(e),this.set(b,Px.d3.select(e))},_drawSVGOnCanvas:function(a,b,c,d,e){var f=b.outerHTML,g=getComputedStyle(b).getPropertyValue('opacity'),h=a.globalAlpha,i=a.getContext('2d');d=d?d:0,e=e?e:0,i.globalAlpha=g,f||(f=this._getSVGOuterHtml(b));var j,k,l=document.createElement('canvas');k=function(){this._drawCanvg(a,f,d,e,function(){i.globalAlpha=h,c(this.resultCanvas)})}.bind(this),j=function(b){try{b.toDataURL(),this._nativeDrawSvgOnCanvas(a,f,d,e,function(){i.globalAlpha=h,c(a)},function(){this._drawCanvg(a,f,d,e,function(){i.globalAlpha=h,c(this.resultCanvas)})}.bind(this))}catch(b){this._drawCanvg(a,f,d,e,function(){i.globalAlpha=h,c(this.resultCanvas)})}}.bind(this),this._nativeDrawSvgOnCanvas(l,'<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><div></div></svg>',d,e,j,k)},_drawCanvg:function(a,b,c,d,e){canvg(a,b,{ignoreDimensions:!0,ignoreClear:!0,renderCallback:e,offsetX:c,offsetY:d,resultCanvas:a})},_nativeDrawSvgOnCanvas:function(a,b,c,d,e,f){var g=window.URL||window.webkitURL||window,h=new Blob([b],{type:'image/svg+xml;charset=utf-8'}),i=g.createObjectURL(h),j=new Image;j.onload=function(){try{a.getContext('2d').drawImage(j,c,d),g.revokeObjectURL(i)}catch(b){return void f(a)}e(a)},j.onerror=function(){f(a)}.bind(this),j.src=i},_getSVGOuterHtml:function(a){for(var b=function(a,c){var d=a.nodeType;if(3==d)c.push(a.textContent.replace(/&/,'&amp;').replace(/</,'&lt;').replace('>','&gt;'));else if(1==d){if(c.push('<',a.tagName),a.hasAttributes())for(var e,f=a.attributes,g=0,h=f.length;g<h;++g)e=f.item(g),c.push(' ',e.name,'=\'',e.value,'\'');if(a.hasChildNodes()){c.push('>');for(var i=a.childNodes,g=0,h=i.length;g<h;++g)b(i.item(g),c);c.push('</',a.tagName,'>')}else c.push('/>')}else if(8==d)c.push('<!--',a.nodeValue,'-->');else throw'Error serializing XML. Unhandled node of type: '+d},c=[],d=a.firstChild;d;)b(d,c),d=d.nextSibling;return'<svg xmlns="'+a.attributes.xmlns.value+'" width="'+a.attributes.width.value+'" height="'+a.attributes.height.value+'">'+c.join('')+'</svg>'}},PxVisBehavior.svgDefinition,PxVisBehavior.uniqueIds],PxVisBehaviorD3.svgLower=[{properties:{pxSvgElemLower:{type:Object,notify:!0}}},PxVisBehavior.svgLowerDefinition],PxVisBehaviorD3.canvasContext=[{properties:{canvasContext:{type:Object,notify:!0},canvasLayers:{type:Object,notify:!0,value:function(){return{}}}}},PxVisBehavior.canvasLayersConfig],PxVisBehaviorD3.canvas=[{properties:{renderToSvg:{type:Boolean,value:!1}},observers:['_renderToSvgChanged(renderToSvg)'],_renderToSvgChanged:function(){this.hasUndefinedArguments(arguments)||(this.renderToSvg&&this.canvasContext&&this.canvasContext.pxClearCanvas&&this.canvasContext.pxClearCanvas(),this._isAttached&&Polymer.dom.flush())}},PxVisBehavior.observerCheck,PxVisBehaviorD3.canvasContext,PxVisBehavior.isAttached],PxVisBehaviorD3.renderToCanvas=[{properties:{renderToCanvas:{type:Boolean,value:!1,observer:'_renderToCanvasChanged'}},_renderToCanvasChanged:function(){this.hasUndefinedArguments(arguments)||(!this.renderToCanvas&&this.canvasContext&&this.canvasContext.pxClearCanvas&&this.canvasContext.pxClearCanvas(),this._isAttached&&Polymer.dom.flush())}},PxVisBehavior.observerCheck,PxVisBehavior.isAttached],PxVisBehaviorD3.axes=[{properties:{x:{type:Object,notify:!0},y:{type:Object,notify:!0},isMultiY:{type:Boolean,readOnly:!0,computed:'_getIsMultiY(y.*)'}},_getIsMultiY:function(){return this.hasUndefinedArguments(arguments)?void 0:'object'===typeof this.y},_processYValues:function(a){if(a=a.bind(this),this.isMultiY){for(var b={},c=Object.keys(this.y),d=0;d<c.length;d++)b[c[d]]=a(this.y[c[d]],c[d]);return b}return b=a(this.y),b}},PxVisBehavior.observerCheck],PxVisBehaviorD3.domainUpdate={properties:{domainChanged:{type:Boolean,value:null}}},PxVisBehaviorD3.domainUpdateNotify={properties:{domainChanged:{type:Boolean,notify:!0,value:null}}},PxVisBehaviorD3.axisOrientation={properties:{orientation:{type:String,value:'left'}}},PxVisBehaviorD3.axis=[{properties:{axis:{type:Object},orientation:{type:String,value:'bottom'}}},PxVisBehaviorD3.axisOrientation],PxVisBehaviorD3.selectedDomain={properties:{selectedDomain:{type:Object,value:function(){return{x:[],y:[]}},notify:!0}}},PxVisBehaviorD3.selectedTimeDomain=[{properties:{range:{type:Object,notify:!0},_preventDomainUpdate:{type:Boolean,value:!1},_preventRangeUpdate:{type:Boolean,value:!1}},observers:['_rangeChanged(range)'],attached:function(){this._isAttached=!0},_rangeChanged:function(){if(!this.hasUndefinedArguments(arguments)&&this._isAttached&&!this._preventRangeUpdate){this._preventDomainUpdate=!0;var a={},b={};a.x=[],a.x[0]=+Px.moment(this.range.from,Px.moment.ISO_8601).format('x'),a.x[1]=+Px.moment(this.range.to,Px.moment.ISO_8601).format('x'),b.y=this.dataExtents&&0<this.dataExtents.y.length?this.dataExtents.y:[Infinity,-Infinity],b.x=a.x,this.set('dataExtents',b),this._preventDomainUpdate=!1}}},PxVisBehavior.observerCheck,PxVisBehaviorD3.selectedDomain],PxVisBehaviorD3.clipPathBoolean={properties:{clipPath:{type:Boolean,value:!1}}},PxVisBehaviorD3.clipPath={properties:{clipPath:{type:String,notify:!0},seriesClipPath:{type:String,notify:!0}},addClipPath:function(a){'undefined'!==typeof this.clipPath&&this._doesD3HaveValues(a)&&a.attr('clip-path','url(#'+this.clipPath+')')}},PxVisBehaviorD3.dynamicRedraw={properties:{redrawSeries:{type:Boolean,value:!1},redrawElems:{type:Array,value:function(){return[]}},dynamicRedraw:{type:Boolean,value:!1}}},PxVisBehaviorD3.labelTypeSize={properties:{labelTypeSize:{type:Number,value:12}}},PxVisBehaviorD3.axisConfig=[{properties:{title:{type:String,value:''},labelPosition:{type:String,value:'center'},labelRotation:{type:Number,value:0},labelTranslation:{type:Array,value:function(){return[0,0]}},series:{type:Array,value:function(){return[]}},translateAmt:{type:Array,value:function(){return[0,0]}},titleLocation:{type:Object,value:function(){return{}}},titleTypeSize:{type:Number,value:15},strokeWidth:{type:Number,value:1},outerTickSize:{type:Number,value:0},tickValues:{type:Array},ticks:{type:Object},axisColor:{type:String,value:''},drawnTickValues:{type:Array,notify:!0}}},PxVisBehaviorD3.labelTypeSize],PxVisBehaviorD3.labelTypeSize={properties:{labelTypeSize:{type:Number,value:12}}},PxVisBehaviorD3.advAxisConfig={properties:{}},PxVisBehaviorD3.radialAxisConfig={properties:{centerOffset:{type:Number,value:0,notify:!0}}},PxVisBehaviorD3.interpolationFunction={properties:{interpolationFunction:{type:Function},_basicInterpolators:{type:Object,value:function(){return{curveBasis:Px.d3.curveBasis,curveBasisClosed:Px.d3.curveBasisClosed,curveBasisOpen:Px.d3.curveBasisOpen,curveLinear:Px.d3.curveLinear,curveLinearClosed:Px.d3.curveLinearClosed,curveMonotoneX:Px.d3.curveMonotoneX,curveMonotoneY:Px.d3.curveMonotoneY,curveNatural:Px.d3.curveNatural,curveStep:Px.d3.curveStep,curveStepAfter:Px.d3.curveStepAfter,curveStepBefore:Px.d3.curveStepBefore}}}},_checkInterpolation:function(){var a=null;return a='string'===typeof this.interpolationFunction&&this._basicInterpolators[this.interpolationFunction]?this._basicInterpolators[this.interpolationFunction]:a,a='function'===typeof this.interpolationFunction?this.interpolationFunction:a,a=this.completeSeriesConfig[this.seriesId].interpolationFunction&&'string'===typeof this.completeSeriesConfig[this.seriesId].interpolationFunction&&this._basicInterpolators[this.completeSeriesConfig[this.seriesId].interpolationFunction]?this._basicInterpolators[this.completeSeriesConfig[this.seriesId].interpolationFunction]:a,a=this.completeSeriesConfig[this.seriesId].interpolationFunction&&'function'===typeof this.completeSeriesConfig[this.seriesId].interpolationFunction?this.completeSeriesConfig[this.seriesId].interpolationFunction:a,a}},PxVisBehaviorD3.lineRadiusLimit={properties:{lineRadiusLimit:{type:Number}}},PxVisBehaviorD3.radialLineGenerator=[{properties:{line:{type:Object},lineRadiusLimit:{type:Number}},_defineRadialLine:function(a,b,c,d){var e,f,g=this,h=JSON.parse(JSON.stringify(this.completeSeriesConfig[this.seriesId].x)),i=c?-1:1;if(b)'bofCompleteManually'===this.interpolationFunction&&h.push(h[0]),e=Px.d3.radialLine().angle(function(a){return g.x(a[0])*i}).radius(function(a){var b=~~g.y(+a[1]);return'number'===typeof g.lineRadiusLimit&&b<g.lineRadiusLimit?g.lineRadiusLimit:b}).defined(function(a){return g._isValidData(g.x(a[0]))&&g._isValidData(g.y(+a[1]))}),f=function(a){return e(h.map(function(b){return a&&'undefined'!==typeof a[b]&&null!==a[b]&&[b,a[b]]}))};else{var j,k=this.completeSeriesConfig[this.seriesId].x,l=this.completeSeriesConfig[this.seriesId].y;j=d?function(a){return a[k]/180*Math.PI*i}:function(a){return a[k]*i},e=Px.d3.radialLine().angle(function(a){return j(a)}).radius(function(a){return g.y(a[l])}).defined(function(a){return g._isValidData(a[k])&&g._isValidData(a[l])}),f=function(a){return e(a)}}var m=this._checkInterpolation();m&&e.curve(m),'undefined'!==typeof a&&a&&e.context(this.canvasContext),this.set('line',f)}},PxVisBehavior.completeSeriesConfig,PxVisBehavior.dataset,PxVisBehaviorD3.interpolationFunction,PxVisBehaviorD3.lineRadiusLimit],PxVisBehaviorD3.lineGaps={properties:{showGaps:{type:Boolean,value:!1}}},PxVisBehaviorD3.lineShared=[{properties:{parallelCoordinates:{type:Boolean,value:!1},radialLine:{type:Boolean,value:!1},gradientLine:{type:Boolean,value:!1},gradientRange:{type:Array,computed:'_computeGradientRange(chartData.*,timeDomain.*,seriesId)'},_colorArr:{type:Array,computed:'_computeColorArr(categories,completeSeriesConfig,seriesId)'},multiPath:{type:Boolean,value:!1},_currentDrawingOptions:{type:Object,value:function(){return{lastPointRenderedIndex:null,currentBatchStartIndex:0}}}},_resetRenderingContext:function(){this._currentDrawingOptions.lastPointRenderedIndex=null,this._currentDrawingOptions.currentBatchStartIndex=0},_computeColorArr:function(a,b,d){if(!this.hasUndefinedArguments(arguments)){var e=b[d].color.split('(')[1].split(','),c={};if(c[d]={r:+e[0],g:+e[1],b:+e[2].split(')')[0]},0<a.length)for(var f=0;f<a.length;f++)b[a[f]]&&(e=b[a[f]].color.split('(')[1].split(','),c[a[f]]={r:+e[0],g:+e[1],b:+e[2].split(')')[0]});return c}},_opacityLine:function(a){var b=(this.gradientRange[1]-a[this.seriesId])/(this.gradientRange[1]-this.gradientRange[0]);return 1-0.8*b},_computeGradientRange:function(a,b,c){if(!this.hasUndefinedArguments(arguments)&&0<a.value.length){var d,e;return b.value&&b.value.x&&0<b.value.x.length?(d=+b.value.x[0],e=+b.value.x[1]):(d=+a.value[0][c],e=+a.value[a.value.length-1][c]),[d,e]}},_removeGaps:function(){},_defineSingleLine:function(a){var b,c=this,e='undefined'!==typeof a&&a,f=c.completeSeriesConfig[c.seriesId].x,g=c.completeSeriesConfig[c.seriesId].y;b=this.showGaps?Px.d3.line().x(function(a){return~~c.x(a[f])}).y(function(a){return~~c.y(a[g])}).defined(function(a){return c._isValidData(a[g])}):Px.d3.line().x(function(a){return(a[f]||0===a[f])&&(a[g]||0===a[g])?~~c.x(a[f]):e?void 0:~~c.x(c.chartData[c._currentDrawingOptions.lastPointRenderedIndex][f])}).y(function(a,b){return(a[f]||0===a[f])&&(a[g]||0===a[g])?(c._currentDrawingOptions.lastPointRenderedIndex=c._currentDrawingOptions.currentBatchStartIndex+b,~~c.y(a[g])):e?void 0:~~c.y(c.chartData[c._currentDrawingOptions.lastPointRenderedIndex][g])}).defined(function(a){return null===c._currentDrawingOptions.lastPointRenderedIndex?c._isValidData(a[g]):c._isDataNotNull(a[g])});var d=this._checkInterpolation();d&&b.curve(d),e&&b.context(this.canvasContext),this.set('line',b)},_defineMultiLine:function(a){var b=this.completeSeriesConfig[this.seriesId].x,c=Px.d3.line().defined(function(a){return a}),d=function(a){return c(b.map(function(b){return a&&(a[b]||0===a[b])&&[~~this.x(b),~~this.y[b](a[b])]}.bind(this)))}.bind(this),e=this._checkInterpolation();e&&c.curve(e),'undefined'!==typeof a&&a&&c.context(this.canvasContext),this.set('line',d)}},PxVisBehavior.observerCheck,PxVisBehaviorD3.radialLineGenerator,PxVisBehavior.seriesId,PxVisBehaviorD3.lineGaps,PxVisBehaviorD3.interpolationFunction,PxVisBehavior.timeDomain],PxVisBehaviorD3.serieToRedrawOnTopSVG=[{_drawSVGOnTop:function(a,b,c){a===b&&c.raise()}},PxVisBehavior.serieToRedrawOnTop,PxVisBehaviorD3.svg],PxVisBehaviorD3.radialPixelCalc={calcPixelCoordForRadial:function(a,b,c,d,e){var f=d[1]-d[0],g=c*(b-d[0])/f;return a=this.adjustAngleForPolarChart(a,!1),'x'===e?Math.sin(a)*g:Math.cos(a)*g},adjustAngleForPolarChart:function(a,b){var c=Math.PI,d=b?180:c;return(!this.counterClockwise&&!b||this.counterClockwise&&b)&&(a*=-1),this.useDegrees?b?a+d:2*(a/360)*c+d:b?360*(a/(2*c))+d:a+d}},PxVisBehaviorD3.scatterMarkers={properties:{markerMapping:{type:Object,readOnly:!0,value:{circle:Px.d3.symbolCircle,cross:Px.d3.symbolCross,diamond:Px.d3.symbolDiamond,square:Px.d3.symbolSquare,"triangle-up":Px.d3.symbolTriangle,star:Px.d3.symbolStar,wye:Px.d3.symbolWye,bar:{draw:function(a,b){var c=Math.sqrt(b),d=c/4;a.rect(-c,-d,c,d)}},caret:{draw:function(a,b){var c=1.7320508075688772,d=-Math.sqrt(b/(3*c));a.moveTo(0,2*d),a.lineTo(-c*d,-d),a.lineTo(0,2*d),a.lineTo(c*d,-d),a.closePath()}},"thin-bar":{draw:function(a,b){var c=Math.sqrt(b),d=c/16;a.rect(-c,-d,c,d)}},"thick-bar":{draw:function(a,b){var c=Math.sqrt(b),d=c/2;a.rect(-c,-d,c,d)}},x:{draw:function(a,b){var d=0.5,e=0.01,f=Math.sqrt(b)/2;a.moveTo(0,-e),a.lineTo(f-d,-f+d),a.lineTo(f+d,-f-d),a.lineTo(e,0),a.lineTo(f+d,f+d),a.lineTo(f-d,f-d),a.lineTo(0,e),a.lineTo(-f+d,f-d),a.lineTo(-f-d,f+d),a.lineTo(-e,0),a.lineTo(-f-d,-f-d),a.lineTo(-f+d,-f+d),a.closePath()}}}},markerSymbol:{type:String},markerScale:{type:Number},markerSize:{type:Number},markerFillOpacity:{type:Number},markerStrokeOpacity:{type:Number},mutedOpacity:{type:Number}}},PxVisBehaviorD3.icons={properties:{_meta:{value:Polymer.Base.create('iron-meta',{type:'iconset'})},_iconSize:{type:Number,value:16},_iconScale:{type:Number,value:16},_iconCallbackQueue:{type:Array,value:function(){return[]}},_debugIconWarning:{type:Boolean,value:!1},_iconsLoadedBound:Function},ready:function(){this._iconsLoadedBound=this._iconsLoaded.bind(this)},_iconsLoaded:function(){window.removeEventListener('iron-iconset-added',this._iconsLoadedBound),console.warn('New iconset loaded. Trying again.'),this._iconCallbackQueue.forEach(function(a){a.bind(this)()}.bind(this))},_waitForIconsLoaded:function(){window.addEventListener('iron-iconset-added',this._iconsLoadedBound)},_getIcon:function(a,b,c,d){var e,f=a.split(':'),g=f[0]&&f[1]?f[0]:c,h=f[0]&&f[1]?f[1]:d,i=this._meta.byKey(g);return i?(this._debugIconWarning&&(this._debugIconWarning=!1,console.warn('Set '+g+' successfully loaded')),e=Polymer.dom(i).querySelector('[id="'+h+'"]'),e||(console.warn('Cant find icon named: '+this._thisConfig.icon),e=Polymer.dom(i).querySelector('[id="'+d+'"]')),this._iconSize=i.size,this._iconScale=this._calcIconScale(this._iconSize,b),e.cloneNode(!0)):(console.warn('Cant find set named: '+g+'. Waiting for set to load...'),this._debugIconWarning=!0,this._waitForIconsLoaded(),null)},_calcIconScale:function(a,b){return b/a}},PxVisBehaviorD3.cursorIcon=[{ready:function(){this._iconCallbackQueue=[this._drawCursorIcon]},_drawCursorIcon:function(){if(!this.hasUndefinedArguments(arguments)&&this.iconType&&'none'!==this.iconType){this._doesD3HaveValues(this._icon)&&this._icon.remove();var a=this._getIcon(this.iconType,12,'px-utl','information');a&&(this._icon=Px.d3.select(this._cursorGroup.node().appendChild(a)).attr('fill','transparent').attr('stroke',this._checkThemeVariable('--px-vis-cursor-line-color','rgb(0,0,0)')).attr('pointer-events','none'))}},_positionCursorIcon:function(a){var b=a[0]+5,c=a[1]-this._iconSize,d=' scale('+this._iconScale+')';this._icon.attr('transform','translate('+b+','+c+')'+d)}},PxVisBehavior.observerCheck,PxVisBehaviorD3.icons],PxVisBehaviorD3.scatterArrow={properties:{showArrows:{type:Boolean,value:!1},arrowConfig:{type:Boolean,value:function(){return{symbol:'caret',size:24,scale:1,minLength:10}}}}};</script></head><body></body></html>