<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="px-vis-behavior-d3.html"><link rel="import" href="css/px-vis-styles.html"></head><body><dom-module id="px-vis-canvas"><template><style include="px-vis-styles"></style><canvas id="chartCanvas" width="[[width]]" height="[[height]]"></canvas></template></dom-module><script>Polymer({is:'px-vis-canvas',behaviors:[PxVisBehavior.observerCheck,PxVisBehavior.sizing,PxVisBehavior.commonMethods,PxVisBehaviorD3.canvasContext],properties:{_canvas:{type:Object}},observers:['_setCanvas(width,height,margin,offset.*)'],attached:function(){this._doesObjHaveValues(this.canvasContext)&&this.fire('px-vis-canvas-context-updated',{data:this.canvasContext,dataVar:'canvasContext',method:'set'})},detached:function(){this.canvasContext&&this.canvasContext.pxClearCanvas()},_setCanvas:function(){this.hasUndefinedArguments(arguments)||this.width&&this.height&&this._doesObjHaveValues(this.margin)&&(this.canvasContext?this._reCenterCanvas():this._createCanvaContext())},_reCenterCanvas:function(){this.canvasContext.setTransform(1,0,0,1,0,0),this.canvasContext.translate(this.margin.left+this.offset[0],this.margin.top+this.offset[1]),this.canvasContext._translation=[this.margin.left+this.offset[0],this.margin.top+this.offset[1]],this.fire('px-vis-canvas-context-updated',{data:this.canvasContext,dataVar:'canvasContext',method:'set'})},_createCanvaContext:function(){var a;this._canvas=this.$.chartCanvas,a=this._canvas.getContext('2d'),a.setTransform(1,0,0,1,0,0),a.translate(this.margin.left+this.offset[0],this.margin.top+this.offset[1]),a._translation=[this.margin.left+this.offset[0],this.margin.top+this.offset[1]],a.pxClearCanvas=function(){this.save(),this.setTransform(1,0,0,1,0,0),this.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}.bind(a),this.set('canvasContext',a),this.fire('px-vis-canvas-context-updated',{data:a,dataVar:'canvasContext',method:'set'})}});</script></body></html>