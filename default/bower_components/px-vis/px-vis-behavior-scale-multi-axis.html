<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="px-vis-behavior-chart.html"><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="px-vis-behavior-d3.html"><script>var PxVisBehaviorScale=PxVisBehaviorScale||{};PxVisBehaviorScale.scaleMultiAxis=[{properties:{_usedChartExtents:{type:Object,value:function(){return{}}}},listeners:{"px-vis-request-pixel-for-data":'_pixelRequest'},_recreateScales:function(){this.x&&this._setXScale(this.width,this.margin,!0),this.y&&this._setYScale(this.height,this.margin,this.axes)},_setXScale:function(a,b,c){if(!this.hasUndefinedArguments(arguments)){var d=Math.max(a-b.left-b.right,0),e=[0,d];if(this.x&&!c){var f=this.x.domain();this.x=Px.d3.scalePoint().range(e).domain(f).padding(0.5)}else this.x=Px.d3.scalePoint().range(e).padding(0.5);this.notifyPath('x.range',this.x.range),this.fire('px-vis-x-updated',{dataVar:'x',data:this.x,method:'set'})}},_setYScale:function(a,b,c){if(!this.hasUndefinedArguments(arguments)){for(var d=Math.max(a-b.top-b.bottom,0),e=[d,0],f={},g=0;g<c.length;g++)f[c[g]]=Px.d3.scaleLinear().range(e);this.set('y',f),this.fire('px-vis-y-updated',{dataVar:'y',data:this.y,method:'set'})}},_calcDimExtent:function(a,b,c,d){var e=Object.keys(this.mutedSeriesCategories).filter(function(a){return this.mutedSeriesCategories[a]}.bind(this)),f=this.hardMute&&!!e.length,g=function(b){return f&&-1!==e.indexOf(b[this.categoryKey])?void 0:+b[a]}.bind(this);c&&d?b.y[a]=Px.d3.extent(this.chartData,g):c?b.y[a][0]=Px.d3.min(this.chartData,g):d&&(b.y[a][1]=Px.d3.max(this.chartData,g)),b.y[a][0]||0===b.y[a][0]||(b.y[a][1]||0===b.y[a][1]?b.y[a][0]=b.y[a][1]-1:(b.y[a][0]=0,b.y[a][1]=1)),b.y[a][1]||0===b.y[a][1]||(b.y[a][0]||0===b.y[a][0]?b.y[a][1]=b.y[a][0]+1:(b.y[a][0]=0,b.y[a][1]=1)),b.y[a][0]===b.y[a][1]&&(b.y[a][0]-=0.5,b.y[a][1]+=0.5)},_generateDataExtents:function(){if(this.dimensions&&0!==this.dimensions.length&&!this.hasUndefinedArguments(arguments)){var a={},b={x:this.dimensions,y:{}};if(!this.chartExtents){for(var c=0;c<this.dimensions.length;c++)this._calcDimExtent(this.dimensions[c],b,!0,!0);if(this.commonAxis)for(var d=d3.extent(d3.merge(d3.values(b.y))),c=0;c<this.dimensions.length;c++)b.y[this.dimensions[c]]=d}else{for(var e,f,g=Number.MIN_VALUE,h=Number.MAX_VALUE,c=0;c<this.dimensions.length;c++)e=!1,f=!1,this.chartExtents[this.dimensions[c]]?(b.y[this.dimensions[c]]=[],'dynamic'===this.chartExtents[this.dimensions[c]][0]||this.chartExtents[this.dimensions[c]][0]===Infinity?e=!0:(b.y[this.dimensions[c]][0]=this.chartExtents[this.dimensions[c]][0],a[this.dimensions[c]]=!0),'dynamic'===this.chartExtents[this.dimensions[c]][1]||this.chartExtents[this.dimensions[c]][1]===-Infinity?f=!0:(b.y[this.dimensions[c]][1]=this.chartExtents[this.dimensions[c]][1],a[this.dimensions[c]]=!0)):(e=!0,f=!0),this._calcDimExtent(this.dimensions[c],b,e,f),this.commonAxis&&(g=Math.max(g,b.y[this.dimensions[c]][1]),h=Math.min(h,b.y[this.dimensions[c]][0]));if(this.commonAxis)for(var c=0;c<this.dimensions.length;c++)b.y[this.dimensions[c]]=[h,g]}this._usedChartExtents=a,this.set('dataExtents',b)}},_setDomain:function(){this.hasUndefinedArguments(arguments)||this._doesObjHaveValues(this.x)&&this._doesObjHaveValues(this.y)&&this._doesObjHaveValues(this.dataExtents)&&this.debounce('settingDomain',function(){var a=this.dataExtents.x;exts=this.dataExtents;for(var b=0;b<a.length;b++){if(!this.y[a[b]])return;this.y[a[b]].domain(exts.y[a[b]]),(!this._usedChartExtents[a[b]]||this.commonAxis)&&this.y[a[b]].nice(),this.matchTicks&&!this.commonAxis&&this._squareOffTicks(this.y[a[b]],a[b])}this.x.domain(exts.x),this.set('domainChanged',!(null!==this.domainChanged)||!this.domainChanged)},5)},_squareOffTicks:function(a){a.ticks();if(11!==a.ticks.length){var b=a.domain(),c=10*Math.floor(b[0]/10),d=10*Math.ceil(b[1]/10);a.domain([c,d])}},_updateDomain:function(a){if(!(this._isObjEmpty(this.y)||this._isObjEmpty(a.value))){for(var b=Object.keys(a.value),c=0;c<b.length;c++)this.y[b[c]].domain(a.value[b[c]]);this.set('domainChanged',!this.domainChanged)}},getPixelFromData:function(a,b,c){var d,e,f=c?c:this.margin,g=!1;return(a<this.y[b].domain()[0]||a>this.y[b].domain()[1])&&(g=!0),d=this.x(b)+f.left,e=this.y[b](a)+f.top,{pixel:[d,e],outOfBounds:g}},getDataFromPixel:function(a,b){return[b,this.y[b].invert(a[1])]},_pixelRequest:function(a){var b=this.getPixelFromData(a.detail.data[1],a.detail.series,a.detail.margin);a.detail.callback(b)}},PxVisBehaviorD3.svg,PxVisBehavior.sizing,PxVisBehaviorD3.axes,PxVisBehavior.dataset,PxVisBehavior.commonMethods,PxVisBehaviorD3.selectedDomain,PxVisBehavior.axisTypes,PxVisBehavior.chartExtents,PxVisBehavior.dataExtents,PxVisBehavior.dimensions,PxVisBehaviorD3.domainUpdateNotify,PxVisBehaviorChart.combineMutes];</script></head><body></body></html>