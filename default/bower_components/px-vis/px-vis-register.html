<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="px-vis-behavior-register.html"><link rel="import" href="px-vis-behavior-datetime.html"><link rel="import" href="px-vis-register-item.html"><link rel="import" href="px-vis-register-item-pie.html"><link rel="import" href="px-vis-register-datetime.html"><link rel="import" href="../px-tooltip/px-tooltip.html"><link rel="import" href="css/px-vis-register-styles.html"></head><body><dom-module id="px-vis-register"><template><style include="px-vis-register-styles"></style><div class="flex flex-row fullWidth"><div id="registerWrap" class$="[[_getMinSizeClass(preventMinSize)]] inline--flex flex--col" style$="[[_returnHeight(height,margin, type)]]; [[_returnWidth(chartWidth, width, margin, type)]]"><template is="dom-if" if="{{_displayTime(xAxisType, forceDateTimeDisplay)}}"><div class$="[[_getSeriesWrapperClass(type, horizontalAlignment, _hasScrollBar)]]"><px-vis-register-datetime class$="[[tooltipStyle]]" first-date-time="[[_firstDateTime]]" second-date-time="[[_secondDateTime]]" separator="[[_separator]]" x-axis-type="[[xAxisType]]" series-key="[[tooltipData.timeSeriesKey]]" complete-series-config="[[completeSeriesConfig]]"></px-vis-register-datetime></div></template><div id="seriesWrap" class$="[[_getSeriesWrapperClassReverse(type)]]"><template is="dom-if" if="[[!_isOfType(xAxisType, 'pie')]]"><template is="dom-repeat" items="[[_series]]" as="_groups"><div class$="[[_getSeriesWrapperClass(type, horizontalAlignment, _hasScrollBar)]]"><template is="dom-repeat" id="itemRepeat" items="[[_groups]]" on-dom-change="_scrollBarsPresent"><px-vis-register-item class$="[[tooltipStyle]]" item="[[item]]" _tt-style="[[tooltipStyle]]" dynamic-menu-config="[[dynamicMenuConfig]]" complete-series-config="[[completeSeriesConfig]]" type="[[type]]" x-axis-type="[[xAxisType]]" y-axis-type="[[yAxisType]]" disable-click="[[disableClick]]" muted-series="{{mutedSeries}}" number-format="[[numberFormat]]" number-format-culture="[[numberFormatCulture]]" number-format-is-currency$="[[numberFormatIsCurrency]]" number-format-currency="[[numberFormatCurrency]]" number-format-zero="[[numberFormatZero]]" truncation-length="[[truncationLength]]" prevent-muting="[[preventMuting]]"></px-vis-register-item></template></div></template></template><template is="dom-if" if="[[_isOfType(yAxisType, 'pie')]]"><div class$="[[_getSeriesWrapperClassReverse(type)]]"><div class$="[[_getSeriesWrapperClass(type, horizontalAlignment, _hasScrollBar)]]"><template is="dom-repeat" id="pieItemRepeat" items="[[chartData]]" on-dom-change="_scrollBarsPresentPie"><px-vis-register-item-pie item="[[item]]" item-index="[[index]]" dynamic-menu-config="[[dynamicMenuConfig]]" complete-series-config="[[completeSeriesConfig]]" chart-data="[[chartData]]" type="[[type]]" x-axis-type="[[xAxisType]]" y-axis-type="[[yAxisType]]" use-percentage="[[usePercentage]]" number-format="[[numberFormat]]" number-format-culture="[[numberFormatCulture]]" number-format-is-currency$="[[numberFormatIsCurrency]]" number-format-currency="[[numberFormatCurrency]]" number-format-zero="[[numberFormatZero]]" truncation-length="[[truncationLength]]"></px-vis-register-item-pie></template></div></div></template></div></div></div></template></dom-module><script>Polymer({is:'px-vis-register',behaviors:[PxVisBehavior.observerCheck,PxVisBehavior.sizing,PxVisBehavior.formatting,PxVisBehaviorTime.datetime,PxVisBehavior.mutedSeries,PxVisBehavior.tooltipData,PxVisBehavior.dataset,PxVisBehavior.axisTypes,PxVisBehavior.completeSeriesConfig,PxVisBehavior.commonMethods,PxVisBehaviorRegister.register,PxVisBehaviorRegister.pie,PxVisBehaviorRegister.datetime,PxVisBehavior.forceDateTimeDisplay,PxVisBehaviorRegister.groupings,PxVisBehavior.dynamicMenuConfig,PxVisBehaviorRegister.disableClick],properties:{type:{type:String,value:'vertical',notify:!0},horizontalAlignment:{type:String,value:'left'},_hasScrollBar:{type:Boolean,value:!1},_series:{type:Array,notify:!0},preventMinSize:{type:Boolean,value:!1},preventMuting:{type:Boolean,value:!1},chartWidth:{type:Number,value:''},width:{type:Number,value:''},_itemCount:{type:Number,value:0},inertRegister:{type:Boolean,value:!1}},observers:['_formatDateTime(tooltipData.*)','_scrollBarsPresent(height, margin)','_scrollBarsPresent(chartWidth, margin)','_scrollBarsPresentPie(height, margin)','_scrollBarsPresentPie(chartWidth, type, margin)','_computeSeries(tooltipData.series.*, groupings)'],_formatDateTime:function(){if(!this.hasUndefinedArguments(arguments)&&!this.inertRegister)if(this.tooltipData.time){var a=this.formatTimestamp(this.tooltipData.time,this.timezone,this.firstDateTimeFormat),b=this.formatTimestamp(this.tooltipData.time,this.timezone,this.secondDateTimeFormat);this.set('_firstDateTime',a),this.set('_secondDateTime',b),this.set('_separator',this.separator)}else this.set('_firstDateTime',''),this.set('_secondDateTime',''),this.set('_separator','')},_computeSeries:function(){this.hasUndefinedArguments(arguments)||this.debounce('computeSeries',function(){if(!this.inertRegister){for(var a=this.tooltipData.series,b=Math.ceil(a.length/this.groupings),c=[],d=0,f=b,e=0;e<this.groupings;e++)c.push(a.slice(d,f)),d=f,f=d+b;this.set('_series',c)}},1)},_displayTime:function(a,b){return this.hasUndefinedArguments(arguments)?void 0:b||'time'===a},_getMinSizeClass:function(a){return this.hasUndefinedArguments(arguments)?void 0:a?'':'minSize'},_returnHeight:function(a,b){return this.hasUndefinedArguments(arguments)?void 0:'vertical'===this.type?'height:'+(a-b.bottom)+'px':''},_returnWidth:function(a,b){return this.hasUndefinedArguments(arguments)?void 0:'horizontal'===this.type?'max-width:'+a+'px;':'width:'+b+'px;'},_scrollBarsPresent:function(){void 0===this.height||void 0===this.chartWidth||void 0===this.margin||window.requestAnimationFrame(this._scrollBarsPresentAF.bind(this))},_scrollBarsPresentAF:function(){if(this.$$('#itemRepeat')&&this._itemCount!==this.$$('#itemRepeat').renderedItemCount){var a=!1;'vertical'===this.type&&this.$.seriesWrap.scrollHeight>this.height-this.margin.top-this.margin.bottom?a=!0:'horizontal'===this.type&&this.$.seriesWrap.scrollWidth>this.chartWidth&&(a=!0),this.toggleClass('scrollOn',a,this.$.seriesWrap),this._itemCount=this.$$('#itemRepeat').renderedItemCount}},_scrollBarsPresentPie:function(){void 0===this.height||void 0===this.chartWidth||void 0===this.margin||window.requestAnimationFrame(this._scrollBarsPresentPieAF.bind(this))},_scrollBarsPresentPieAF:function(){var a=!1;'vertical'===this.type&&this.$.seriesWrap.scrollHeight>this.height-this.margin.top-this.margin.bottom?a=!0:'horizontal'===this.type&&this.$.seriesWrap.scrollWidth>this.chartWidth&&(a=!0),this.toggleClass('scrollOn',a,this.$.seriesWrap),this.set('_hasScrollBar',a)}});</script></body></html>