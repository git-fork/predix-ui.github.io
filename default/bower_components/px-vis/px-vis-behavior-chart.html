<html><head><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="px-vis-behavior-d3.html"><link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html"><script>var PxVisBehaviorChart=PxVisBehaviorChart||{};PxVisBehaviorChart.chartCommonMethods=[{_returnAllKeys:function(e){for(var t,a={},o=0;o<e.length;o++){t=Object.keys(e[o]);for(var i=0;i<t.length;i++)a[t[i]]=!0}return Object.keys(a)}},PxColorsBehavior.getSeriesColors],PxVisBehaviorChart.chartCommon=[{properties:{seriesConfig:{type:Object,value:function(){return{}}},_defaultSeriesConfig:{type:Object,value:function(){return{type:"line",x:"x",axis:{id:"defaultAxis",side:"left",number:1}}}},defaultSeriesConfig:{type:Object,value:function(){return{}},observer:"_updateDSC"},includeAllSeries:{type:Boolean,value:!1},_seriesKeys:{type:Array},preventCompleteSeriesConfigCalc:{type:Boolean,value:!1}},observers:["_setCompleteSeriesConfig(_defaultSeriesConfig.*,chartData.*,seriesConfig.*,seriesColorList.*)"],_calcChartExts:function(e,t,i){return"ordinal"===this[i+"AxisType"]?[]:(e.push(Infinity),t.push(-Infinity),[Math.min.apply(null,e),Math.max.apply(null,t)])},_setCompleteSeriesConfig:function(){if(!this.hasUndefinedArguments(arguments))if(this._doesObjHaveValues(this._defaultSeriesConfig)&&this._doesObjHaveValues(this.chartData)&&this._doesObjHaveValues(this.seriesColorList)&&!this.preventCompleteSeriesConfigCalc){for(var e,t,a=this.seriesConfig?this.clone(this.seriesConfig):{},o=Object.keys(a),s=o.length,n=this.includeAllSeries?this._returnAllKeys(this.chartData):[],r=n.reduce(function(e,t){return e[t]={},e},{}),l=Object.keys(this._defaultSeriesConfig),d=[],g=[],c=[],m=[],p=!!this.completeSeriesConfig,u=[],h=[],_=[],y={},x=["xMin","xMax","yMin","yMax"],f=0;f<s;f++){a[o[f]].hasOwnProperty("y")||(console.warn("(\u273F\u25E0\u203F\u25E0) Configuration "+o[f]+" does not have a y-value associated with it. Falling back to ID (\u273F\u25E0\u203F\u25E0)"),a[o[f]].y=o[f]),a[o[f]].hasOwnProperty("x")||(!this.defaultSeriesConfig.x&&console.warn("(\uFF61\u25D5\u203F\u25D5\uFF61) Configuration "+o[f]+" does not have a x-value associated with it. Falling back to default (\uFF61\u25D5\u203F\u25D5\uFF61)"),a[o[f]].x=this._defaultSeriesConfig.x),a[o[f]].name||(a[o[f]].name=o[f]),a[o[f]].color||(a[o[f]].color=this._getColor(f));for(var i,C=0;C<l.length;C++)i=l[C],"undefined"===typeof a[o[f]][i]&&"undefined"!==typeof this._defaultSeriesConfig[i]&&-1===x.indexOf(i)&&(a[o[f]][i]=this._defaultSeriesConfig[i]);a[o[f]].xMin&&d.push(a[o[f]].xMin),a[o[f]].xMax&&g.push(a[o[f]].xMax),a[o[f]].yMin&&c.push(a[o[f]].yMin),a[o[f]].yMax&&m.push(a[o[f]].yMax),delete r[a[o[f]].y]}t=this.includeAllSeries?this.defaultSeriesConfig.x?this.defaultSeriesConfig.x:this._defaultSeriesConfig.x:0<o.length?a[o[0]].x:this._defaultSeriesConfig.x,delete r[t],e=Object.keys(r);for(var f=0;f<e.length;f++)r[e[f]]=JSON.parse(JSON.stringify(this._defaultSeriesConfig)),r[e[f]].name=e[f],r[e[f]].x=t,r[e[f]].y=e[f],r[e[f]].color=this._getColor(s+f),a[e[f]]=r[e[f]];if(this.range){var S=+Px.moment(this.range.from,Px.moment.ISO_8601).format("x"),v=+Px.moment(this.range.to,Px.moment.ISO_8601).format("x");y.x=[S,v]}y.x||(y.x=this._calcChartExts(d,g,"x")),y.y||(y.y=this._calcChartExts(c,m,"y"));var D=!1,b=!1,w=[];if(p){for(var R=Object.keys(this.completeSeriesConfig),z=Object.keys(a),f=0;f<z.length;f++)R.includes(z[f])?_.push(z[f]):(u.push(z[f]),b=!0);for(var f=0;f<R.length;f++)z.includes(R[f])||(h.push(R[f]),D=!0)}if(D){if(this.mutedSeries)for(var f=0;f<h.length;f++)this.mutedSeries[h[f]]?(this.muteUnmuteSeries(h[f]),w.push(h[f])):"boolean"===typeof this.mutedSeries[h[f]]&&w.push(h[f]);if(this.set("_seriesKeys",_),Polymer.dom.flush(),0<w.length)for(var f=0;f<w.length;f++)delete this.mutedSeries[w[f]]}else this.set("_seriesKeys",Object.keys(a));this.fire("px-vis-data-extents",{dataVar:"dataExtents",data:y,method:"set"}),this.set("dataExtents",y),this.fire("px-vis-complete-series-config",{dataVar:"completeSeriesConfig",data:a,method:"set"}),this.set("completeSeriesConfig",a),D&&b&&this.set("_seriesKeys",Object.keys(a))}else this.chartData&&0===this.chartData.length&&(this.set("_seriesKeys",[]),Polymer.dom.flush())},_sideRegister:function(e){return"side"===e||"both"===e},_topRegister:function(e){return"top"===e||"both"===e},_chartTypeLine:function(e,t){return this.hasUndefinedArguments(arguments)?void 0:t&&t[e]&&("line"===t[e].type||"both"===t[e].type)},_chartTypeScatter:function(e,t){return this.hasUndefinedArguments(arguments)?void 0:t&&t[e]&&("scatter"===t[e].type||"both"===t[e].type)},_returnKeys:function(e){return Object.keys(e)},_updateDSC:function(e){if(void 0!==e){for(var t,a=Object.keys(this.defaultSeriesConfig),o=0;o<a.length;o++)t=this.defaultSeriesConfig[a[o]],this._defaultSeriesConfig[a[o]]=t;this.notifyPath("_defaultSeriesConfig")}},_returnStrokeWidth:function(e,t){return this.hasUndefinedArguments(arguments)?void 0:t[e].strokeWidth?t[e].strokeWidth:1}},PxVisBehavior.observerCheck,PxColorsBehavior.dataVisColors,PxVisBehaviorChart.chartCommonMethods,PxVisBehavior.commonMethods,PxVisBehavior.completeSeriesConfig,PxVisBehavior.axisTypes,PxVisBehavior.muteUnmuteSeries],PxVisBehaviorChart.chartId=[{properties:{chartId:{type:String}}},PxVisBehavior.uniqueIds],PxVisBehaviorChart.webWorkerSynchronization=[{properties:{_wwSyncRequestDataDeletion:{type:Boolean,value:!1},_wwSyncDataDeleted:{type:Boolean,value:!1},_wwSyncDataDeletionTimeout:{type:Number,value:1500},_wwSyncDataPropName:{type:String,value:"chartData"}},ready:function(){this.chartId=this.generateRandomID("chart")},attached:function(){this.preventWebWorkerSynchronization||(this._wwSyncRequestDataDeletion=!1,this.chartData&&this._wwSyncDataDeleted&&this._keepDataInSync())},detached:function(){this.preventWebWorkerSynchronization||(this._wwSyncRequestDataDeletion=!0,window.setTimeout(function(){this._wwSyncRequestDataDeletion&&(Px.vis.scheduler.process({action:"unregisterChart",originatorName:this.nodeName,chartId:this.chartId,data:null}),this._wwSyncDataDeleted=!0)}.bind(this),this._wwSyncDataDeletionTimeout))},_keepDataInSync:function(){this.hasUndefinedArguments(arguments)||!this.preventWebWorkerSynchronization&&this[this._wwSyncDataPropName]&&(this._wwSyncDataDeleted=!1,Px.vis.scheduler.process({action:"updateData",originatorName:this.nodeName,chartId:this.chartId,data:{chartData:this[this._wwSyncDataPropName]}}),this.set("wwDataSyncCounter",this.wwDataSyncCounter?this.wwDataSyncCounter+1:1))}},PxVisBehavior.observerCheck,PxVisBehavior.dataset,PxVisBehavior.preventWebWorkerSynchronization,PxVisBehavior.wwDataSyncCounter],PxVisBehaviorChart.saveImage=[{getImage:function(e,t){var a,o=document.createElement("canvas"),s=[],n=Object.keys(this.canvasLayers),r=this._extendedWidth?this._extendedWidth:this._smallerSide?this._smallerSide:this.width,l=this._smallerSide?this._smallerSide:this.height;o.width=r+(t?this._getRegisterWidth(r,l):0),o.height=l,a=o.getContext("2d"),s.push([this.pxSvgElemLower,!0]),s.push([this.canvasContext,!1]);for(var d=0;d<n.length;d++)s.push([this.canvasLayers[n[d]],!1]);s.push([this.pxSvgElem,!0]);var i=function(){if(0<s.length){var a=s.shift();if(!a[0])i();else if(!a[1]){var n=getComputedStyle(a[0].canvas).getPropertyValue("opacity"),d=o.getContext("2d"),g=d.globalAlpha;d.globalAlpha=n,d.drawImage(a[0].canvas,0,0),d.globalAlpha=g,0<s.length?i():this._finishGetImage(e,o,t,r,l),i()}else this._drawSVGOnCanvas(o,a[0],function(a){o=a,0<s.length?i():this._finishGetImage(e,o,t,r,l)}.bind(this))}}.bind(this);i()},_finishGetImage:function(e,t,i,a,o){i&&this._drawRegister(t.getContext("2d"),a,o),e({canvas:t,image:t.toDataURL()})},_getRegisterWidth:function(e,t){if(this.completeSeriesConfig){var a=document.createElement("canvas");a.height=t,a.width=9999;var o=0,s=e+5,n=Object.keys(this.completeSeriesConfig),r=0,l=5,d=a.getContext("2d");curTextWidth=0;for(var g=0;g<n.length;g++)o+=30,curTextWidth=d.measureText(this.completeSeriesConfig[n[g]].name).width,r=Math.max(r,curTextWidth),o+30>t&&(s+=r+15,o=0,l+=r+15,r=0);return l+=r+30,l}return 0},_drawRegister:function(e,t,a){if(this.completeSeriesConfig)for(var o=0,s=3,n=t+5,r=Object.keys(this.completeSeriesConfig),l=0,d=0,g=0;g<r.length;g++)o+=30,e.fillStyle=this.completeSeriesConfig[r[g]].color,e.fillRect(n,o,s,25),e.fillStyle=this._checkThemeVariable("--px-vis-register-data-value","rgb(0,0,0)"),e.fillText(this.completeSeriesConfig[r[g]].name,n+s+5,o+10),d=e.measureText(this.completeSeriesConfig[r[g]].name).width,l=Math.max(l,d),o+30>a&&(n+=l+15,o=0)}},PxVisBehavior.completeSeriesConfig],PxVisBehaviorChart.chartAutoResize=[{properties:{preventResize:{type:Boolean,value:!1,observer:"_preventResizeChanged"},chartHorizontalAlignment:{type:String,value:"center"},chartVerticalAlignment:{type:String,value:"center"},_chartWrapperClass:{type:String,computed:"_getChartWrapperClass(chartHorizontalAlignment, chartVerticalAlignment)"},debounceResizeTiming:{type:Number,value:250}},listeners:{"px-vis-toolbar-secondary-toggled":"_secondaryToolbarToggled"},_preventResizeChanged:function(){this.hasUndefinedArguments(arguments)||!this.preventResize&&this.notifyResize()},_secondaryToolbarToggled:function(t){if(!this.preventResize&&!t.detail.withinChart){var e=this.debounceResizeTiming;this.debounceResizeTiming=0,this.notifyResize(),this.debounceResizeTiming=e}},_getChartWrapperClass:function(e,t){if(!this.hasUndefinedArguments(arguments)){var i="flex wrapper ";return i+="center"===e?"flex--center ":"right"===e?"flex--right ":"flex--left ",i+="center"===t?"flex--middle":"bottom"===t?"flex--bottom":"flex--top",i}}},PxVisBehavior.observerCheck,Polymer.IronResizableBehavior],PxVisBehaviorChart.subConfiguration={properties:{},_applyConfigToElement:function(e,t){if("string"===typeof e&&(e=JSON.parse(e)),"object"!==typeof e)return void console.error("Configuration object must be valid JSON: "+e);if(!t)return void console.error("Cannot apply config to undefined element");for(var a,o=Object.keys(e),s=0;s<o.length;s++)a=o[s],t.set(a,e[a])}},PxVisBehaviorChart.timeFiltering=[{properties:{timeData:{type:String,value:"Timestamp"},_filteredData:{type:Object,computed:"_filterData(chartData, timeDomain, timeData)"}},_filterData:function(e,t,i){if(!this.hasUndefinedArguments(arguments)){if(t.x&&2===t.x.length){var a=+t.x[0],o=+t.x[1];return e.filter(function(e){var t=+e[i];return"undefined"===typeof e[i]?e:t>=a&&t<=o})}return e}}},PxVisBehavior.observerCheck,PxVisBehavior.dataset,PxVisBehavior.timeDomain],PxVisBehaviorChart.waitForAttach={properties:{_loadedOnPage:{type:Boolean}},attached:function(){this._loadedOnPage=!0},_isLoadedOnPage:function(){var e=this.getBoundingClientRect();0<e.height&&0<e.width?this.set("_loadedOnPage",!0):this.async(this._isLoadedOnPage,50)}},PxVisBehaviorChart.getHideClass=[{_getHideClass:function(e){return this.hasUndefinedArguments(arguments)?void 0:!0===e?"hideAxis":""}},PxVisBehavior.observerCheck],PxVisBehaviorChart.registerPositioning=[{properties:{hideRegister:{type:Boolean,value:!1,observer:"_hideRegisterChanged"},_registerType:{type:String},_registerWrapperClass:{type:String,computed:"_getRegisterWrapperClass(_registerType)"}},_getRegisterWrapperClass:function(){if(!this.hasUndefinedArguments(arguments)){var e="flex ";return this.hideRegister||("vertical"===this._registerType?e+="flex--row--rev":e+="flex--col"),e}},_hideRegisterChanged:function(){this.hasUndefinedArguments(arguments)||this.notifyResize()}},PxVisBehavior.observerCheck,PxVisBehaviorChart.getHideClass],PxVisBehaviorChart.registerConfigs={properties:{tooltipConfig:{type:Object},registerConfig:{type:Object}}},PxVisBehaviorChart.interactionSpaceConfig={properties:{interactionSpaceConfig:{type:Object,value:function(){return{}}}}},PxVisBehaviorChart.chartToolbarConfig=[{properties:{toolbarConfig:{type:Object}}},PxVisBehaviorChart.interactionSpaceConfig],PxVisBehaviorChart.axisConfigs={properties:{xAxisConfig:{type:Object},yAxisConfig:{type:Object}}},PxVisBehaviorChart.navigatorConfig={properties:{navigatorConfig:{type:Object}}},PxVisBehaviorChart.highlighterConfigs={properties:{highlighterConfig:{type:Object}}},PxVisBehaviorChart.mouseCusorConfig={properties:{mouseCursorConfig:{type:Object}}},PxVisBehaviorChart.circleChart=[{properties:{_smallerSide:{type:Number,computed:"_computeSmallerSide(width, height)"},_diameter:{type:Number},_radius:{type:Number},_center:{type:Array},_internalCircleMargins:{type:Object,value:function(){return{top:0,left:0,right:0,bottom:0}}}},observers:["_sizeChanged(_smallerSide, margin.*, _internalCircleMargins.*)"],_computeSmallerSide:function(e,t){return this.hasUndefinedArguments(arguments)?void 0:Math.max(Math.min(t,e),0)},_sizeChanged:function(){var e=Math.max;if(!this.hasUndefinedArguments(arguments)){var t=+this.margin.left+ +this._internalCircleMargins.left,a=+this.margin.right+ +this._internalCircleMargins.right,o=+this.margin.top+ +this._internalCircleMargins.top,n=+this.margin.bottom+ +this._internalCircleMargins.bottom,l=e(0,this._smallerSide-t-a),d=e(0,this._smallerSide-o-n),g=Math.min(l,d),c=g/2,m=[];if(m[0]=t+l/2,m[1]=o+d/2,this.polar&&this.zoomStack&&this.zoomStack.length){for(var p=this.zoomStack[0].radius,u=this.zoomStack[0].center,h=this.zoomStack.length-1,_=1;_<this.zoomStack.length;_++){var i=this.zoomStack[_].radius/p,s=i*c,r=this.zoomStack[_].center[0]/p*c,y=this.zoomStack[_].center[1]/p*c;this.zoomStack[_].radius=s,this.zoomStack[_].center=[r,y]}this.zoomStack[0].radius=c,this.zoomStack[0].center=m,c=this.zoomStack[h].radius,m=this.zoomStack[h].center}this.set("_diameter",g),this.set("_radius",c),this.set("_center",m)}}},PxVisBehavior.observerCheck,PxVisBehavior.sizing],PxVisBehaviorChart.cursorConfig={properties:{cursorConfig:{type:Object}}},PxVisBehaviorChart.layers=[{properties:{layer:{type:Array,notify:!0},numberOfLayers:{type:Number},generateLayers:{type:Boolean,value:!0}},observers:["_createLayersOnce(svg, numberOfLayers)"],_createLayers:function(e,t,a){for(var o=[],s=a?a:"layer",n=0;n<t;n++){var i;if(Polymer.Settings.useNativeShadow)i=e.append("g");else{var r=document.createElementNS("http://www.w3.org/2000/svg","g");i=Px.d3.select(Polymer.dom(e.node()).appendChild(r))}i.attr("id","layer"+n),o.push(i)}this.set(s,o),this.fire("px-vis-"+s+"-updated",{data:o,dataVar:s,method:"set"})},_createLayersOnce:function(e,t,i,a){if(!this.hasUndefinedArguments(arguments)){var o=i?i:"generateLayers";this[o]&&this._doesD3HaveValues(e)&&0<t&&(this._createLayers(e,t,a),this.set(o,!1))}}},PxVisBehavior.observerCheck,PxVisBehaviorD3.svg,PxVisBehavior.commonMethods],PxVisBehaviorChart.mutedAxes={properties:{mutedAxes:{type:Object,notify:!0,value:function(){return{}}}}},PxVisBehaviorChart.multiAxisLasso={properties:{_lassoCrosshairData:{type:Object,value:function(){return{}}},resetLassoData:{type:Boolean,value:!1,observer:"_resetLasso"}},lasso:function(){for(var e=this.isMultiY?this.y[this.extentsData.dimension]:this.y,t=0;t<this.chartData.length;t++)this._searchForDataInArea(this.extentsData.dimension,e,this.chartData[t],this.extentsData.extents);this._calcLassoData(this.extentsData.dimension)},_searchForDataInArea:function(e,t,i,a){if(!this._combinedMutedSeries[i[this.seriesKey]]&&!(t.domain()[0]>i[e]||i[e]>t.domain()[1])&&!(this.timeDomain&&this.timeDomain.x&&(i[this.seriesKey]<this.timeDomain.x[0]||i[this.seriesKey]>this.timeDomain.x[1]))){var o=t(i[e]);o>=a[0]&&o<=a[1]&&(this._lassoCrosshairData[i[this.seriesKey]]=i)}},_calcLassoData:function(){for(var e=Object.keys(this._lassoCrosshairData),t={detail:{rawData:[],timeStamps:e}},a=0;a<e.length;a++)t.detail.rawData.push(this._lassoCrosshairData[e[a]]);this._calcCrosshair(t)},_resetLasso:function(){this.hasUndefinedArguments(arguments)||(this._lassoCrosshairData={})}},PxVisBehaviorChart.extentsDataRouter=[{properties:{_extentsDataRoutes:{type:Object,value:function(){return{zoom:"zoom",pan:"pan",lasso:"lasso"}}}},observers:["_extentsDataRouter(extentsData.*)"],_extentsDataRouter:function(){if(!this.hasUndefinedArguments(arguments)&&this.extentsAction){var e=this._extentsDataRoutes[this.extentsAction];return e?this[e]?void this[e]():void console.warn("Method "+e+" is not defined"):void console.warn("_extentsDataRoutes does not have a method to call "+this.extentsAction)}}},PxVisBehavior.observerCheck,PxVisBehavior.extentsData],PxVisBehaviorChart.zoomGeneric=[{properties:{zoomStack:{type:Array,value:function(){return[]}},zoomInPercentage:{type:Number,value:0.5},zoomOutPercentage:{type:Number,value:0.5},_isPanning:{type:Boolean,value:!1}},zoomIn:function(){this.set("extentsAction","zoom"),this._autoZoom(!0)},zoomOut:function(){this.set("extentsAction","zoom"),this._autoZoom(!1)},_intSpaceStartPan:function(){this.set("_isPanning",!0)},_intSpaceStopPan:function(){this.set("_isPanning",!1)}},PxVisBehavior.extentsData,PxVisBehaviorChart.extentsDataRouter],PxVisBehaviorChart.zooming=[{properties:{_originalOrdinalExtents:{type:Array}},listeners:{"px-vis-toolbar-reset-zoom":"resetZoom","px-vis-toolbar-zoom-in":"zoomIn","px-vis-toolbar-zoom-out":"zoomOut","px-vis-toolbar-undo-zoom":"undoZoom","px-vis-interaction-space-start-panning":"_intSpaceStartPan","px-vis-interaction-space-stop-panning":"_intSpaceStopPan"},undoZoom:function(){1===this.zoomStack.length&&this.resetZoom();var e=this.pop("zoomStack");e&&(this.set("selectedDomain",e),this.fire("px-vis-selected-domain-updated",{data:e,method:"set",dataVar:"selectedDomain"}),this._notifyZoomed(!1))},_saveZoomState:function(){this._saveOrdinalOriginalExtents();var e=this.selectedDomain;this.selectedDomain.y&&0!==this.selectedDomain.y.length||(e.y=this._processYValues(function(e){return e.domain()})),this.push("zoomStack",e)},_saveOrdinalOriginalExtents:function(){if(0===this.zoomStack.length&&("ordinal"===this.xAxisType||"ordinal"===this.yAxisType)){var e;e=this._processYValues(function(e){return e.domain()}),this.set("_originalOrdinalExtents",[this.x.domain(),e])}},_autoZoom:function(e){var t=this.x.domain()[0],i=this.x.domain()[1],a={},o=this.selectionType||"xy";this._saveOrdinalOriginalExtents(),"xy"===o||"xAxis"===o?"ordinal"===this.xAxisType?a.eX=this._calcNewOrdinalExtents(this.x.domain(),this._originalOrdinalExtents[0],e):(t=this._convertValue(t,this.xAxisType,!0),i=this._convertValue(i,this.xAxisType,!0),a.eX=this._calcNewLinearExtents(t,i,e),a.eX[0]=this._convertValue(a.eX[0],this.xAxisType,!1),a.eX[1]=this._convertValue(a.eX[1],this.xAxisType,!1)):a.eX=[t,i],a.eY="xy"===o||"yAxis"===o?"ordinal"===this.yAxisType?this._processYValues(function(t,i){var a=this._originalOrdinalExtents[1];return(i||0===i)&&(a=a[i]),this._calcNewOrdinalExtents(t.domain(),a,e)}):this._processYValues(function(t){return this._calcNewLinearExtents(t.domain()[0],t.domain()[1],e)}):this._processYValues(function(e){return[e.domain()[0],e.domain()[1]]}),this.set("extentsData",a)},_calcNewOrdinalExtents:function(e,t,i){return i?this._calcNewZoomedInOrdinal(e):this._calcNewZoomedOutOrdinal(e,t)},_calcNewZoomedInOrdinal:function(e){var t=Math.ceil,i=t(e.length*this.zoomInPercentage),a=e.length-i,o=t(a/2),s=Math.floor(a/2);return e.splice(0,o),e.splice(e.length-s),e},_calcNewZoomedOutOrdinal:function(e,t){var a=Math.ceil,o=Math.min(a(e.length/this.zoomOutPercentage),t.length),s=o-e.length,n=a(s/2),r=Math.floor(s/2),l=t.indexOf(e[0]),d=t.indexOf(e[e.length-1]);if(l<n){var g=n-l;n-=g,r+=g}if(d<r){var g=r-d;r-=g,n+=g}for(var c=1;c<n+1;c++)e.splice(0,0,t[l-c]);for(var c=1;c<r+1;c++)e.splice(e.length,0,t[d+c]);return e},_calcNewLinearExtents:function(e,t,i){var a=t-e,o=[];return o[0]=i?e+a*this.zoomInPercentage/2:e-a*this.zoomOutPercentage/2,o[1]=i?t-a*this.zoomInPercentage/2:t+a*this.zoomOutPercentage/2,o},_convertValue:function(e,t,i){return i?"time"===t||"timeLocal"===t?+e:e:"time"===t||"timeLocal"===t?new Date(e):e},_zoomOrPan:function(){this.set("selectedDomain",{x:this.extentsData.eX,y:this.extentsData.eY}),this.fire("px-vis-selected-domain-updated",{data:{x:this.extentsData.eX,y:this.extentsData.eY},method:"set",dataVar:"selectedDomain"}),this._notifyZoomed(!1)},zoom:function(){this._saveZoomState(),this._zoomOrPan()},pan:function(){this._zoomOrPan()},resetZoom:function(){"reset"===this.selectedDomain?this.set("selectedDomain","rereset"):this.set("selectedDomain","reset"),this.splice("zoomStack",0,this.zoomStack.length),this.fire("px-vis-selected-domain-updated",{data:"reset",method:"set",dataVar:"selectedDomain"}),this._notifyZoomed(!0)},_notifyZoomed:function(e){var t=this._processYValues(function(e){return e.domain()});this.fire("px-vis-zoomed",{x:this.x.domain(),y:t,reset:e,panning:this._isPanning})}},PxVisBehavior.extentsData,PxVisBehaviorD3.selectedDomain,PxVisBehavior.axisTypes,PxVisBehaviorD3.axes,PxVisBehavior.zoomSelection,PxVisBehaviorChart.zoomGeneric],PxVisBehaviorChart.actionRequest={listeners:{"px-vis-action-request":"_actionRequest","px-vis-event-request":"_eventRequest"},_actionRequest:function(e){var t=e.detail.function,i=e.detail.data;t&&(t=t.bind(this),t(i)),e.stopPropagation()},_eventRequest:function(e){e.detail.eventName?e.detail.eventName:"px-vis-event";this.fire(e.detail.eventName,{data:e.detail.data}),e.stopPropagation()}},PxVisBehaviorChart.toolbarSubConfig={properties:{toolbarSubConfig:{type:Object}}},PxVisBehaviorChart.noDebounceOnPanning={properties:{_oldLinesDrawDebounceTime:{type:Number},_oldScatterDrawDebounceTime:{type:Number},_oldThresholdDrawDebounceTime:{type:Number}},listeners:{"px-vis-interaction-space-start-panning":"_startPanning","px-vis-interaction-space-stop-panning":"_stopPanning"},_startPanning:function(){var e=Polymer.dom(this.root).querySelectorAll("px-vis-line-svg"),t=Polymer.dom(this.root).querySelectorAll("px-vis-scatter"),a=Polymer.dom(this.root).querySelector("px-vis-threshold");if(e&&0<e.length){this._oldLinesDrawDebounceTime=e[0].drawDebounceTime;for(var o=0;o<e.length;o++)e[o].set("drawDebounceTime",0)}if(t&&t.length){this._oldScatterDrawDebounceTime=t[0].drawDebounceTime;for(var o=0;o<t.length;o++)t[o].set("drawDebounceTime",0)}a&&(this._oldThresholdDrawDebounceTime=a.drawDebounceTime,a.set("drawDebounceTime",0))},_stopPanning:function(){var e=Polymer.dom(this.root).querySelectorAll("px-vis-line-svg"),t=Polymer.dom(this.root).querySelectorAll("px-vis-scatter"),a=Polymer.dom(this.root).querySelector("px-vis-threshold");if(e)for(var o=0;o<e.length;o++)e[o].set("drawDebounceTime",this._oldLinesDrawDebounceTime);if(t)for(var o=0;o<t.length;o++)t[o].set("drawDebounceTime",this._oldScatterDrawDebounceTime);a&&a.set("drawDebounceTime",this._oldThresholdDrawDebounceTime)}},PxVisBehaviorChart.showTooltip=[{properties:{showTooltip:{type:Boolean,value:!1},_internalShowTooltip:{type:Boolean,value:!0},_computedShowTooltip:{type:Boolean,computed:"_computeShowTooltip(showTooltip, _internalShowTooltip)"}},_computeShowTooltip:function(e,t){return this.hasUndefinedArguments(arguments)?void 0:e&&t}},PxVisBehavior.observerCheck],PxVisBehaviorChart.multiAxis=[{properties:{leftAxisSize:{type:Number,notify:!0},rightAxisSize:{type:Number,notify:!0},numLeftAxes:{type:Number,notify:!0},numRightAxes:{type:Number,notify:!0},_axisX:{type:Object,notify:!0},_axisDomainChanged:{type:Boolean,value:null},_multiAxisSeriesConfig:{type:Object,notify:!0}},_addAxisToList:function(e,t,i,a,o){return a[e]||0===a[e]?void console.warn(e+" is defined on both the left and right side. Defaulting to first side (\u2267\u03C9\u2266)"):o[t]?void(o[t]!==e&&(console.warn(e+" & "+o[t]+" are both defined at axis number "+t),!i[e]&&0!==i[e]&&(i[e]=o.length,o.push(e)))):void(i[e]=t,o[t]=e)},_calcAxes:function(){if(this._doesObjHaveValues(this.completeSeriesConfig)){for(var e=Object.keys(this.completeSeriesConfig),t={},a={},o=[],s=[],n={},r=0;r<e.length;r++)if(this.completeSeriesConfig[e[r]].axis){var i=e[r],l=this.completeSeriesConfig[i].axis,d=l.id;n[d]?n[d].push(i):n[d]=[i],"right"===l.side?this._addAxisToList(d,l.number,a,t,s):this._addAxisToList(d,l.number,t,a,o)}o=o.filter(Boolean),s=s.filter(Boolean),this.set("numLeftAxes",o.length),this.set("numRightAxes",s.length),this.set("axes",o.concat(s)),this.set("dimensions",this.axes),this.set("seriesToAxes",n),this.set("_axisX",this._setAxisScale(o.sort(),s.sort(),this.leftAxisSize,this.rightAxisSize)),"function"===typeof this._axisX&&this.set("_axisDomainChanged",!this._axisDomainChanged),this.set("_multiAxisSeriesConfig",this.completeSeriesConfig)}},_calcMultiMargins:function(e,t,i){var a=Math.max,t=t||50,i=i||50;e.left=a(t*this.numLeftAxes,e.left),e.right=a(i*this.numRightAxes,e.right),this.set("leftAxisSize",t),this.set("rightAxisSize",i)},_returnYScale:function(e,t){if(null!==this.domainChanged)if("object"===typeof this.y){var i=t[e].axis.id;if(this.y&&this.y[i])return this.y[i]}else if("function"===typeof this.y)return this.y}},PxVisBehavior.dimensions,PxVisBehavior.seriesToAxes],PxVisBehaviorChart.axisRegister=[{properties:{hideAxisRegister:{type:Boolean,value:!1},_axisRegisterConfig:{type:Object},_axisRegisterTooltipData:{type:Object}},observers:["_computedAxisRegisterConf(axes, completeSeriesConfig)"],_computedAxisRegisterConf:function(e,t){if(!this.hasUndefinedArguments(arguments)){var a,o={},s={};s.series=[];for(var n=0;n<e.length;n++)a=t[e[n]]?t[e[n]].title:e[n],o[e[n]]={name:a,y:e[n],yAxisUnit:t[e[n]]&&t[e[n]].yAxisUnit?t[e[n]].yAxisUnit:""},s.series.push({name:e[n]});this.set("_axisRegisterConfig",o),this._ttDataHaveSameSeries(this._axisRegisterTooltipData,s)||this.set("_axisRegisterTooltipData",s)}},_ttDataHaveSameSeries:function(e,t){if(!e&&t||!t&&e)return!1;if(e.series.length!==t.series.length)return!1;var i=!0;return e.series.forEach(function(e){-1===t.series.indexOf(e)&&(i=!1)},this),i},_buildAxisTooltipData:function(e,t){if(this._axisRegisterTooltipData&&this._axisRegisterTooltipData.series&&!this.hideAxisRegister){for(var a={series:[],time:t||null},o=0;o<this._axisRegisterTooltipData.series.length;o++){var i={},s=this._axisRegisterTooltipData.series[o].name;i.name=s,e&&(e[s]||0===e[s])&&(!this.hardMute||!this.mutedAxes[s])&&(i.value={},i.value[s]=e[s]),a.series.push(i)}this.set("_axisRegisterTooltipData",a)}},_updateAxisConfig:function(e){for(var t=this._axisRegisterConfig,a=Object.keys(this._axisRegisterConfig),o=0;o<a.length;o++)e?t[a[o]].color=e:delete t[a[o]].color;this._axisRegisterConfig=t,this.notifyPath("_axisRegisterConfig")}},PxVisBehavior.observerCheck,PxVisBehavior.dimensions,PxVisBehavior.completeSeriesConfig,PxVisBehaviorChart.mutedAxes,PxVisBehaviorChart.getHideClass],PxVisBehaviorChart.categoryRegister=[{properties:{hideCategoryRegister:{type:Boolean,value:!1},_hideCategoryRegister:{type:Boolean,value:!0},_categoryRegisterConfig:{type:Object},_categoryRegisterTooltipData:{type:Object}},observers:["_computeCategoryRegisterConfig(categoryKey, completeSeriesConfig, categories)","_computeHideCategoryRegister(hideCategoryRegister, categoryKey)"],_computeCategoryRegisterConfig:function(){if(!this.hasUndefinedArguments(arguments)&&"undefined"!==typeof this.categoryKey){var e,t,a={},o={};a.series=[];for(var s=0;s<this.categories.length;s++)e=this.categories[s].toString(),t=this.completeSeriesConfig[e]&&this.completeSeriesConfig[e].name.toString()!==e?this.completeSeriesConfig[e].name:this.categoryKey+" - "+e,this.completeSeriesConfig[e]?(o[e]={},o[e].name=t,o[e].color=this.completeSeriesConfig[e].color?this.completeSeriesConfig[e].color:this._getColor(this.startColorIndex+s)):o[e]={name:t,color:this._getColor(this.startColorIndex+s)},a.series.push({name:e});this.set("_categoryRegisterConfig",o),this.set("_categoryRegisterTooltipData",a)}},_computeHideCategoryRegister:function(){this.hasUndefinedArguments(arguments)||this.set("_hideCategoryRegister",this.hideCategoryRegister||!this.categoryKey)}},PxVisBehavior.observerCheck,PxVisBehavior.completeSeriesConfig,PxVisBehavior.categories,PxVisBehaviorChart.getHideClass],PxVisBehaviorChart.categoryAndAxisRegisterConfigs=[{properties:{axisRegisterConfig:{type:Object},categoryRegisterConfig:{type:Object}},observers:["_axisRegisterConfigChanged(axisRegisterConfig.*)","_categoryRegisterConfigChanged(categoryRegisterConfig.*)"],_categoryRegisterConfigChanged:function(){this.hasUndefinedArguments(arguments)||this._applyConfigToElement(this.categoryRegisterConfig,this.$.categoryRegister)},_axisRegisterConfigChanged:function(){this.hasUndefinedArguments(arguments)||this._applyConfigToElement(this.axisRegisterConfig,this.$.axisRegister)}},PxVisBehavior.observerCheck,PxVisBehaviorChart.subConfiguration],PxVisBehaviorChart.sizeVerticalRegister=[{properties:{_verticalRegisterHeight:{type:Number},_verticalRegisterHeightDeductions:{type:Array},_verticalRegisterDrawingCanvasId:{type:String}},observers:["_heightChanged(height)"],ready:function(){this.set("_verticalRegisterHeight",this.height)},_heightChanged:function(){this.hasUndefinedArguments(arguments)||this._computeVerticalRegisterHeight()},_computeVerticalRegisterHeight:function(e){this.debounce("_computeVerticalRegisterHeight",function(){var t=0;if(!!e)for(var a=0;a<e.length;a++)t+=e[a];else if(this._verticalRegisterHeightDeductions&&this._verticalRegisterHeightDeductions.length)for(var i,a=0;a<this._verticalRegisterHeightDeductions.length;a++)i=this.$$("#"+this._verticalRegisterHeightDeductions[a]),i&&(t+=i.getBoundingClientRect().height);this.set("_verticalRegisterHeight",Math.max(+this.$[this._verticalRegisterDrawingCanvasId].height+t,0))}.bind(this),5)}},PxVisBehavior.observerCheck,PxVisBehavior.baseSize],PxVisBehaviorChart.tooltipFollowMouseCalculation=[{properties:{_tooltipCalcMousePosHandler:{type:Function},_tooltipCalcHoverTargetId:{type:String},mousePosition:{type:Array}},observers:["_computedShowTooltipChanged(_computedShowTooltip)"],_computedShowTooltipChanged:function(){this.hasUndefinedArguments(arguments)||(!this._tooltipCalcMousePosHandler&&this._createHandler(),this._computedShowTooltip?this.$[this._tooltipCalcHoverTargetId].addEventListener("mousemove",this._tooltipCalcMousePosHandler):this.$[this._tooltipCalcHoverTargetId].removeEventListener("mousemove",this._tooltipCalcMousePosHandler))},_calcMousePos:function(e){this.set("mousePosition",[e.pageX,e.pageY])},_createHandler:function(){this._tooltipCalcMousePosHandler=this._calcMousePos.bind(this)}},PxVisBehavior.observerCheck,PxVisBehaviorChart.showTooltip],PxVisBehaviorChart.thresholdConfig={properties:{thresholdConfig:{type:Object}}},PxVisBehaviorChart.combineMutes=[{properties:{_combinedMutedSeries:{type:Object,value:function(){return{}}},mutedSeriesDomain:{type:Object,value:function(){return{}}},mutedSeriesBrush:{type:Object,value:function(){return{}}},mutedSeriesCategories:{type:Object,value:function(){return{}}}},observers:["_combineMutes(mutedSeriesBrush, mutedSeriesDomain, mutedSeriesCategories.*)"],_combineMutes:function(e,t){if(!this.hasUndefinedArguments(arguments)){var a={},o=Object.keys(this.mutedSeriesCategories).filter(function(e){return this.mutedSeriesCategories[e]}.bind(this));for(var s in e)a[s]=e[s];for(var s in t)a[s]=t[s];if(o.length&&this.chartData)for(var n=0;n<this.chartData.length;n++)for(var i=0;i<o.length;i++)if(this.chartData[n][this.categoryKey]===o[i]){a[this.chartData[n][this.seriesKey]]=!0;break}this.set("_combinedMutedSeries",a),this.set("_combinedMutedChanged",!this._combinedMutedChanged)}}},PxVisBehavior.observerCheck],PxVisBehaviorChart.multiAxisMuting=[{properties:{_mutedExtents:{type:Object,value:function(){return{}}}},ready:function(){this._extentsDataRoutes.mute="_addToMutedExtents"},_addToMutedExtents:function(){this._mutedExtents[this.extentsData.dimension]=this.extentsData.extents,this._calcMutedSeries()},_calcMutedSeries:function(){for(var e,t=Object.keys(this._mutedExtents),a={},o={},s=0;s<t.length;s++)e=t[s],this._calcSingleMutedSeries(this._mutedExtents[e],e,a,o);this.set("mutedSeriesBrush",a),this.set("brushDomains.muted",o)},_calcSingleMutedSeries:function(e,t,a,o){if(e&&0!==e.length&&this.chartData&&0<this.chartData.length){var s,n,r=[],l=0,d=1;this._flipAxisLogic&&(l=1,d=0),"function"===typeof this.y?(s=this.y.invert(e[l]),n=this.y.invert(e[d])):(s=this.y[t].invert(e[l]),n=this.y[t].invert(e[d]));for(var g=0;g<this.chartData.length;g++)this.brushToRemove?s>=this.chartData[g][t]&&this.chartData[g][t]>=n&&(a[this.chartData[g][this.seriesKey]]=!0):(s<=this.chartData[g][t]||this.chartData[g][t]<=n)&&(a[this.chartData[g][this.seriesKey]]=!0),r=[s,n];o[t]=r}},deleteMutedBrushes:function(){this.set("_brushDomains.muted",{})}},PxVisBehaviorChart.extentsDataRouter],PxVisBehaviorChart.multiAxisZoom=[{listeners:{"px-vis-toolbar-reset-zoom":"resetZoom","px-vis-toolbar-zoom-in":"zoomIn","px-vis-toolbar-zoom-out":"zoomOut","px-vis-toolbar-undo-zoom":"undoZoom","px-vis-interaction-space-start-panning":"_saveZoomState"},zoom:function(){this.extentsData.extents.length&&(this._saveZoomState(),this._zoomOrPan())},pan:function(){this._zoomOrPan()},_saveZoomState:function(){var e=this._processYValues(function(e){return e.domain()});this.zoomStack.push(e)},_zoomOrPan:function(){var e,t=this.extentsData.extents;if("function"===typeof this.y)e=[this.y.invert(t[0]),this.y.invert(t[1])];else if(this.commonAxis){var a,o=Object.keys(this.y);e={};for(var s=0;s<o.length;s++)a=o[s],e[a]=[this.y[a].invert(t[1]),this.y[a].invert(t[0])]}else{var a=this.extentsData.dimension;e={},e[a]=[this.y[a].invert(t[1]),this.y[a].invert(t[0])]}this.set("axesDomain",e)},_autoZoom:function(e){this._saveZoomState();var t=e?1-this.zoomInPercentage:1+this.zoomOutPercentage,i=this._processYValues(function(e){var i=e.domain();return i[0]*=t,i[1]*=t,i});this.set("axesDomain",i)},undoZoom:function(){this.zoomStack.length&&this.set("axesDomain",this.zoomStack.pop())},resetZoom:function(){this.zoomStack.length&&(this.set("axesDomain",this.zoomStack[0]),this.zoomStack=[])}},PxVisBehaviorChart.zoomGeneric],PxVisBehaviorChart.useCategoryInTooltip={properties:{useCategoryInTooltip:{type:Boolean,value:!1}}},PxVisBehaviorChart.tooltipSizing=[{properties:{_svgClientRect:Object,_canvasClientRect:Object,_winX:Number,_winY:Number},observers:["_setupSizingListener(showTooltip)"],detached:function(){this.removeEventListener("px-vis-tooltip-sizing-request",this._getSizingBound)},attached:function(){this._getSizingBound=this._getSizing.bind(this),this._setupSizingListener()},_setupSizingListener:function(){this.showTooltip?this.addEventListener("px-vis-tooltip-sizing-request",this._getSizingBound):this.removeEventListener("px-vis-tooltip-sizing-request",this._getSizingBound)},_getSizing:function(){requestAnimationFrame(this._getImmediateSizing.bind(this))},_getImmediateSizing:function(){this.pxSvgElem&&(this._svgClientRect=this.pxSvgElem.getBoundingClientRect()),this.canvasContext&&this.canvasContext.canvas&&(this._canvasClientRect=this.canvasContext.canvas.getBoundingClientRect()),this._winX=window.pageXOffset,this._winY=window.pageYOffset}},PxVisBehaviorChart.showTooltip];</script></head><body></body></html>