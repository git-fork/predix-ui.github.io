<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="px-vis-behavior-d3.html"><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="css/px-vis-styles.html"></head><body><dom-module id="px-vis-bar-svg"><template><style include="px-vis-styles"></style></template></dom-module><script>Polymer({is:'px-vis-bar-svg',behaviors:[PxVisBehavior.observerCheck,PxVisBehaviorD3.svg,PxVisBehaviorD3.axes,PxVisBehavior.dataset,PxVisBehavior.commonMethods,PxVisBehaviorD3.clipPath,PxVisBehavior.completeSeriesConfig,PxVisBehavior.dynamicConfigProperties,PxVisBehaviorD3.domainUpdate,PxVisBehavior.preventInitialDrawing],properties:{barRects:{type:Object},barBuilder:{type:Object},barGroup:{type:Object},drawDebounceTime:{type:Number,value:10},_iKey:{type:String},_keySeriesDict:{type:Object,computed:'_computekeySeriesDict(completeSeriesConfig.*)'},_funcsWereSet:{type:Number,value:0},type:{type:String,value:'column'},_returnX:{type:Function},_returnY:{type:Function},_returnWidth:{type:Function},_returnHeight:{type:Function},seriesKey:{type:String}},observers:['drawElement(svg, y, domainChanged, chartData.*, completeSeriesConfig.*, _keySeriesDict,  preventInitialDrawing, _funcsWereSet)','_addClipPath(clipPath)','_setFuncs(type)'],detached:function(){this._doesD3HaveValues(this.barPath)&&this.barPath.remove(),this._doesD3HaveValues(this.barGroup)&&this.barGroup.remove()},drawElement:function(){this.hasUndefinedArguments(arguments)||!this.preventInitialDrawing&&(0<this.drawDebounceTime?this.debounce('draw',function(){this._funcsWereSet&&null!==this.domainChanged&&this._doesD3HaveValues(this.svg)&&this.y&&0<this.chartData.length&&this._doesObjHaveValues(this.completeSeriesConfig)&&this._drawElementDebounced()}.bind(this),this.drawDebounceTime):this._drawElementDebounced())},_drawElementDebounced:function(){this._isObjEmpty(this.barGroup)&&(this.barGroup=this.svg.append('g').attr('series-id','bars').attr('class','series-bars'));var a=this.barGroup.selectAll('rect.series-bar').data(this.chartData);a.exit().remove(),a.enter().append('rect').attr('class','series-bar').merge(a).attr('series-id',function(a,b){var c=this._keySeriesDict[this.seriesKey];return'bar_'+c+'_'+b}.bind(this)).attr('series-keys',function(){return this._keySeriesDict[this.seriesKey]}.bind(this)).attr('x',this._returnX.bind(this)).attr('y',this._returnY.bind(this)).attr('width',this._returnWidth.bind(this)).attr('height',this._returnHeight.bind(this)).attr('fill',function(){var a=this._keySeriesDict[this.seriesKey];return this.completeSeriesConfig[a].color}.bind(this)),this.barRects=this.barGroup.selectAll('rect.series-bar'),this._addClipPath(),this.fire('px-vis-bar-svg-rendering-ended')},_setFuncs:function(){this.hasUndefinedArguments(arguments)||('bar'===this.type?(this._returnX=function(a){return this.x(a[0])},this._returnY=function(a){return this.y(a.data[this._iKey])},this._returnWidth=function(a){return this.x(a[1])-this.x(a[0])},this._returnHeight=function(){return this.y.bandwidth()}):(this._returnX=function(a){return this.x(a.data[this._iKey])},this._returnY=function(a){return this.y(a[1])},this._returnWidth=function(){return this.x.bandwidth()},this._returnHeight=function(a){return this.y(a[0])-this.y(a[1])}),this._funcsWereSet+=1)},_addClipPath:function(){this.hasUndefinedArguments(arguments)||this.addClipPath(this.barGroup)},_computekeySeriesDict:function(){if(!this.hasUndefinedArguments(arguments)){for(var a=Object.keys(this.completeSeriesConfig),b={},c=0;c<a.length;c++){var d=a[c],e=this.completeSeriesConfig[d].y;b[e]=d}return this._iKey=this.completeSeriesConfig[a[0]].x,b}}});</script></body></html>