<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../px-tooltip/px-tooltip.html"><link rel="import" href="../px-icon-set/px-icon-set.html"><link rel="import" href="../px-icon-set/px-icon.html"><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="px-vis-behavior-d3.html"><link rel="import" href="css/px-vis-toolbar-styles.html"></head><body><dom-module id="px-vis-toolbar"><template><style include="px-vis-toolbar-styles"></style><span id="mainRow" class$="flex [[_getRowDirection(horizontalAlignment)]]"><template id="mainRepeat" is="dom-repeat" items="{{_internalConfig}}" strip-whitespace=""><span class$="u-p- flex__item main-item [[_getSelectedClass(item.selected)]]" style$="{{item.customButtonStyle}}" on-tap="_clickItem" value="{{index}}"><px-icon class="icon" icon="[[item.icon]]" value="{{index}}"></px-icon>{{item.title}}<template is="dom-if" if="[[_hasTooltip(item)]]"><px-tooltip tooltip-message="[[item.tooltipLabel]]" orientation="top" smart-orientation=""></px-tooltip></template></span></template></span><template id="templateSubRow" is="dom-if" if="[[_isWithinChart(withinChart)]]"><span id="subRow" class$="flex subrow--container [[_getRowDirection(horizontalAlignment)]] [[_getSubRowClass(subToolbarAlignment)]]"><template id="subRepeat" is="dom-repeat" items="{{currentSubConfig}}" strip-whitespace=""><span class$="u-p- flex__item main-item subrow--item [[_getSelectedClass(item.selected)]]" on-tap="_clickSubItem" value="{{index}}"><template is="dom-if" if="[[item.icon]]"><px-icon class="icon" icon="[[item.icon]]" value="{{index}}"></px-icon></template>{{item.title}}<template is="dom-if" if="[[_hasTooltip(item)]]"><px-tooltip tooltip-message="[[item.tooltipLabel]]" orientation="top" smart-orientation=""></px-tooltip></template></span></template></span></template></template></dom-module><script>Polymer({is:'px-vis-toolbar',behaviors:[PxVisBehavior.observerCheck,PxVisBehavior.commonMethods,PxVisBehavior.actionConfig],properties:{withinChart:{type:Boolean,value:!1},chartMargin:{type:Object},currentSubConfig:{type:Object,notify:!0},_internalConfig:{type:Object},horizontalAlignment:{type:String,value:'right'},subToolbarAlignment:{type:String,value:'horizontal'},config:{type:Object},actionConfig:{type:Object,notify:!0,value:function(){return{mousedown:'startZooming',mouseup:'stopZooming',mouseout:'resetTooltip',mousemove:'calcTooltipData'}}}},observers:['_configChanged(config.*, horizontalAlignment)','_positionSubRow(withinChart, chartMargin, horizontalAlignment)','_positionMainRow(chartMargin, horizontalAlignment)'],_defaultActionsMapping:{annotations:{tooltipLabel:'Annotations',icon:'px-vis:comment',cursorIcon:'px-vis:comment',buttonGroup:1,onClick:function(){this.set('_internalShowTooltip',!1),this.set('showStrongIcon',!0)},onDeselect:function(){this.set('showStrongIcon',!1)},actionConfig:{mouseout:null,mousemove:null,mousedown:null,click:function(a){this.fire('px-vis-event-request',{eventName:'px-vis-annotation-creation',data:{mouseCoords:a.mouseCoords,clickTarget:a.target,chart:this}})},mouseup:null},subConfig:{hideAnnotations:{tooltipLabel:'Hide Annotations',icon:'px-vis:hide',buttonGroup:1,toggle:!0,onClick:function(a){this.$$('px-vis-annotations').set('hide',a.selected)}}}},axisMuteSeries:{tooltipLabel:'Mute Series on Axis',icon:'px-vis:brush',cursorIcon:'px-vis:brush',buttonGroup:1,onClick:function(){this.set('_internalShowTooltip',!1)},actionConfig:{mouseout:null,mousemove:null,click:null,mousedown:'callAxisMute',mouseup:'callAxisMute'}},axisDrag:{tooltipLabel:'Axis Drag',icon:'px-vis:move-axis',cursorIcon:'px-vis:move-axis',buttonGroup:1,onClick:function(){this.set('_internalShowTooltip',!1)},actionConfig:{mouseout:null,mousemove:null,click:null,mousedown:'callAxisDrag',mouseup:'callAxisDrag'}},crosshairLasso:{tooltipLabel:'Lasso selection',icon:'px-vis:lasso',buttonGroup:1,selectable:!0,onClick:function(){this.set('_internalShowTooltip',!1),this.set('interactionSpaceConfig.searchType','lasso')},actionConfig:{mouseout:null,mousemove:null,click:null,mousedown:'startLasso',mouseup:'stopLasso'},subConfig:{clearCrosshair:{tooltipLabel:'Clear lasso data',icon:'px-nav:close',onClick:function(){this.set('crosshairData',{rawData:[],timeStamps:[]}),this.set('interactionSpaceConfig.resetLassoData',!this.interactionSpaceConfig.resetLassoData),this.set('resetLassoData',!this.resetLassoData)}}}},crosshair:{tooltipLabel:'Crosshair',icon:'px-vis:crosshair',cursorIcon:'px-vis:crosshair',buttonGroup:1,onClick:function(){this.set('_internalShowTooltip',!0)},actionConfig:{mouseout:'resetTooltipAndCrosshairData',mousemove:'calcTooltipAndCrosshairData',click:null,mousedown:null,mouseup:null}},crosshairWithOptions:{tooltipLabel:'Crosshair',icon:'px-vis:crosshair',buttonGroup:1,onClick:function(){this.set('interactionSpaceConfig.cursorType','circle')},onDeselect:function(){this.set('interactionSpaceConfig.cursorType','none')},actionConfig:{mouseout:'resetTooltipAndCrosshairData',mousemove:'calcTooltipAndCrosshairData',click:null,mousedown:null,mouseup:null},subConfig:{closestPoint:{icon:'px-vis:closest-point',cursorIcon:'px-vis:closest-point',tooltipLabel:'Closest Timestamp and associated points',buttonGroup:1,selectable:!0,onClick:function(){this.set('interactionSpaceConfig.searchType','closestPoint')},actionConfig:{mouseout:'resetTooltipAndCrosshairData',mousemove:'calcTooltipAndCrosshairData',click:null,mousedown:null,mouseup:null}},pointPerSeries:{icon:'px-vis:closest-point-series',cursorIcon:'px-vis:closest-point-series',tooltipLabel:'Point Per Series',buttonGroup:1,selectable:!0,onClick:function(){this.set('interactionSpaceConfig.searchType','pointPerSeries')},actionConfig:{mouseout:'resetTooltipAndCrosshairData',mousemove:'calcTooltipAndCrosshairData',click:null,mousedown:null,mouseup:null}},allInArea:{icon:'px-vis:all-points-in-area',cursorIcon:'px-vis:all-points-in-area',tooltipLabel:'All in area',buttonGroup:1,selectable:!0,onClick:function(){this.set('interactionSpaceConfig.searchType','allInArea')},actionConfig:{mouseout:'resetTooltipAndCrosshairData',mousemove:'calcTooltipAndCrosshairData',click:null,mousedown:null,mouseup:null}},radiusUp:{icon:'px-vis:expand-radius',tooltipLabel:'Radius',onClick:function(){var a=this.interactionSpaceConfig.searchRadius?this.interactionSpaceConfig.searchRadius:0;this.set('interactionSpaceConfig.searchRadius',a+5)}},radiusDown:{icon:'px-vis:shrink-radius',tooltipLabel:'Radius',onClick:function(){var a=this.interactionSpaceConfig.searchRadius?this.interactionSpaceConfig.searchRadius:0;this.set('interactionSpaceConfig.searchRadius',Math.max(a-5,0))}}}},tooltip:{tooltipLabel:'Tooltip',icon:'px-vis:show-tooltip',cursorIcon:'px-vis:show-tooltip',buttonGroup:1,selected:!0,onClick:function(){this.set('_internalShowTooltip',!0)},actionConfig:{mouseout:'resetTooltip',mousemove:'calcTooltipData',click:null,mousedown:null,mouseup:null}},tooltipWithSearchTypes:{tooltipLabel:'Tooltip',icon:'px-vis:show-tooltip',cursorIcon:'px-vis:show-tooltip',buttonGroup:1,selected:!0,onClick:function(){this.set('_internalShowTooltip',!0)},actionConfig:{mouseout:'resetTooltip',mousemove:'calcTooltipData',click:null,mousedown:null,mouseup:null},subConfig:{timestamps:{title:'Timestamps',tooltipLabel:'Returns all points with the same timestamp as the point closest to your cursor',buttonGroup:2,selectable:!0,selected:!0,onClick:function(){this.set('interactionSpaceConfig.searchFor','timestamps')}},points:{title:'Points',tooltipLabel:'Returns only the closest point to your cursor',buttonGroup:2,selectable:!0,onClick:function(){this.set('interactionSpaceConfig.searchFor','point')}}}},tooltipWithSearchTypesAndRadius:{tooltipLabel:'Tooltip',icon:'px-vis:show-tooltip',cursorIcon:'px-vis:show-tooltip',buttonGroup:1,selected:!0,onClick:function(){this.set('_internalShowTooltip',!0)},actionConfig:{mouseout:'resetTooltip',mousemove:'calcTooltipData',click:null,mousedown:null,mouseup:null},subConfig:{timestamps:{title:'Timestamps',tooltipLabel:'Returns all points with the same timestamp as the point closest to your cursor',buttonGroup:2,selectable:!0,selected:!0,onClick:function(){this.set('interactionSpaceConfig.searchFor','timestamps')}},points:{title:'Points',tooltipLabel:'Returns only the closest point(s) to your cursor',buttonGroup:2,selectable:!0,onClick:function(){this.set('interactionSpaceConfig.searchFor','point')}},radiusUp:{icon:'px-vis:expand-radius',tooltipLabel:'Radius',onClick:function(){var a=this.interactionSpaceConfig.searchRadius?this.interactionSpaceConfig.searchRadius:0;this.set('interactionSpaceConfig.searchRadius',a+5)}},radiusDown:{icon:'px-vis:shrink-radius',tooltipLabel:'Radius',onClick:function(){var a=this.interactionSpaceConfig.searchRadius?this.interactionSpaceConfig.searchRadius:0;this.set('interactionSpaceConfig.searchRadius',Math.max(a-5,0))}}}},tooltipWithFullOptions:{tooltipLabel:'Tooltip',icon:'px-vis:show-tooltip',cursorIcon:'px-vis:show-tooltip',buttonGroup:1,selected:!0,onClick:function(){this.set('_internalShowTooltip',!0)},actionConfig:{mouseout:'resetTooltip',mousemove:'calcTooltipData',click:null,mousedown:null,mouseup:null},subConfig:{timestamps:{title:'Timestamps',tooltipLabel:'Returns all points with the same timestamp as the point closest to your cursor',buttonGroup:2,selectable:!0,selected:!0,onClick:function(){this.set('interactionSpaceConfig.searchFor','timestamps')}},points:{title:'Points',tooltipLabel:'Returns only the closest point to your cursor',buttonGroup:2,selectable:!0,onClick:function(){this.set('interactionSpaceConfig.searchFor','point')}},closestPoint:{icon:'px-vis:closest-point',cursorIcon:'px-vis:closest-point',tooltipLabel:'Closest point or timestamp',buttonGroup:1,selectable:!0,selected:!0,onClick:function(){this.set('interactionSpaceConfig.searchType','closestPoint')},actionConfig:{mouseout:'resetTooltip',mousemove:'calcTooltipData',click:null,mousedown:null,mouseup:null}},pointPerSeries:{icon:'px-vis:closest-point-series',cursorIcon:'px-vis:closest-point-series',tooltipLabel:'Point Per Series',buttonGroup:1,selectable:!0,onClick:function(){this.set('interactionSpaceConfig.searchType','pointPerSeries')},actionConfig:{mouseout:'resetTooltip',mousemove:'calcTooltipData',click:null,mousedown:null,mouseup:null}},allInArea:{icon:'px-vis:all-points-in-area',cursorIcon:'px-vis:all-points-in-area',tooltipLabel:'All in area',buttonGroup:1,selectable:!0,onClick:function(){this.set('interactionSpaceConfig.searchType','allInArea')},actionConfig:{mouseout:'resetTooltip',mousemove:'calcTooltipData',click:null,mousedown:null,mouseup:null}},radiusUp:{icon:'px-vis:expand-radius',tooltipLabel:'Radius',onClick:function(){var a=this.interactionSpaceConfig.searchRadius?this.interactionSpaceConfig.searchRadius:0;this.set('interactionSpaceConfig.searchRadius',a+5)}},radiusDown:{icon:'px-vis:shrink-radius',tooltipLabel:'Radius',onClick:function(){var a=this.interactionSpaceConfig.searchRadius?this.interactionSpaceConfig.searchRadius:0;this.set('interactionSpaceConfig.searchRadius',Math.max(a-5,0))}}}},pan:{tooltipLabel:'Pan',icon:'px-vis:pan',cursorIcon:'px-vis:pan',onClick:function(){this.set('_internalShowTooltip',!1)},buttonGroup:1,actionConfig:{mousedown:'startPanning',mouseup:'stopPanning',mouseout:null,mousemove:null,click:null},subConfig:{resetZoom:{icon:'px-vis:full-screen',tooltipLabel:'Reset',eventName:'px-vis-toolbar-reset-zoom'}}},bareZoom:{tooltipLabel:'Zoom on axis',icon:'px-vis:zoom-toolbar',cursorIcon:'px-vis:zoom-toolbar',onClick:function(){this.set('_internalShowTooltip',!1)},buttonGroup:1,actionConfig:{mousedown:'startZooming',mouseup:'stopZooming',mouseout:null,mousemove:null,click:null},subConfig:{undoZoom:{icon:'px-vis:zoom-out-one-level',tooltipLabel:'Undo zoom',eventName:'px-vis-toolbar-undo-zoom'},resetZoom:{icon:'px-vis:full-screen',tooltipLabel:'Reset',eventName:'px-vis-toolbar-reset-zoom'}}},zoom:{tooltipLabel:'Zoom',icon:'px-vis:zoom-toolbar',cursorIcon:'px-vis:zoom-toolbar',onClick:function(){this.set('_internalShowTooltip',!1)},buttonGroup:1,actionConfig:{mousedown:'startZooming',mouseup:'stopZooming',mouseout:null,mousemove:null,click:null},subConfig:{zoomIn:{icon:'px-vis:zoom-in',tooltipLabel:'Zoom in',eventName:'px-vis-toolbar-zoom-in'},zoomOut:{icon:'px-vis:zoom-out',tooltipLabel:'Zoom out',eventName:'px-vis-toolbar-zoom-out'},undoZoom:{icon:'px-vis:zoom-out-one-level',tooltipLabel:'Undo zoom',eventName:'px-vis-toolbar-undo-zoom'},resetZoom:{icon:'px-vis:full-screen',tooltipLabel:'Reset',eventName:'px-vis-toolbar-reset-zoom'}}},advancedZoom:{tooltipLabel:'Zoom',icon:'px-vis:zoom-toolbar',cursorIcon:'px-vis:zoom-toolbar',buttonGroup:1,selectable:!0,onClick:function(){this.set('_internalShowTooltip',!1)},actionConfig:{mousedown:'startZooming',mouseup:'stopZooming',mouseout:null,mousemove:null,click:null},subConfig:{x:{icon:'px-vis:x-axis',buttonGroup:1,tooltipLabel:'Zoom on X axis only',eventName:'my-custom-click',selectable:!0,onClick:function(){this.set('selectionType','xAxis')}},y:{icon:'px-vis:y-axis',buttonGroup:1,tooltipLabel:'Zoom on Y axis only',selectable:!0,onClick:function(){this.set('selectionType','yAxis')}},xy:{icon:'px-vis:xy-axis',tooltipLabel:'Zoom on X and Y axis',buttonGroup:1,selectable:!0,onClick:function(){this.set('selectionType','xy')}},zoomIn:{icon:'px-vis:zoom-in',tooltipLabel:'Zoom in',eventName:'px-vis-toolbar-zoom-in'},zoomOut:{icon:'px-vis:zoom-out',tooltipLabel:'Zoom out',eventName:'px-vis-toolbar-zoom-out'},undoZoom:{icon:'px-vis:zoom-out-one-level',tooltipLabel:'Undo zoom',eventName:'px-vis-toolbar-undo-zoom'},resetZoom:{icon:'px-vis:full-screen',tooltipLabel:'Reset',eventName:'px-vis-toolbar-reset-zoom'}}},stripe:{tooltipLabel:'Draw Stripe',icon:'px-vis:draw-stripe',cursorIcon:'px-vis:draw-stripe',buttonGroup:1,selectable:!0,onClick:function(){this.set('_internalShowTooltip',!1)},subConfig:{inclusion:{title:'Inclusion',cursorIcon:'px-vis:draw-stripe',buttonGroup:1,tooltipLabel:'Draw/edit inclusion type stripes',selectable:!0,selected:!0,onClick:function(){this.set('selectionType','xAxis'),this.set('stripeType','inclusion')}},exclusion:{title:'Exclusion',cursorIcon:'px-vis:draw-stripe',buttonGroup:1,tooltipLabel:'Draw/edit exclusion type stripes',selectable:!0,onClick:function(){this.set('selectionType','xAxis'),this.set('stripeType','exclusion')}},add:{icon:'px-vis:draw-stripe',cursorIcon:'px-vis:draw-stripe',tooltipLabel:'Add stripe',buttonGroup:2,selected:!0,selectable:!0,actionConfig:{mousedown:'startStriping',mouseup:'stopStriping',mouseout:'resetTooltip',mousemove:'calcTooltipData',click:null}},edit:{icon:'px-vis:remove-stripe',cursorIcon:'px-vis:remove-stripe',buttonGroup:2,selectable:!0,tooltipLabel:'Edit/remove stripe',actionConfig:{mousedown:null,mouseup:null,mouseout:null,click:null,mousemove:'reportMouseCoords'}}}}},clearAllActions:function(){for(var a=Object.keys(this.actionConfig),b={},c=0;c<a.length;c++)b[a[c]]=null;for(var c=0;c<this._internalConfig.length;c++)this.set('_internalConfig.'+c+'.selected',!1),this.set('_internalConfig.'+c+'.opened',!1);this.set('actionConfig',b)},_extendConfig:function(a,b){for(var c=Object.keys(b),d=a||{},e=0;e<c.length;e++)d[c[e]]='object'===typeof b[c[e]]&&null!==b[c[e]]?this._extendConfig(d[c[e]],b[c[e]]):b[c[e]];return d},_configChanged:function(){if(!this.hasUndefinedArguments(arguments)){for(var a=[],b=Object.keys(this.config),c=0;c<b.length;c++){var d;if(this._defaultActionsMapping[b[c]]){var e={};e=this.clone(this._defaultActionsMapping[b[c]],e),d='object'===typeof this.config[b[c]]?this._extendConfig(e,this.config[b[c]]):e}else d=this.config[b[c]];a.push(d),d.selected&&(this._tryProcessSubConfig(d),this._processItem(d))}'right'===this.horizontalAlignment&&a.reverse(),this.set('_internalConfig',a)}},_clickItem:function(a){a=Polymer.dom(a);var b,c=a.localTarget.value,d=this._internalConfig[c],e=!1;if(d.buttonGroup){for(var f=0;f<this._internalConfig.length;f++)if(c!==f&&this._internalConfig[f].buttonGroup===d.buttonGroup){if(this._internalConfig[f].onDeselect&&this._internalConfig[f].selected){var g=this._returnFn(this._internalConfig[f].onDeselect);this._setupContext(this._internalConfig[f],g)}this.set('_internalConfig.'+f+'.selected',!1),this.set('_internalConfig.'+f+'.opened',!1)}b=this._internalConfig[c].opened,this.set('_internalConfig.'+c+'.opened',!b),this.set('_internalConfig.'+c+'.selected',!this._internalConfig[c].toggle||!this._internalConfig[c].selected)}b?([]!==this.currentSubConfig&&(e=!0),this.set('currentSubConfig',[])):((!this.currentSubConfig||0===this.currentSubConfig.length)&&(e=!0),this._tryProcessSubConfig(d),this._processItem(d),this._tryApplySelectedSub(d)),e&&(this.$.templateSubRow.render(),this.dispatchEvent(new CustomEvent('px-vis-toolbar-secondary-toggled',{bubbles:!0,composed:!0,detail:{open:[]!==this.currentSubConfig,withinChart:this.withinChart}})))},_tryProcessSubConfig:function(a){if(a.subConfig){var b=[],c=Object.keys(a.subConfig);if('right'===this.horizontalAlignment)for(var d=c.length-1;-1<d;d--)b.push(a.subConfig[c[d]]);else for(var d=0;d<c.length;d++)b.push(a.subConfig[c[d]]);this.set('currentSubConfig',b)}else this.set('currentSubConfig',[])},_tryApplySelectedSub:function(a){if(a.subConfig)for(var b=Object.keys(a.subConfig),c=0;c<b.length;c++)a.subConfig[b[c]].selected&&this._processItem(a.subConfig[b[c]])},_clickSubItem:function(a){a=Polymer.dom(a);var b=a.localTarget.value,c=this.currentSubConfig[b];if(c.buttonGroup){for(var d=0;d<this.currentSubConfig.length;d++)d!==b&&this.currentSubConfig[d].buttonGroup===c.buttonGroup&&this.set('currentSubConfig.'+d+'.selected',!1);this.set('currentSubConfig.'+b+'.selected',!c.toggle||!c.selected)}this._processItem(c)},_processItem:function(a){if(a.actionConfig&&('string'===typeof a.actionConfig?this.set('actionConfig',JSON.parse(a.actionConfig)):this.set('actionConfig',this.clone(a.actionConfig))),a.eventName&&this.fire('px-vis-event-request',{eventName:a.eventName,data:a}),a.onClick){var b=this._returnFn(a.onClick);this._setupContext(a,b)}this._setMouseCursor(a)},_returnFn:function(a){if('function'===typeof a)return a;return'string'===typeof a?eval('var f = function() { return '+a+';}; f();'):void 0},_setupContext:function(a,b){a.onClickContext?(b='toolbar'===a.onClickContext?b.bind(this):b.bind(a.onClickContext),b(a)):this.fire('px-vis-action-request',{function:b,data:a})},_setMouseCursor:function(a,b){var c,d=null;b&&(d=null),a.cursorIcon&&(d=a.cursorIcon),c=function(){this.set('interactionSpaceConfig.iconType',d)},this.fire('px-vis-action-request',{function:c,data:null})},_getIcon:function(a){return a.icon?a.icon+' ':''},_getSelectedClass:function(a){return a?'selected ':''},_hasTooltip:function(a){return this.hasUndefinedArguments(arguments)?void 0:a.tooltipLabel&&!!a.tooltipLabel.length},_alignRow:function(a){'left'===this.horizontalAlignment?(a.style['margin-left']=+this.chartMargin.left+'px',a.style['margin-right']=''):(a.style['margin-right']=+this.chartMargin.right+'px',a.style['margin-left']='')},_positionMainRow:function(){this.hasUndefinedArguments(arguments)||this._alignRow(this.$$('#mainRow'))},_positionSubRow:function(a,b){this.hasUndefinedArguments(arguments)||this.withinChart&&(this.$.templateSubRow.render(),this.$$('#subRow').style['margin-top']='above'===this.subToolbarAlignment?'0px':+b.top+'px',this._alignRow(this.$$('#subRow')))},_getSubRowClass:function(){var a='above'===this.subToolbarAlignment?'':'subrow--chart ';return a+='vertical'===this.subToolbarAlignment?' flex--col flex--bottom right ':' flex--row',a},_isWithinChart:function(){return this.hasUndefinedArguments(arguments)?void 0:this.withinChart},_getRowDirection:function(){return this.hasUndefinedArguments(arguments)?void 0:'right'===this.horizontalAlignment?'flex--row--rev right ':'flex--row '}});</script></body></html>