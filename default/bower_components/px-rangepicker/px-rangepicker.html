<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../px-datetime-common/px-datetime-range-behavior.html"><link rel="import" href="../px-datetime-common/px-datetime-button-behavior.html"><link rel="import" href="../px-datetime-range-field/px-datetime-range-field.html"><link rel="import" href="../px-datetime-range-panel/px-datetime-range-panel.html"><link rel="import" href="../iron-dropdown/iron-dropdown.html"><link rel="import" href="css/px-rangepicker-styles.html"></head><body><dom-module id="px-rangepicker"><template><style include="px-rangepicker-styles"></style><px-datetime-range-field id="rangeField" slot="dropdown-trigger" from-moment="{{_tempFromMomentObj}}" to-moment="{{_tempToMomentObj}}" date-format="{{dateFormat}}" time-format="{{timeFormat}}" hide-time="{{hideTime}}" time-zone="{{timeZone}}" hide-icon="{{hideIcon}}" show-time-zone="[[showTimeZone]]" block-future-dates="{{blockFutureDates}}" block-past-dates="{{blockPastDates}}" hide-validation-messages="{{hideValidationMessages}}" prevent-notification-on-change="" allow-wrap="[[allowWrap]]" show-field-titles="[[showFieldTitles]]" resources="[[resources]]" language="[[language]]" formats="[[formats]]" min-date="[[minDate]]" max-date="[[maxDate]]" required="[[required]]"></px-datetime-range-field><iron-dropdown id="dropdown" opened="{{opened}}" vertical-offset="50" vertical-align="auto" horizontal-align="auto" dynamic-align=""><px-datetime-range-panel id="panel" slot="dropdown-content" from-moment="{{_tempFromMomentObj}}" to-moment="{{_tempToMomentObj}}" time-format="{{timeFormat}}" hide-time="{{hideTime}}" hide-presets="{{hidePresets}}" show-buttons="{{showButtons}}" block-future-dates="{{blockFutureDates}}" block-past-dates="{{blockPastDates}}" preset-ranges="{{presetRanges}}" time-zone="[[timeZone]]" day-week-start-index="[[dayWeekStartIndex]]" resources="[[resources]]" language="[[language]]" formats="[[formats]]" min-date="[[minDate]]" max-date="[[maxDate]]"></px-datetime-range-panel></iron-dropdown></template></dom-module><script>Polymer({is:'px-rangepicker',behaviors:[PxDatetimeBehavior.TempRange,PxDatetimeBehavior.Buttons],properties:{opened:{type:Boolean,observer:'_processClose'},dateFormat:{type:String,value:'MM/DD/YYYY'},timeFormat:{type:String,value:'HH:mm A'},hideTime:{type:Boolean,value:!1},hidePresets:{type:Boolean,value:!1},hideIcon:{type:Boolean,value:!1},allowWrap:{type:Boolean,value:!1},showFieldTitles:{type:Boolean,value:!1},isValid:{type:Boolean,notify:!0,value:!0},required:{type:Boolean,value:!1},hideValidationMessages:{type:Boolean,value:!1},showTimeZone:{type:String,value:''},presetRanges:{type:Object,value:function(){var a=Px.moment();return[{displayText:'Last 7 Days',startDateTime:a.clone().subtract(7,'days'),endDateTime:a},{displayText:'This Month',startDateTime:a.clone().startOf('month'),endDateTime:a.clone().endOf('month')},{displayText:'Last Month',startDateTime:a.clone().subtract(1,'months').startOf('month'),endDateTime:a.clone().subtract(1,'months').endOf('month')}]}}},listeners:{"px-datetime-entry-icon-clicked":'_toggleBoxOpen',"px-datetime-button-clicked":'_buttonClicked',tap:'_handleTap'},keyBindings:{esc:'_onEsc',enter:'_onEnter'},attached:function(){this.$.rangeField.addEventListener('from-moment-changed',this._rangeFieldMomentChanged.bind(this)),this.$.rangeField.addEventListener('to-moment-changed',this._rangeFieldMomentChanged.bind(this))},_onEsc:function(){this.opened&&this.set('opened',!1)},_onEnter:function(){this.opened&&(this._validateCalendarMoment(),this.set('opened',!1))},_toggleBoxOpen:function(){this.$.dropdown.toggle()},_processClose:function(a,b){if(!(void 0===b||a)){var c=!this.showButtons&&this.$.panel.timeIsValid&&this.$.rangeField.isValid;c?this._applyTempRangeMoment(c):(this._rollbackTempFromMoment(this.fromMoment),this._rollbackTempToMoment(this.toMoment))}},_tempMomentChanged:function(a){'rangefield'===a?this._applyTempRangeMoment():'rangepanel'===a&&!this.showButtons&&this._validateCalendarMoment()},_calendarToMomentChanged:function(a){a.detail.value&&this.set('_tempToMomentObj',a.detail.value)},_rangeFieldMomentChanged:function(){this.opened||this._applyTempRangeMoment()},_validateCalendarMoment:function(){this.opened&&this.$.rangeField.isValid&&(this._applyTempRangeMoment(),this.fire('px-datetime-range-submitted',{fromMoment:this.fromMoment,toMoment:this.toMoment}),this.set('opened',!1))},_buttonClicked:function(a){a.detail.action?this._validateCalendarMoment():(this._rollbackTempFromMoment(),this._rollbackTempToMoment()),this.set('opened',!1)},_handleTap:function(a){if(!0===this.opened)for(var b=Polymer.dom(a).path,c=0;c<b.length;c++)if('PX-DROPDOWN'===b[c].nodeName)return void this.set('opened',!1)}});</script></body></html>