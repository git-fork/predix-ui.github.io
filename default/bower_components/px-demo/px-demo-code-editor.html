<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../px-code-editor/px-code-editor.html"><link rel="import" href="../px-modal/px-modal.html"><link rel="import" href="beautify-import.html"></head><body><dom-module id="px-demo-code-editor"><template><style>.code-editor{width:800px;height:500px;}.code-editor-container{padding-bottom:1rem;}</style><px-modal header-text="[[title]]" accept-text="Save" reject-text="Cancel" opened="{{enabled}}" on-px-modal-accepted="_handleEditorSaved" on-px-modal-rejected="_handleEditorCanceled" on-px-modal-dismissed="_handleEditorCanceled"><div slot="body" class="code-editor-container"><px-code-editor id="editor" class="code-editor" mode="javascript" value="[[_code]]"></px-code-editor></div></px-modal></template></dom-module><script>(()=>{function a(a){let b;try{b=JSON.parse(a)}catch(c){b=eval(a)}return b||''}function b(a){return js_beautify(a)}function c(a){if(Array.isArray(a)){if(0===a.length)return'[]';const b=a.map((b)=>Array.isArray(b)?c(b):d(b)).join(',');return`[${b}]`}}function d(a){const b=Object.keys(a);let e='';e+='{';for(var f=0;f<b.length;f++){let g=b[f],h=a[g];e+=g+':',e+='function'===typeof h?h.toString():Array.isArray(h)?c(h):'object'===typeof h?d(h):JSON.stringify(h),f!==b.length-1&&(e+=',')}return e+='}',e}function e(a){return Array.isArray(a)?c(a):a&&'object'===typeof a?d(a):a+''}function f(a){return eval('(function() { return '+a+' })()')}Polymer({is:'px-demo-code-editor',properties:{enabled:{type:Boolean,value:!1,reflectToAttribute:!0,notify:!0},title:{type:String,value:''},target:{type:HTMLElement,observer:'_bindTargetListener'}},created:function(){this._handleEditRequest=this._handleEditRequest.bind(this)},attached:function(){this.target||(this.target=this.parentNode)},detached:function(){this.target=null},_bindTargetListener(a,b){b&&b.removeEventListener('px-demo-props-code-edit-request',this._handleEditRequest),a&&a.addEventListener('px-demo-props-code-edit-request',this._handleEditRequest)},_handleEditRequest:function(a){const{value:c,mode:d,title:f,save:g}=a.detail;let h='';if('code:JSON'===d)try{h=b(JSON.stringify(c))}catch(a){}'code:EvaluatedJavaScript'===d&&(h=e(c)),this._code=h,this._codeType=d,this._editorSaveCallback=g,this.title=f,this.enabled=!0},_handleEditorSaved:function(){if(this._editorSaveCallback&&this._codeType){let b='';'code:JSON'===this._codeType&&(b=a(this.$.editor.value)),'code:EvaluatedJavaScript'===this._codeType&&(b=f(this.$.editor.value)),this._editorSaveCallback(b),this._code=null,this._codeType=null,this._editorSaveCallback=null,this.enabled=!1}},_handleEditorCanceled:function(){this._code=null,this._codeType=null,this._editorSaveCallback=null,this.enabled=!1}})})();</script></body></html>