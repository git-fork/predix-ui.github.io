(function(){'use strict';window.PxMapBehavior=window.PxMapBehavior||{},PxMapBehavior.LayerImpl={attached(){this.notifyInstReady(this.canAddInst())},detached(){this.shouldRemoveInst()},shouldAddInst(a){PxMapBehavior.ElementImpl.shouldAddInst.call(this,a),this.elementInst&&a&&this.addInst(a)},shouldRemoveInst(a){PxMapBehavior.ElementImpl.shouldRemoveInst.call(this,a),this.elementInst&&this.removeInst(a?a:void 0)},addInst(a){a.addLayer(this.elementInst)},removeInst(){this.elementInst.remove()},canAddInst(){return!0}},PxMapBehavior.Layer=[PxMapBehavior.Element,PxMapBehavior.LayerImpl],PxMapBehavior.ParentLayerImpl={listeners:{"px-map-element-instance-created":'_tryToAddAllChildren',"px-map-element-ready-to-add":'_tryToAddOneChild'},created(){this._attachedChildren=this._attachedChildren||new WeakMap},detached(){this._detachLayerChildren()},_tryToAddAllChildren(a){const b=Polymer.dom(a);this.elementInst&&b.rootTarget===this&&this._attachLayerChildren()},_tryToAddOneChild(a){const b=Polymer.dom(a);b.rootTarget!==this&&(a.stopPropagation(),this.elementInst&&this._attachLayerChild(b.rootTarget))},_attachLayerChildren(){const a=this.getEffectiveChildren();a&&a.length&&a.forEach((a)=>{this._attachLayerChild(a)})},_attachLayerChild(a){!this._attachedChildren.has(a)&&a.shouldAddInst&&a.canAddInst&&a.canAddInst()&&(this._attachedChildren.set(a,!0),this.async(()=>{a.shouldAddInst(this.elementInst)}))},_detachLayerChildren(){const a=this.getEffectiveChildren();a&&a.length&&a.forEach((a)=>{this._detachLayerChild(a)})},_detachLayerChild(a){this._attachedChildren.has(a)&&a.shouldRemoveInst&&(this._attachedChildren.delete(a),this.async(()=>{a.shouldRemoveInst(this.elementInst)}))}},PxMapBehavior.ParentLayer=[PxMapBehavior.ParentLayerImpl]})();