<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../px-vis/px-vis-behavior-chart.html"><link rel="import" href="../px-vis/px-vis-behavior-common.html"><link rel="import" href="../px-vis/px-vis-behavior-d3.html"><link rel="import" href="../px-vis/px-vis-behavior-renderer.html"><link rel="import" href="../px-vis/px-vis-behavior-scale-radial.html"><link rel="import" href="../px-vis/px-vis-svg-canvas.html"><link rel="import" href="../px-vis/px-vis-scatter.html"><link rel="import" href="../px-vis/px-vis-line-svg.html"><link rel="import" href="../px-vis/px-vis-scatter-canvas.html"><link rel="import" href="../px-vis/px-vis-line-canvas.html"><link rel="import" href="../px-vis/px-vis-interaction-space.html"><link rel="import" href="../px-vis/px-vis-axis.html"><link rel="import" href="../px-vis/px-vis-tooltip.html"><link rel="import" href="../px-vis/px-vis-register.html"><link rel="import" href="../px-vis/px-vis-clip-path.html"><link rel="import" href="../px-vis/px-vis-radial-gridlines.html"><link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="import" href="../px-vis/px-vis-toolbar.html"><link rel="import" href="../px-vis/px-vis-cursor.html"><link rel="import" href="../px-vis/px-vis-highlight-point.html"><link rel="import" href="../px-vis/px-vis-highlight-point-canvas.html"><link rel="import" href="../app-localize-behavior/app-localize-behavior.html"><link rel="import" href="../px-vis/px-vis-annotations.html"><link rel="import" href="css/px-vis-polar-styles.html"></head><body><dom-module id="px-vis-polar"><template><style include="px-vis-polar-styles"></style><div id="wrapper" class$="{{_chartWrapperClass}}"><div id="svgWrapper"><div class$="{{_registerWrapperClass}}"><px-vis-register id="register" chart-width="[[width]]" class$="{{_getHideClass(hideRegister)}}" dynamic-menu-config="[[dynamicMenuConfig]]" tooltip-data="[[tooltipData]]" chart-data="[[_filteredData]]" complete-series-config="[[completeSeriesConfig]]" muted-series="{{mutedSeries}}" type="{{_registerType}}" x-axis-type="linear" y-axis-type="linear"></px-vis-register><div class="flex flex--col safari-flex-fix"><px-vis-toolbar id="toolbar" current-sub-config="[[toolbarSubConfig]]" action-config="{{actionConfig}}" within-chart="" chart-margin="[[margin]]" show-tooltip="{{_internalShowTooltip}}" config="{&quot;zoom&quot;: true, &quot;pan&quot;: true, &quot;tooltip&quot;: true}"></px-vis-toolbar><px-vis-svg-canvas class="inline--flex" id="svg" width="[[_smallerSide]]" height="[[_smallerSide]]" canvas-context="{{canvasContext}}" canvas-layers="{{canvasLayers}}" canvas-layers-config="[[canvasLayersConfig]]" svg="{{svg}}" px-svg-elem="{{pxSvgElem}}" svg-lower="{{svgLower}}" px-svg-elem-lower="{{pxSvgElemLower}}" offset="[[_center]]"><px-vis-annotations slot="4" svg="[[svg]]" x="[[x]]" y="[[y]]" margin="[[_internalMargin]]" domain-changed="[[domainChanged]]" complete-series-config="[[completeSeriesConfig]]" annotation-data="[[annotationData]]" show-strong-icon="[[showStrongIcon]]" offset="[[_center]]" radial=""></px-vis-annotations></px-vis-svg-canvas></div><px-vis-interaction-space id="interactionSpace" chart-id="[[chartId]]" svg="[[layer.6]]" width="[[_radius]]" height="[[_radius]]" radial="" use-degrees="[[useDegrees]]" counter-clockwise="[[counterClockwise]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]" use-quadtree="" series-keys="[[_seriesKeys]]" chart-data="[[_filteredData]]" default-empty-data="[[defaultEmptyData]]" tooltip-data="{{tooltipData}}" crosshair-data="{{crosshairData}}" generating-crosshair-data="{{generatingCrosshairData}}" x-axis-type="linear" y-axis-type="linear" complete-series-config="[[completeSeriesConfig]]" mouse-rect="{{mouseRect}}" time-data="[[timeData]]" action-config="[[actionConfig]]" show-tooltip="{{_computedShowTooltip}}" prevent-web-worker-synchronization="[[preventWebWorkerSynchronization]]" ww-data-sync-counter="[[wwDataSyncCounter]]" extents-data="{{extentsData}}" extents-action="{{extentsAction}}" muted-series="[[mutedSeries]]" hard-mute="[[hardMute]]"></px-vis-interaction-space><template is="dom-repeat" items="[[_seriesKeys]]"><template is="dom-if" if="[[renderToCanvas]]" restamp=""><px-vis-scatter-canvas canvas-context="[[canvasContext]]" series-id="[[item]]" chart-data="[[_filteredData]]" complete-series-config="[[completeSeriesConfig]]" radial="" renderer-type="filteredChartData" width="[[_diameter]]" height="[[_diameter]]" counter-clockwise="[[counterClockwise]]" use-degrees="[[useDegrees]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]" muted-series="[[mutedSeries]]" serie-to-redraw-on-top="[[serieToRedrawOnTop]]" show-arrows="[[showArrows]]" arrow-config="[[arrowConfig]]"></px-vis-scatter-canvas><px-vis-line-canvas id="lineCanvas" canvas-context="[[canvasContext]]" series-id="[[item]]" chart-data="[[_filteredData]]" complete-series-config="[[completeSeriesConfig]]" radial-line="" renderer-type="filteredChartData" counter-clockwise="[[counterClockwise]]" use-degrees="[[useDegrees]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]" muted-series="[[mutedSeries]]" stroke-width="[[_returnStrokeWidth(item, completeSeriesConfig)]]" serie-to-redraw-on-top="[[serieToRedrawOnTop]]"></px-vis-line-canvas></template><template is="dom-if" if="[[!renderToCanvas]]" restamp=""><px-vis-scatter svg="[[layer.3]]" series-id="[[item]]" chart-data="[[_filteredData]]" radial="" width="[[_diameter]]" height="[[_diameter]]" clip-path="" counter-clockwise="[[counterClockwise]]" use-degrees="[[useDegrees]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]" muted-series="[[mutedSeries]]" complete-series-config="[[completeSeriesConfig]]" time-data="{{timeData}}" show-arrows="[[showArrows]]" arrow-config="[[arrowConfig]]"></px-vis-scatter><px-vis-line-svg svg="[[layer.2]]" radial-line="" counter-clockwise="[[counterClockwise]]" use-degrees="[[useDegrees]]" series-id="[[item]]" chart-data="[[_filteredData]]" muted-series="[[mutedSeries]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]" stroke-width="[[_returnStrokeWidth(item, completeSeriesConfig)]]" complete-series-config="[[completeSeriesConfig]]"></px-vis-line-svg></template></template></div></div><px-vis-cursor horizontal-line="full" vertical-line="full" circle-point="yes" radial="" counter-clockwise="[[counterClockwise]]" use-degrees="[[useDegrees]]" svg="[[layer.5]]" width="[[_radius]]" height="[[_radius]]" margin="[[_internalCircleMargins]]" chart-data="[[_filteredData]]" tooltip-data="[[tooltipData]]" complete-series-config="[[completeSeriesConfig]]" muted-series="[[mutedSeries]]" hard-mute="[[hardMute]]" offset="[[offset]]" series-keys="[[_seriesKey]]" allow-negative-values="[[allowNegativeValues]]"></px-vis-cursor><template is="dom-repeat" items="[[_axisConfigArray]]"><px-vis-axis svg="[[layer.4]]" axis="[[y]]" height="[[item.height]]" width="[[item.width]]" title="[[item.title]]" title-location="[[item.titleLocation]]" rotation="[[item.rotation]]" orientation="[[item.orientation]]" label-rotation="[[item.labelRotation]]" label-translation="[[item.labelTranslation]]" label-type-size="[[item.labelTypeSize]]" title-type-size="[[item.titleTypeSize]]" ticks="[[_getNumberOfTick(_radius)]]" margin="[[margin]]" complete-series-config="[[completeSeriesConfig]]" prevent-series-bar="" domain-changed="[[domainChanged]]" label-position="inline" drawn-tick-values="{{_drawnTickValues}}"></px-vis-axis></template><px-vis-radial-gridlines id="gridlines" svg="[[svgLower]]" axis="[[y]]" domain-changed="[[domainChanged]]" margin="[[margin]]" tick-values="[[_drawnTickValues]]"></px-vis-radial-gridlines><px-vis-tooltip id="tooltip" tooltip-data="[[tooltipData]]" chart-data="[[_filteredData]]" muted-series="[[mutedSeries]]" hard-mute="[[hardMute]]" x-axis-type="linear" y-axis-type="linear" complete-series-config="[[completeSeriesConfig]]" hover-target="[[mouseRect]]" mouse-position="[[mousePosition]]" tooltip-style="light" hide="[[!_computedShowTooltip]]" series-keys="[[_seriesKey]]"></px-vis-tooltip><template id="highlighterDomIf" is="dom-if" if="[[renderToCanvas]]" restamp="" on-dom-change="_highlighterConfigChanged"><px-vis-highlight-point-canvas id="highlighterCanvas" radial="" counter-clockwise="[[counterClockwise]]" use-degrees="[[useDegrees]]" width="[[_diameter]]" height="[[_diameter]]" canvas-context="[[canvasLayers.highlighter]]" canvas-layers-config="{{canvasLayersConfig}}" layers-to-mask="[[canvasContext]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]" time-data="[[timeData]]" complete-series-config="[[completeSeriesConfig]]" series-keys="[[_seriesKeys]]" chart-data="[[chartData]]" generating-crosshair-data="[[generatingCrosshairData]]" default-empty-data="{{defaultEmptyData}}" tooltip-data="{{tooltipData}}" crosshair-data="[[crosshairData]]" hard-mute="[[hardMute]]" muted-series="[[mutedSeries]]"></px-vis-highlight-point-canvas></template><template is="dom-if" if="[[!renderToCanvas]]" restamp="" on-dom-change="_highlighterConfigChanged"><px-vis-highlight-point id="highlighter" radial="" counter-clockwise="[[counterClockwise]]" use-degrees="[[useDegrees]]" svg="[[layer.5]]" layers-to-mask="[[getSvgLayersToMask(layer)]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]" time-data="[[timeData]]" complete-series-config="[[completeSeriesConfig]]" chart-data="[[chartData]]" generating-crosshair-data="[[generatingCrosshairData]]" default-empty-data="{{defaultEmptyData}}" tooltip-data="{{tooltipData}}" crosshair-data="[[crosshairData]]" hard-mute="[[hardMute]]" muted-series="[[mutedSeries]]" series-keys="[[_seriesKey]]"></px-vis-highlight-point></template></div></template></dom-module><script>Polymer({is:'px-vis-polar',behaviors:[PxVisBehavior.observerCheck,PxVisBehaviorD3.svg,PxVisBehaviorD3.axes,PxVisBehaviorD3.selectedDomain,PxVisBehaviorD3.clipPath,PxVisBehavior.dataset,PxVisBehavior.mutedSeries,PxVisBehaviorChart.circleChart,PxVisBehavior.tooltipData,PxVisBehavior.extentsData,PxVisBehavior.axisTypes,PxVisBehavior.completeSeriesConfig,PxVisBehaviorScale.radial,PxVisBehaviorChart.chartCommon,PxVisBehaviorChart.saveImage,PxVisBehaviorChart.subConfiguration,PxVisBehaviorD3.domainUpdate,PxVisBehavior.polarData,PxVisBehaviorChart.timeFiltering,PxVisBehaviorChart.chartAutoResize,PxVisBehaviorChart.registerPositioning,PxVisBehaviorChart.layers,PxColorsBehavior.dataVisColorTheming,PxVisBehavior.dynamicMenuConfig,PxVisBehaviorChart.actionRequest,PxVisBehaviorChart.registerConfigs,PxVisBehaviorChart.showTooltip,PxVisBehaviorChart.toolbarSubConfig,PxVisBehaviorChart.chartToolbarConfig,PxVisBehavior.actionConfig,PxVisBehaviorD3.canvasContext,PxVisBehaviorD3.renderToCanvas,PxVisBehaviorChart.tooltipFollowMouseCalculation,PxVisBehaviorChart.highlighterConfigs,PxVisBehavior.crosshairData,PxVisBehaviorChart.webWorkerSynchronization,Polymer.AppLocalizeBehavior,PxVisBehaviorRenderer.base,PxVisBehavior.updateStylesOverride,PxVisBehavior.amplitudeExtents,PxVisBehaviorChart.zoomGeneric,PxVisBehaviorD3.scatterArrow,PxVisBehavior.annotationData],properties:{_axisConfigArray:{type:Array,computed:'_computeAxisConfig(_diameter, counterClockwise, y, axisLabels)'},counterClockwise:{type:Boolean,value:!1},_amplitudeKey:{type:String,computed:'_computeAmplitudeKey(completeSeriesConfig)'},_drawnTickValues:{type:Array,notify:!0},axisLabels:{type:Array,value:function(){return['0\xB0','90\xB0','180\xB0','270\xB0']}},unitLabelFontSize:{type:Number,value:15},clockwiseLabelFontSize:{type:Number,value:15},_clockwiseLabelGroup:{type:Object},_unitLabelGroup:{type:Object},mouseRect:{type:Object},resources:{type:Object,value:function(){return{en:{clockwise:'clockwise',"counter clockwise":'counter clockwise'}}}},language:{type:String,value:'en'},useKeyIfMissing:{type:Boolean,value:!0},_lastScale:{type:Array,value:function(){return[1]}},allowNegativeValues:{type:Boolean,value:!1}},polar:!0,listeners:{"iron-resize":'_onIronResize',"px-vis-toolbar-reset-zoom":'resetZoom',"px-vis-toolbar-zoom-in":'zoomIn',"px-vis-toolbar-zoom-out":'zoomOut',"px-vis-toolbar-undo-zoom":'undoZoom',"px-vis-interaction-space-start-panning":'addToZoomStack'},observers:['_drawUnitLabel(svg, completeSeriesConfig.*, _radius, unitLabelFontSize)','_drawClockwiseLabel(svg, _radius, counterClockwise, clockwiseLabelFontSize, localize)','_createLayersOnce(svg, numberOfLayers)','_keepDataInSync(_filteredData.*, chartId)','_seriesKeysChanged(_seriesKeys.*)','_setYScale(_radius,centerOffset)','_generateChartExtents(chartData.*, _amplitudeKey)','_generateChartExtents(amplitudeExtents)','_setDomain(y, _calculatedExtents)','_tooltipConfigChanged(tooltipConfig.*)','_registerConfigChanged(registerConfig.*)','_highlighterConfigChanged(highlighterConfig.*)','_toolbarConfigChanged(toolbarConfig)','_interactionSpaceConfigChanged(interactionSpaceConfig.*)','_langChanged(language)','_mutedChanged(mutedSeries.*, hardMute)','_renderFilteredChartData(domainChanged, canvasContext, _filteredData.*, mutedSeries.*, completeSeriesConfig.*, preventInitialDrawing, counterClockwise, renderToCanvas)','_renderHighlight(domainChanged, canvasLayers.highlighter, completeSeriesConfig.*, preventInitialDrawing, counterClockwise, renderToCanvas)','_renderSeriesOnTop(serieToRedrawOnTop)'],created:function(){this._tooltipCalcHoverTargetId='wrapper'},ready:function(){this._wwSyncDataPropName='_filteredData',this.defaultSeriesConfig.markerFillOpacity||(this.defaultSeriesConfig.markerFillOpacity='0.5'),this.defaultSeriesConfig.markerStrokeOpacity||(this.defaultSeriesConfig.markerStrokeOpacity='0'),this.defaultSeriesConfig.xAxisUnit||(this.defaultSeriesConfig.xAxisUnit='\xB0'),this.set('numberOfLayers',7),this.set('_internalCircleMargins',{top:30,right:0,bottom:60,left:10}),this._setCompleteSeriesConfig(),this._extentsDataRoutes.zoom='_zooooooooom',this._extentsDataRoutes.pan='_paaaaaaaaan'},_tooltipConfigChanged:function(){this.hasUndefinedArguments(arguments)||this._applyConfigToElement(this.tooltipConfig,this.$.tooltip)},_registerConfigChanged:function(){this.hasUndefinedArguments(arguments)||this._applyConfigToElement(this.registerConfig,this.$.register)},_toolbarConfigChanged:function(){this.hasUndefinedArguments(arguments)||this._applyConfigToElement(this.toolbarConfig,this.$.toolbar)},_interactionSpaceConfigChanged:function(){this.hasUndefinedArguments(arguments)||this._applyConfigToElement(this.interactionSpaceConfig,this.$.interactionSpace)},_highlighterConfigChanged:function(){var a=this.renderToCanvas?this.$$('#highlighterCanvas'):this.$$('#highlighter');a&&this._doesObjHaveValues(this.highlighterConfig)&&this._applyConfigToElement(this.highlighterConfig,a)},_seriesKeysChanged:function(){this.hasUndefinedArguments(arguments)||this.renderToCanvas&&this.canvasContext&&this.canvasContext.pxClearCanvas&&this.canvasContext.pxClearCanvas()},_onIronResize:function(){var a=Math.max;this.preventResize||this.debounce('ironresize',function(){if(!this.preventResize){var b=this.$.wrapper.getBoundingClientRect(),c=this.$.toolbar.getBoundingClientRect(),d=this.$.register.getBoundingClientRect(),e=0,f=0;f+=c.height,'horizontal'===this.$.register.type?f+=d.height:e+=d.width,this.set('width',a(b.width-e,0)),this.set('height',a(b.height-f,0))}},this.debounceResizeTiming)},_adjustArrayForCounterclockwise:function(a){var b=[];return b[0]=a[0],b[1]=a[3],b[2]=a[2],b[3]=a[1],b},_computeAxisConfig:function(a,b,c,d){var e=Math.PI;if(!this.hasUndefinedArguments(arguments)){var f=[0,90,180,270],g=['middle','start','middle','end'],h=[],j=c.range()[1]-c.range()[0],k=10,l=5,m=6,n=d;this.counterClockwise&&(f=this._adjustArrayForCounterclockwise(f),n=this._adjustArrayForCounterclockwise(n));for(var o=0;4>o;o++){var i={},p={};i.title=n[o],i.width=j,i.rotation=-f[o]+180,i.orientation='custom',i.labelTypeSize=12,i.titleTypeSize=15,i.height=j,i.labelRotation=this.counterClockwise?180-90*o:180+90*o%360,i.labelTranslation=[0,4],p.x=+(Math.cos((o-1)*e/2)*(j+k+m)),p.y=l+ +(Math.sin((o-1)*e/2)*(j+k+l+m)),p.r=0,p.anchor=g[o],i.titleLocation=p,h.push(i)}return h}},_computeAmplitudeKey:function(a){return this.hasUndefinedArguments(arguments)?void 0:Object.keys(a).map(function(b){return a[b].y})},_drawUnitLabel:function(a,b,c,d){if(!this.hasUndefinedArguments(arguments)){var e,f=Object.keys(this.completeSeriesConfig),g=Math.PI/4,h=this._radius+10;this._unitLabelGroup||(this.set('_unitLabelGroup',this.svg.append('g').attr('class','unit-group')),this._unitLabelGroup.append('text'));for(var j=0;j<f.length&&!e;j++)e=this.completeSeriesConfig[f[j]].yAxisUnit;this._unitLabelGroup.selectAll('text').text(e).attr('font-size',d+'px').style('font-family',this._checkThemeVariable('--px-vis-font-family','')).attr('fill',this._checkThemeVariable('--px-vis-axis-inline-title-color','rgb(0,0,0)')),this._unitLabelGroup.attr('transform','translate('+Math.cos(g)*h+','+-Math.sin(g)*h+')')}},_drawClockwiseLabel:function(a,b,c,d){if(!this.hasUndefinedArguments(arguments)){var e=-Math.PI/2,f=this._radius+55;this._clockwiseLabelGroup||(this.set('_clockwiseLabelGroup',this.svg.append('g').attr('class','clockwise-group')),this._clockwiseLabelGroup.append('text')),this._clockwiseLabelGroup.selectAll('text').text(c?this.localize('counter clockwise'):this.localize('clockwise')).attr('font-size',d+'px').style('font-family',this._checkThemeVariable('--px-font-family','')).attr('fill',this._checkThemeVariable('--px-vis-axis-inline-title-color','rgb(0,0,0)')).attr('text-anchor','middle'),this._clockwiseLabelGroup.attr('transform','translate('+Math.cos(e)*f+','+-Math.sin(e)*f+')')}},_getNumberOfTick:function(a){return this.hasUndefinedArguments(arguments)?void 0:Math.min(Math.max(a/70,2),7)},_langChanged:function(){this.hasUndefinedArguments(arguments)||this._recreateScales()},getSvgLayersToMask:function(){return this.hasUndefinedArguments(arguments)?void 0:[this.layer[2],this.layer[3]]},_zooooooooom:function(){this.zoomStack.push({radius:this._radius,center:this._center});var a=this._getLastScale(),b=Math.max(this.extentsData.w,this.extentsData.h),c=2*this.zoomStack[0].radius/(b/a),d=c*this.zoomStack[0].radius,e=(this.extentsData.x2-this.extentsData.x1)/2+this.extentsData.x1,f=(this.extentsData.y2-this.extentsData.y1)/2+this.extentsData.y1,g=this.zoomStack[0].center[0]-e/a*c,h=this.zoomStack[0].center[1]-f/a*c;this._lastScale.push(c),this.zoomTo(d,[g,h])},_getLastScale:function(){var a=this._lastScale.length-1;return this._lastScale[a]},zoomTo:function(a,b){this.set('_center',b),this.set('_radius',a),this.set('domainChanged',!this.domainChanged)},undoZoom:function(){if(this.zoomStack.length){var a=this.zoomStack.pop();this._lastScale.pop(),this.zoomTo(a.radius,a.center)}},resetZoom:function(){if(this.zoomStack.length){var a=this.zoomStack[0];this.zoomStack=[],this._lastScale=[1],this.zoomTo(a.radius,a.center)}},_autoZoom:function(a){this.zoomStack.push({radius:this._radius,center:this._center});var b=a?1+this.zoomInPercentage:1-this.zoomOutPercentage,c=this._getLastScale(),d=c*b,e=d*this.zoomStack[0].radius,f=this._smallerSide/2-this._center[0],g=this._smallerSide/2-this._center[1],h=this._smallerSide/2-f*b,i=this._smallerSide/2-g*b;this._lastScale.push(d),this.zoomTo(e,[h,i])},_paaaaaaaaan:function(){var a=this._center[0]+(this.extentsData.x2-this.extentsData.x1),b=this._center[1]+(this.extentsData.y2-this.extentsData.y1);this.zoomTo(this._radius,[a,b])},addToZoomStack:function(){this.zoomStack.push({radius:this._radius,center:this._center})},_mutedChanged:function(){this.hasUndefinedArguments(arguments)||!0===this.hardMute&&this._generateChartExtents()}});</script></body></html>