<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="css/px-percent-circle-styles.html"></head><body><dom-module id="px-percent-circle"><template><style include="px-percent-circle-styles"></style><svg id="container" height="100%" width="100%"><circle id="background" cx$="[[_cx]]" cy$="[[_cy]]" r$="[[_r]]" stroke-width$="[[_thickness]]"></circle><path id="arc" stroke-width$="[[_thickness]]" d$="[[_arcPath]]"></path><text id="text" x$="[[_cx]]" y$="[[_cy]]" font-size$="[[_placement.tf]]" dx$="[[_placement.tx]]" dy$="[[_placement.ty]]"><tspan id="label">[[_percent]]</tspan><tspan id="percent" font-size$="[[_placement.pf]]" dx$="[[_placement.px]]" dy$="[[_placement.py]]">%</tspan></text></svg></template></dom-module><script>Polymer({is:'px-percent-circle',properties:{val:{type:Number,value:0},max:{type:Number,value:100},thickness:{type:Number,value:30},_val:{type:Number,computed:'_computedVal(val)'},_max:{type:Number,computed:'_computedMax(max)'},_size:{type:Number,computed:'_computedSize(this.getBoundingClientRect())',observer:'_setViewBoxAttribute',value:300},_thickness:{type:Number,computed:'_computedThickness(_size,thickness)'},_percent:{type:Number,computed:'_computedPercent(_val,_max)'},_placement:{type:Object,computed:'_computedPlacement(_size)'},_cx:{type:Number,computed:'_computedCoordinate(_size)'},_cy:{type:Number,computed:'_computedCoordinate(_size)'},_r:{type:Number,computed:'_computedRadius(_size, _thickness)'},_arcPath:{type:String,computed:'_computedArcPath(_cx, _cy, _r, _percent)'}},_computedPlacement:function(a){return{tf:0.3*a+'px',tx:0.01*a,ty:0.09*a,pf:0.2*a+'px',px:-0.05*a,py:0}},_computedVal:function(a){return a=parseInt(a),(!a||0>a)&&0!==a?(console.log('Px Percent Circle: invalid value converted to 0%'),0):a},_computedMax:function(a){return a=parseInt(a),!a||0>=a?(console.log('Px Percent Circle: invalid max, assumed to be 100'),100):a},_computedPercent:function(a,b){return a>b?(console.log('Px Percent Circle: invalid value converted to 100%'),this._max=100,this._val=100,100):Math.round(100*(a/b))},_setViewBoxAttribute:function(a){this.$.container.setAttribute('viewBox',['0','0',a,a].join(' '))},_computedCoordinate:function(a){return a/2},_computedRadius:function(a,b){return a/2-b},_computedSize:function(a){return Math.min(a.height,a.width)},_computedThickness:function(a,b){return b=parseInt(b),!b||1>b||.1<=b/a?.1*a:b},_computedArcPath:function(a,b,c,e){var f=0,g=360*(e/100);g=360<=g?359.99:g;var h=this._polarToCartesian(a,b,c,g),i=this._polarToCartesian(a,b,c,f),j=180>=g-f?'0':'1',k=['M',h.x,h.y,'A',c,c,0,j,0,i.x,i.y].join(' ');return k},_polarToCartesian:function(a,b,c,d){var e=(d-90)*Math.PI/180;return{x:a+c*Math.cos(e),y:b+c*Math.sin(e)}}});</script></body></html>