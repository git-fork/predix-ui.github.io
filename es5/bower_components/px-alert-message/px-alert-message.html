<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../px-icon-set/px-icon-set.html"><link rel="import" href="../px-icon-set/px-icon.html"><link rel="import" href="../app-localize-behavior/app-localize-behavior.html"><link rel="import" href="../px-alert-label/px-alert-label.html"><link rel="import" href="css/px-alert-message-styles.html"></head><body><dom-module id="px-alert-message"><template><style include="px-alert-message-styles"></style><div id="alert" class="alert-message shadow-notification flex flex--left flex--stretch" on-animationend="_handleAnimationEnd"><template is="dom-if" if="{{ !_isTrue(type, 'more') }}"><div class$="severity flex flex--center {{type}}"><template is="dom-if" if="{{ !_isTrue(type, 'custom') }}"><template is="dom-if" if="{{ !hideBadge }}"><px-alert-label id="icon" type="{{type}}" label="{{_getLabel(type, hideSeverity)}}" badge=""></px-alert-label></template></template><slot></slot></div></template><div class="message-column flex flex--middle"><div class="message-container"><div class$="[[_getMessageClassNames(type, expanded)]]" id="message"><span class="title">{{ messageTitle }}</span> <span>{{ message }}</span></div><span id="showMoreButton" class$="[[_getShowMoreClassNames(overset)]]" hidden$="[[!overset]]">[[_showBtnText]]</span></div></div><template is="dom-if" if="{{ action }}"><div class="action"><template is="dom-if" if="{{ _isTrue(action, 'dismiss') }}"><button id="dismissButton" class="btn btn--bare dismiss" on-click="_action"><px-icon icon="px-nav:close"></px-icon></button></template><template is="dom-if" if="{{ !_isTrue(action, 'dismiss') }}"><button id="actionButton" class="btn btn--tertiary" on-click="_action">[[_actionText]]</button></template></div></template></div></template></dom-module><script>Polymer({is:'px-alert-message',behaviors:[Polymer.AppLocalizeBehavior],properties:{language:{type:String,value:'en'},useKeyIfMissing:{type:Boolean,value:!0},resources:{type:Object,value:function(){return{en:{"Show More":'Show More',OK:'OK',Open:'Open'}}}},type:{type:String,reflect:!0,value:'information'},messageTitle:{type:String,observer:'_checkMessageLength'},message:{type:String,observer:'_checkMessageLength'},autoDismiss:{type:Number,observer:'setAutoDismiss'},action:{type:String,reflect:!0},hideBadge:{type:Boolean,value:!1},hideSeverity:{type:Boolean,value:!1},_actionText:{type:String,computed:'_computeActionText(action, language, resources)'},_showBtnText:{type:String,computed:'_computeShowBtnText(expanded, language, resources)'},visible:{type:Boolean,value:!1,notify:!0,observer:'_handleVisibleChanged'},disableAutoShow:{type:Boolean,value:!1},expanded:{type:Boolean,notify:!0,value:!1},overset:{type:Boolean,value:!1,readOnly:!0,notify:!0}},observers:['_checkMessageLength(language, resources, type)'],created:function(){this._pendingDismiss=null},attached:function(){this.listen(this,'app-localize-resources-loaded','_checkMessageLength'),this.listen(this.$.showMoreButton,'tap','_toggleExpansion'),this.disableAutoShow||(this.visible=!0)},detached:function(){this.unlisten(this,'app-localize-resources-loaded','_checkMessageLength'),this.unlisten(this.$.showMoreButton,'tap','_toggleExpansion')},_getMessageClassNames:function(a,b){var c='message '+a;return b||(c+=' collapsed-message'),c},_getShowMoreClassNames:function(a){var b='actionable show-more';return a||(b+=' visuallyhidden'),b},setAutoDismiss:function(a){this._pendingDismissTask&&this.cancelAsync(this._pendingDismissTask),'number'===typeof a&&0<a&&this.visible&&(this._pendingDismissTask=this.async(function(){this._pendingDismissTask=null,this.visible=!1,this.fire('px-alert-message-action-auto-dismissed')},a))},_isTrue:function(c,a){return c===a},_toggleExpansion:function(){this.expanded=!this.expanded},_checkMessageLength:function(){this.debounce('check-message-length',function(){this.expanded&&(this.expanded=!1);var a=this.$.message;return'more'===this.type?void this._setOverset(!1):void(a.scrollHeight<=a.clientHeight?this._setOverset(!1):this._setOverset(!0))},1)},_action:function(){-1==this.action.indexOf('http')?('dismiss'===this.action||'acknowledge'===this.action)&&(this.visible=!1):window.open(this.action),this.fire('px-alert-message-action-triggered',{action:this.action})},_computeActionText:function(a){return'acknowledge'===a?this.localize('OK'):void 0!==a&&-1!=a.indexOf('http')?this.localize('Open'):''},_computeShowBtnText:function(a){return a?this.localize('Show Less'):this.localize('Show More')},_getLabel:function(a,b){return b?void 0:'important'===a?'1':'warning'===a?'2':'error'===a?'3':'information'===a?'4':'unknown'===a?'5':void 0},_handleVisibleChanged:function(a){var b=Polymer.dom(this.root).querySelector('#alert');null===b||(a&&!b.classList.contains('alert-message--visible')?(b.classList.add('alert-message--visible'),b.classList.add('fade-in'),this._checkMessageLength(),this.setAutoDismiss(this.autoDismiss||null)):!a&&b.classList.contains('alert-message--visible')&&(this.expanded=!1,b.classList.add('fade-out')))},_handleAnimationEnd:function(a){var b=Polymer.dom(a).rootTarget;b&&b===this.$.alert&&(b.classList.contains('fade-out')&&(b.classList.remove('alert-message--visible'),b.classList.remove('fade-out'),this.fire('px-alert-message-hidden')),b.classList.contains('fade-in')&&b.classList.remove('fade-in'))}});</script></body></html>