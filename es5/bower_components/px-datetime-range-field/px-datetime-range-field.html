<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../px-datetime-common/px-datetime-entry.html"><link rel="import" href="../px-datetime-common/px-datetime-behavior.html"><link rel="import" href="../px-datetime-common/px-datetime-range-behavior.html"><link rel="import" href="../px-datetime-common/px-datetime-button-behavior.html"><link rel="import" href="../px-datetime-common/px-datetime-buttons.html"><link rel="import" href="../px-datetime-field/px-datetime-field.html"><link rel="import" href="../px-datetime-common/px-datetime-validate.html"><link rel="import" href="css/px-datetime-range-field-styles.html"></head><body><dom-module id="px-datetime-range-field"><template><style include="px-datetime-range-field-styles"></style><div class$="{{_getWrapClass(allowWrap, showButtons, showFieldTitles)}} dt-position flex"><div id="fromFields" class$="{{_getFromFieldClass(allowWrap, showFieldTitles)}}"><span class="a11y">[[localize('from date')]]</span><template is="dom-if" if="{{showFieldTitles}}"><label>[[localize('From Date')]]</label></template><px-datetime-field id="fromDate" moment-obj="{{_tempFromMomentObj}}" date-format="[[dateFormat]]" time-format="[[timeFormat]]" show-time-zone="[[showTimeZone]]" time-zone="{{timeZone}}" hide-time="[[hideTime]]" hide-date="[[hideDate]]" hide-icon="{{hideIcon}}" is-valid="{{_fromValid}}" hide-validation-message="[[!_showFromValidationMessage]]" block-future-dates="{{blockFutureDates}}" block-past-dates="{{blockPastDates}}" resources="[[resources]]" language="[[language]]" formats="[[formats]]" min-date="[[minDate]]" max-date="[[maxDate]]" required="[[required]]"></px-datetime-field><template is="dom-if" if="{{_handleRangeValidationMessage(_isRangeValid, hideValidationMessages)}}"><div class="form-field__help validation-error dt-validation-text">[[localize('from cannot be later than to date')]]</div></template></div><template is="dom-if" if="{{!showFieldTitles}}"><span class="caps dt-to u-mh-">[[localize('TO')]]</span></template><div id="toFields" class$="{{_getToFieldClass(showButtons, allowWrap, showFieldTitles)}}"><span class="a11y">[[localize('to date')]]</span><template is="dom-if" if="{{showFieldTitles}}"><label>[[localize('To Date')]]</label></template><px-datetime-field id="toDate" moment-obj="{{_tempToMomentObj}}" date-format="[[dateFormat]]" time-format="[[timeFormat]]" show-time-zone="[[showTimeZone]]" time-zone="{{timeZone}}" hide-time="[[hideTime]]" hide-date="[[hideDate]]" hide-icon="{{hideIcon}}" is-valid="{{_toValid}}" hide-validation-message="[[!_showToValidationMessage]]" block-future-dates="{{blockFutureDates}}" block-past-dates="{{blockPastDates}}" resources="[[resources]]" language="[[language]]" formats="[[formats]]" min-date="[[minDate]]" max-date="[[maxDate]]" required="[[required]]"></px-datetime-field></div><template is="dom-if" if="{{showButtons}}"><px-datetime-buttons id="dtBtns" is-submit-button-valid="[[isValid]]" resources="[[resources]]" language="[[language]]" formats="[[formats]]"></px-datetime-buttons></template></div></template></dom-module><script>Polymer({is:'px-datetime-range-field',behaviors:[PxDatetimeBehavior.TempRange,PxDatetimeBehavior.Buttons,PxDatetimeBehavior.Validate],properties:{dateFormat:{type:String,value:'YYYY-MM-DD'},timeFormat:{type:String,value:'HH:mm:ss'},showTimeZone:{type:String,value:''},hideTime:{type:Boolean,value:!1},hideDate:{type:Boolean,value:!1},hideIcon:{type:Boolean,value:!1},isValid:{type:Boolean,notify:!0,computed:'_getIsValid(_fromValid, _toValid, _isRangeValid)'},required:{type:Boolean,value:!1},_isRangeValid:{type:Boolean,value:!0},_fromValid:{type:Boolean},_toValid:{type:Boolean},_showFromValidationMessage:{type:Boolean,value:!1},_showToValidationMessage:{type:Boolean,value:!1},hideValidationMessages:{type:Boolean,value:!1},allowWrap:{type:Boolean,value:!1},showFieldTitles:{type:Boolean,value:!1},resources:{type:Object,value:function(){return{en:{"from can not be later than to":'from can not be later than to',from:'from',TO:'TO'}}}}},keyBindings:{esc:'_onEsc',enter:'_onEnter'},observers:['_validationMessagePriority(_fromValid, _toValid, _isRangeValid, hideValidationMessages)'],listeners:{"px-datetime-button-clicked":'_dateTimeButtons',blur:'_tempMomentChanged'},ready:function(){this.listen(this.$.fromDate,'px-next-field','_focusFirstToEntry'),this.listen(this.$.toDate,'px-previous-field','_focusLastFromEntry'),this.listen(this.$.fromDate,'moment-obj-changed','_tempMomentChanged'),this.listen(this.$.toDate,'moment-obj-changed','_tempMomentChanged')},_focusFirstToEntry:function(a){this.$.toDate._focusFirstEntry(),a.stopPropagation(),a.stopImmediatePropagation()},_focusLastFromEntry:function(a){this.$.fromDate._focusLastEntry(),a.stopPropagation(),a.stopImmediatePropagation()},_getWrapClass:function(a,b,c){var d='';return d+=a?'flex--wrap ':'',d+=c&&b?'flex--middle':'flex--top',d},_getFromFieldClass:function(a,b){var c='';return c+=a?'u-pb+ ':'',c+=b?'dt-fields-space-between':'',c},_getToFieldClass:function(a,b){var c='';return c+=a?'u-mr- ':'',c+=b&&a?'u-pb+':'',c},_getIsValid:function(a,b,c){return a&&b&&c},_isOneFieldEmpty:function(){return this._tempFromMomentObj&&!this._tempToMomentObj||!this._tempFromMomentObj&&this._tempToMomentObj},_validateRangeAndFailedClass:function(a,b){return this._validateRangeOrder(a,b)?(this.$.fromDate._forcedFailedClass=!1,this.$.toDate._forcedFailedClass=!1,!0):(this.$.fromDate._forcedFailedClass=!0,this.$.toDate._forcedFailedClass=!0,!1)},_validationMessagePriority:function(a,b,c,d){a!==void 0&&b!==void 0&&(!c||d?(this.set('_showFromValidationMessage',!1),this.set('_showToValidationMessage',!1)):a?b?(this.set('_showFromValidationMessage',!0),this.set('_showToValidationMessage',!0)):(this.set('_showFromValidationMessage',!1),this.set('_showToValidationMessage',!0)):(this.set('_showFromValidationMessage',!0),this.set('_showToValidationMessage',!1)))},_handleRangeValidationMessage:function(a,b){return b||a?!1:!0},_dateTimeButtons:function(a){a.detail.action?this._applyChanges():this._cancelChanges()},_onEsc:function(){this._cancelChanges()},_onEnter:function(){this._applyChanges()},_tempMomentChanged:function(){this.showButtons?this._applyChanges(!0):this._applyChanges()},_applyChanges:function(a){this._isOneFieldEmpty()||(this._validateRangeAndFailedClass(this._tempFromMomentObj,this._tempToMomentObj)?(this.set('_isRangeValid',!0),this.isValid&&!a&&this._applyTempRangeMoment()&&this.fire('px-datetime-range-submitted',{fromMoment:this.fromMoment,toMoment:this.toMoment})):this.set('_isRangeValid',!1))},_cancelChanges:function(){this.$.fromDate._cancelChanges(),this.$.toDate._cancelChanges(),this._rollbackTempFromMoment(),this._rollbackTempToMoment(),this._applyChanges(!0)}});</script></body></html>