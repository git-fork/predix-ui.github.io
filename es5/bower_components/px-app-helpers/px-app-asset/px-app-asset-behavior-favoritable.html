<html><head><script>(function(){'use strict';window.PxAppBehavior=window.PxAppBehavior||{},PxAppBehavior.AssetFavoritable={properties:{favorited:{type:Object,notify:!0,value:function(){return[]}},favoritedRoute:{type:Array,notify:!0,value:function(){return[]}},favoritedMeta:{type:Object,notify:!0,readOnly:!0,value:null,computed:'_getFavoritedMeta(favorited.*)'}},created:function(){this._lastFavorite={source:null,reason:null,item:null}},observers:['_favoritedChanged(favorited.*)','_favoritedRouteChanged(favoritedRoute.*)'],listeners:{"px-app-asset-graph-created":'__favoriteInitialAssets',"px-app-asset-should-be-favorited":'_assetFavoritedByEvent',"px-app-asset-should-be-defavorited":'_assetDefavoritedByEvent'},multiFavorite:!0,favorite:function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'METHOD';if(!this.multiFavorite&&null===a&&null!==this._lastFavorite.item||this.multiFavorite&&null===a&&this.favorited.length||this.multiFavorite&&Array.isArray(a)&&!a.length&&this.favorited.length)return this.defavorite(Array.isArray(this.favorited)?[].concat(babelHelpers.toConsumableArray(this.favorited)):this.favorited),this.favorited;if(!a||!this.multiFavorite&&a===this._lastFavorite.item||this.multiFavorite&&-1<this.favorited.indexOf(a))return this.favorited;if(this.multiFavorite&&Array.isArray(a)&&a.length){for(var c=0;c<a.length;c++)this.favorite(a[c],b);return this.favorited}if(this._assetGraph.hasNode(a))return this._favoriteAsset(a,b),this.favorited;throw new Error('The following item could not be found in the items graph:\n          '+JSON.stringify(a))},defavorite:function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'METHOD';if(!this.multiFavorite&&(!a||this.favorited===a))return this._defavoriteAsset(this.favorited),this.favorited;if(this.multiFavorite&&!a)return this.defavorite([].concat(babelHelpers.toConsumableArray(this.favorited))),this.favorited;if(this.multiFavorite&&Array.isArray(a)&&this.favorited.length){for(var c=0;c<a.length;c++)this.defavorite(a[c],b);return this.favorited}return this.multiFavorite&&a&&-1<this.favorited.indexOf(a)?(this._defavoriteAsset(a),this.favorited):void 0},_getFavoritedMeta:function(a){var b=this;if(a.base&&!Array.isArray(a.base)&&this._assetGraph&&this._assetGraph.hasNode(a.base)){var c=this._assetGraph.getInfo(a.base,this.keys.id),d=c.path,e=c.route,f=c.parent,g=c.children,h=c.siblings;return{item:a.base,path:d,route:e,parent:f,children:g,siblings:h}}return a.base&&Array.isArray(a.base)&&a.base.length?a.base.map(function(a){var c=b._assetGraph.getInfo(a,b.keys.id),d=c.path,e=c.route,f=c.parent,g=c.children,h=c.siblings;return{item:a,path:d,route:e,parent:f,children:g,siblings:h}}):{item:null,path:null,route:null,parent:null,children:null,siblings:null}},_assetFavoritedByEvent:function(a){a.stopPropagation(),a.detail.item&&this.favorite(a.detail.item,'DOM_EVENT')},_assetDefavoritedByEvent:function(a){a.stopPropagation(),a.detail.item&&this.defavorite(a.detail.item,'DOM_EVENT')},_favoritedRouteChanged:function(a){a&&a.path&&this._assetGraph&&!this._squashFavoritedRouteChange&&(!this.multiFavorite&&'favoritedRoute'===a.path&&this._updateFavoritedFromRoute(a.base),this.multiFavorite&&('favoritedRoute'===a.path||'favoritedRoute.splices'==a.path)&&this._updateFavoritedFromRouteMulti(a.base))},_updateFavoritedFromRoute:function(a){if(this.favorited&&(null===a||Array.isArray(a)&&!a.length))return this._squashFavoritedChange=!0,this.defavorite(this.favorited,'ROUTE_CHANGED'),void(this._squashFavoritedChange=!1);var b=this._assetGraph.getNodeAtRoute(a);if(b!==this.favorited)if(b)this.favorite(b,'ROUTE_CHANGED');else throw new Error('The route '+JSON.stringify(a)+' could not be found in the items graph.')},_updateFavoritedFromRouteMulti:function(a){var b=this;if(this.favorited.length&&(null===a||Array.isArray(a)&&!a.length))return this._squashFavoritedChange=!0,this.defavorite(null,'ROUTE_CHANGED'),void(this._squashFavoritedChange=!1);if(Array.isArray(a))for(var c=0;c<a.length;c++)this._squashFavoritedChange=!0,this.favorited=a.map(function(a){var c=b._assetGraph.getNodeAtRoute(a);if(!c)throw new Error('The following item could not be found in the items graph:\n                  '+JSON.stringify(c));return c}),this._squashFavoritedChange=!1},_favoritedChanged:function(a){a&&a.path&&!this._squashFavoritedChange&&this._assetGraph&&(!this.multiFavorite&&'favorited'===a.path&&'undefined'!==typeof this.favoritedRoute&&this._updateFavoritedRoute(a.base),this.multiFavorite&&('favorited'===a.path||'favorited.splices'===a.path)&&'undefined'!==typeof this.favoritedRoute&&this._updateFavoritedRouteMulti(a.base))},_checkIfEmpty:function(a){return Array.isArray(a)?!!a.length:!!a},_updateFavoritedRoute:function(a){if(this._checkIfEmpty(a)){if(!this._assetGraph.hasNode(a)){throw new Error('The following item could not be found in the items graph:\n              '+JSON.stringify(a))}var b=this._assetGraph.getRoute(a,this.keys.id);this._routeIsDifferent(b,this.favoritedRoute)&&(this._squashFavoritedRouteChange=!0,this.favoritedRoute=b,this._squashFavoritedRouteChange=!1)}else this._squashFavoritedRouteChange=!0,this.favoritedRoute=null,this._squashFavoritedRouteChange=!1},_updateFavoritedRouteMulti:function(a){var b=this;a&&Array.isArray(a)&&a.length?(this._squashFavoritedRouteChange=!0,this.favoritedRoute=a.map(function(a){if(!b._assetGraph.hasNode(a))throw new Error('The following item could not be found in the items graph:\n                '+JSON.stringify(a));return b._assetGraph.getRoute(a,b.keys.id)}),this._squashFavoritedRouteChange=!1):(this._squashFavoritedRouteChange=!0,this.favoritedRoute=[],this._squashFavoritedRouteChange=!1)},__favoriteInitialAssets:function(){this.multiFavorite||!this.favorited||this.favoritedRoute?this.multiFavorite||this.favorited||!this.favoritedRoute?this.multiFavorite&&this.favorited.length&&!this.favoritedRoute.length?this._updateFavoritedRouteMulti(this.favorited):this.multiFavorite&&!this.favorited.length&&this.favoritedRoute.length&&this._updateFavoritedFromRouteMulti(this.favorited):this._updateFavoritedFromRoute(this.favoritedRoute):this._updateFavoritedRoute(this.favorited)},_routeIsDifferent:function(a,b){if(!a||!b)return!0;if(a.length!==b.length)return!0;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!0;return!1},_favoriteAsset:function(a,b){var c=this._assetGraph.getInfo(a,this.keys.id),d=c.route,e=c.path;this._lastFavorite={item:a,source:b,route:d},this.multiFavorite||(this.favorited=a),this.multiFavorite&&this.push('favorited',a),this.fire('px-app-asset-favorited',{source:b,item:a,route:d,path:e})},_defavoriteAsset:function(a,b){var c=this._assetGraph.getInfo(a,this.keys.id),d=c.route,e=c.path;this._lastFavorite={item:null,source:null,route:null},this.multiFavorite||(this.set('favorited',null),this.fire('px-app-asset-defavorited',{source:b,item:a,route:d,path:e})),this.multiFavorite&&(this.splice('favorited',this.favorited.indexOf(a),1),this.fire('px-app-asset-defavorited',{source:b,item:a,route:d,path:e}))}}})();</script></head><body></body></html>