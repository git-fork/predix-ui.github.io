<html><head><script>(function(){'use strict';window.PxAppBehavior=window.PxAppBehavior||{},PxAppBehavior.AssetActivatable={properties:{active:{type:Object,notify:!0,value:function(){return this.multiActivate?[]:null}},activeRoute:{type:Array,notify:!0,value:function(){return this.multiActivate?[]:null}},activeMeta:{type:Object,notify:!0,readOnly:!0,value:null,computed:'_getActiveMeta(active.*)'}},created:function(){this._lastActivation={source:null,reason:null,item:null}},observers:['_activeChanged(active.*)','_activeRouteChanged(activeRoute.*)'],listeners:{"px-app-asset-should-be-activated":'_assetActivatedByEvent',"px-app-asset-should-be-deactivated":'_assetDeactivatedByEvent'},_multiActivate:!1,get multiActivate(){return this._multiActivate},set multiActivate(a){a!==this._multiActivate&&(this._multiActivate=a,this._toggleMultiActivate(a))},_toggleMultiActivate:function(a){a&&!Array.isArray(this.active)&&(this.active=[],this.activeRoute=[]),!a&&Array.isArray(this.active)&&(this.active=this.active.length?this.active[0]:null)},activate:function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'METHOD';if(!this.multiActivate&&null===a&&null!==this._lastActivation.item||this.multiActivate&&null===a&&this.active.length||this.multiActivate&&Array.isArray(a)&&!a.length&&this.active.length)return this.deactivate(Array.isArray(this.active)?[].concat(babelHelpers.toConsumableArray(this.active)):this.active),this.active;if(!a||!this.multiActivate&&a===this._lastActivation.item||this.multiActivate&&-1<this.active.indexOf(a))return this.active;if(this.multiActivate&&Array.isArray(a)&&a.length){for(var c=0;c<a.length;c++)this.activate(a[c],b);return this.active}if(this._assetGraph.hasNode(a))return this._activateAsset(a,b),this.active;throw new Error('The following item could not be found in the items graph:\n          '+JSON.stringify(a))},deactivate:function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'METHOD';if(!this.multiActivate&&(!a||this.active===a))return this._deactivateAsset(this.active),this.active;if(this.multiActivate&&!a)return this.deactivate([].concat(babelHelpers.toConsumableArray(this.active))),this.active;if(this.multiActivate&&Array.isArray(a)&&this.active.length){for(var c=0;c<a.length;c++)this.deactivate(a[c],b);return this.active}return this.multiActivate&&a&&-1<this.active.indexOf(a)?(this._deactivateAsset(a),this.active):void 0},_getActiveMeta:function(a){var b=this;if(a.base&&!Array.isArray(a.base)&&this._assetGraph&&this._assetGraph.hasNode(a.base)){var c=this._assetGraph.getInfo(a.base,this.keys.id),d=c.path,e=c.route,f=c.parent,g=c.children,h=c.siblings;return{item:a.base,path:d,route:e,parent:f,children:g,siblings:h}}return a.base&&Array.isArray(a.base)&&a.base.length?a.base.map(function(a){var c=b._assetGraph.getInfo(a,b.keys.id),d=c.path,e=c.route,f=c.parent,g=c.children,h=c.siblings;return{item:a,path:d,route:e,parent:f,children:g,siblings:h}}):{item:null,path:null,route:null,parent:null,children:null,siblings:null}},_assetActivatedByEvent:function(a){a.stopPropagation(),a.detail.item&&this.activate(a.detail.item,'DOM_EVENT')},_assetDeactivatedByEvent:function(a){a.stopPropagation(),a.detail.item&&this.deactivate(a.detail.item,'DOM_EVENT')},_activeRouteChanged:function(a){var b=this;if(a&&a.path&&this._assetGraph&&!this._squashActiveRouteChange){if(!this.multiActivate&&'activeRoute'===a.path){if(this.active&&(null===a.base||Array.isArray(a.base)&&!a.base.length))return this._squashActiveChange=!0,this.deactivate(this.active,'ROUTE_CHANGED'),void(this._squashActiveChange=!1);var c=this._assetGraph.getNodeAtRoute(a.base,this.keys.id);if(c===this.active)return;if(c)this.activate(c,'ROUTE_CHANGED');else throw new Error('The route '+JSON.stringify(a.base)+' could not be found in the items graph.')}if(this.multiActivate&&('activeRoute'===a.path||'activeRoute.splices'==a.path)){if(this.active.length&&(null===a.base||Array.isArray(a.base)&&!a.base.length))return this._squashActiveChange=!0,this.deactivate(null,'ROUTE_CHANGED'),void(this._squashActiveChange=!1);if(Array.isArray(a.base))for(var d=0;d<a.base.length;d++)this._squashActiveChange=!0,this.active=a.base.map(function(a){var c=b._assetGraph.getNodeAtRoute(a,b.keys.id);if(!c)throw new Error('The following item could not be found in the items graph:\n                    '+JSON.stringify(c));return c}),this._squashActiveChange=!1}}},_activeChanged:function(a){a&&a.path&&!this._squashActiveChange&&(!this.multiActivate&&'active'===a.path&&this._updateActiveRoute(a.base),this.multiActivate&&('active'===a.path||'active.splices'===a.path)&&this._updateActiveRouteMulti(a.base))},_updateActiveRoute:function(a){if(a){if(!this._assetGraph.hasNode(a)){throw new Error('The following item could not be found in the items graph:\n              '+JSON.stringify(a))}var b=this._assetGraph.getRoute(a,this.keys.id);this._routeIsDifferent(b,this.activeRoute)&&(this._squashActiveRouteChange=!0,this.activeRoute=b,this._squashActiveRouteChange=!1)}else this._squashActiveRouteChange=!0,this.activeRoute=null,this._squashActiveRouteChange=!1},_updateActiveRouteMulti:function(a){var b=this;a&&Array.isArray(a)&&a.length?(this._squashActiveRouteChange=!0,this.activeRoute=a.map(function(a){if(!b._assetGraph.hasNode(a))throw new Error('The following item could not be found in the items graph:\n                '+JSON.stringify(a));return b._assetGraph.getRoute(a,b.keys.id)}),this._squashActiveRouteChange=!1):(this._squashActiveRouteChange=!0,this.activeRoute=[],this._squashActiveRouteChange=!1)},_activateAsset:function(a,b){var c=this._assetGraph.getInfo(a,this.keys.id),d=c.route,e=c.path;this._lastActivation={item:a,source:b,route:d},this.multiActivate||(this.active=a),this.multiActivate&&this.push('active',a),this.fire('px-app-asset-activated',{source:b,item:a,route:d,path:e})},_deactivateAsset:function(a,b){var c=this._assetGraph.getInfo(a,this.keys.id),d=c.route,e=c.path;this._lastActivation={item:null,source:null,route:null},this.multiActivate||(this.set('active',null),this.fire('px-app-asset-deactivated',{source:b,item:a,route:d,path:e})),this.multiActivate&&(this.splice('active',this.active.indexOf(a),1),this.fire('px-app-asset-deactivated',{source:b,item:a,route:d,path:e}))}}})();</script></head><body></body></html>