(function(){'use strict';var a=window.PxAppBehavior=window.PxAppBehavior||{},b={properties:{items:{type:Array},keys:{type:Object,value:function(){return{id:'id',label:'label',children:'children',icon:'icon'}}},_assetGraph:{type:Object,value:null},__rootItems:{type:Array}},observers:['__handleAssetReferenceChanged(items, keys)','__handleKeyUpdated(keys.*)'],created:function(){this._createAssetGraph=d.assetGraph.bind(this)},__handleAssetReferenceChanged:function(a,b){if('object'===('undefined'===typeof a?'undefined':babelHelpers.typeof(a))&&Array.isArray(a))return null!==this._assetGraph&&('function'===typeof this.activate&&this.activate(null),'function'===typeof this.select&&this.select(null),'function'===typeof this.favorite&&this.favorite(null)),this._assetGraph=this._createAssetGraph(),this._assetGraph.addChildren(null,a,{recursive:!0,childrenKey:b.children}),this.__rootItems=a.slice(0),this.fire('px-app-asset-graph-created',{graph:this._assetGraph}),this._assetGraph},__handleKeyUpdated:function(a){this._assetGraph&&('keys.children'===a.path&&this.__handleAssetReferenceChanged(this.items,this.keys),'keys.id'===a.path&&('function'===typeof this.activate&&this.activate(null),'function'===typeof this.select&&this.select(null),'function'===typeof this.favorite&&this.favorite(null)))},addChildren:function(a,b,c){if(null!==this._assetGraph){if(this._assetGraph.addChildren(a,b,Object.assign({},{recursive:!0,childrenKey:this.keys.children},c||{})),null===a){var d=Array.isArray(b)?b:[b];this.__rootItems=this.__rootItems.concat(d)}this.fire('px-app-asset-children-updated',null===a?{item:null,added:b,children:this.__rootItems}:Object.assign({},this._assetGraph.getInfo(a),{added:b}))}},removeChildren:function(a,b,c){if(null!==this._assetGraph){var d=Array.isArray(b)?b:[b];if('function'===typeof this.activate||'function'===typeof this.select)for(var e,f=void 0,g=0;g<d.length;g++)!f&&'function'===typeof this.activate&&this.activeMeta&&(this.activeMeta.item===d[g]||this.activeMeta.path&&-1<this.activeMeta.path.indexOf(d[g]))&&(this.activate(null),f=!0),!e&&'function'===typeof this.select&&this.selectedMeta&&(this.selectedMeta.item===d[g]||this.selectedMeta.path&&-1<this.selectedMeta.path.indexOf(d[g]))&&(this.select(null),f=!0);this._assetGraph.removeChildren(a,b,c),null===a&&(this.__rootItems=this.__rootItems.filter(function(a){return-1===d.indexOf(a)})),this.fire('px-app-asset-children-updated',null===a?{item:null,removed:b,children:this.__rootItems}:Object.assign({},this._assetGraph.getInfo(a),{removed:b}))}}};a.AssetGraph=b;var c=function(){function a(){babelHelpers.classCallCheck(this,a),this._options={},this._defaultKeys={id:'id',children:'children'},this._tree=new SymbolTree,this._rootNode={ROOT:!0},this._symbol=Symbol('AssetGraph data')}return babelHelpers.createClass(a,[{key:'_node',value:function(a){var b=a[this._symbol];return b?b:a[this._symbol]={isExhausted:null,isTerminal:null,isSelectable:null}}},{key:'_getKey',value:function(a,b){return b&&'string'===typeof b&&b.length?b:this._defaultKeys[a]}},{key:'hasNode',value:function(a){return!!(-1<this._tree.index(a))}},{key:'getInfo',value:function(b,c){if(-1<this._tree.index(b)){var d=this._getKey('id',c),e=this.getPath(b),f=e?a.pathToRoute(e,d):null,g=this.getParent(b),h=this.getSiblings(b),i=this.getChildren(b),j='object'===('undefined'===typeof i?'undefined':babelHelpers.typeof(i))&&Array.isArray(i)&&0<i.length,k=this.isTerminal(b),l=this.isExhausted(b),m=this.isSelectable(b);return{item:b,path:e,route:f,parent:g,siblings:h,children:i,hasChildren:j,isTerminal:k,isExhausted:l,isSelectable:m}}return null}},{key:'getParent',value:function(a){if(a&&-1<this._tree.index(a)){var b=this._tree.parent(a);return b===this._rootNode?null:b}return null}},{key:'hasSiblings',value:function(a){var b=this.getSiblings(a);return b&&1<b.length}},{key:'getSiblings',value:function(a){return a&&-1<this._tree.index(a)?this._tree.childrenToArray(this._tree.parent(a)):null}},{key:'getPath',value:function(a){return a&&-1<this._tree.index(a)?this._tree.ancestorsToArray(a).reverse().slice(1):null}},{key:'getRoute',value:function(b,c){if(b&&-1<this._tree.index(b)){var d='string'===typeof c&&c.length?c:this._defaultKeys.id,e=this.getPath(b);return e?a.pathToRoute(e,d):null}return null}},{key:'getNodeAtRoute',value:function(a,b){if('object'!==('undefined'===typeof a?'undefined':babelHelpers.typeof(a))||!Array.isArray(a)||!a.length)throw new Error('An array of route strings is required.');for(var c,d='string'===typeof b&&b.length?b:this._defaultKeys.id,e=a.slice(0),f=this._tree.childrenToArray(this._rootNode).slice(0),g=null;!g&&0<f.length&&0<e.length;){if(c=f.shift(),c[d]===e[0]&&0<this._tree.childrenCount(c)&&1!==e.length){e.shift(),f=this._tree.childrenToArray(c).slice(0);continue}if(c[d]===e[0]&&1===e.length){g=c;break}}return g}},{key:'getChildren',value:function(a){var b=null===a?this._rootNode:a;return b&&(b.ROOT||-1<this._tree.index(b))?this._tree.childrenToArray(b):null}},{key:'getRootChildren',value:function(){var a=this._rootNode;return a?this._tree.childrenToArray(a):null}},{key:'hasChildren',value:function(a){var b=null===a?this._rootNode:a;return b&&(b.ROOT||-1<this._tree.index(b))?0<this._tree.childrenCount(b):null}},{key:'addChildren',value:function(a,b,c){if('object'!==('undefined'===typeof b?'undefined':babelHelpers.typeof(b))||Array.isArray(b)&&!b.length)throw new Error('A child object or array of child objects is required.');if(null!==a&&'object'===('undefined'===typeof a?'undefined':babelHelpers.typeof(a))&&!this.hasNode(a))throw new Error('The parent node must be a node in the graph or null.');for(var d,e=null===a?this._rootNode:a,f=Array.isArray(b)?b:[b],g='object'===('undefined'===typeof c?'undefined':babelHelpers.typeof(c))&&'string'===typeof c.childrenKey&&c.childrenKey.length?c.childrenKey:this._defaultKeys.children,h='object'===('undefined'===typeof c?'undefined':babelHelpers.typeof(c))&&'boolean'===typeof c.recursive&&c.recursive,j=0;j<f.length;j++)d=this._node(f[j]),d.isTerminal=f[j].hasOwnProperty('isTerminal')?f[j].isTerminal:null,d.isExhausted=f[j].hasOwnProperty('isExhausted')?f[j].isExhausted:null,d.isSelectable=f[j].hasOwnProperty('isSelectable')?f[j].isSelectable:null,this._tree.appendChild(e,f[j]),h&&'object'===babelHelpers.typeof(f[j][g])&&Array.isArray(f[j][g])&&f[j][g].length&&this.addChildren(f[j],f[j][g],{recursive:!0,childrenKey:g});if('object'===('undefined'===typeof c?'undefined':babelHelpers.typeof(c))&&'boolean'===typeof c.isExhausted){var i=c.isExhausted,k=this._node(e);k.isExhausted=i}if('object'===('undefined'===typeof c?'undefined':babelHelpers.typeof(c))&&'boolean'===typeof c.isSelectable){var l=c.isSelectable,m=this._node(e);m.isSelectable=l}return this.getChildren(e)}},{key:'removeChildren',value:function(a,b){if('object'!==('undefined'===typeof b?'undefined':babelHelpers.typeof(b))||Array.isArray(b)&&!b.length)throw new Error('A child object or array of child objects is required.');if(null!==a&&'object'===('undefined'===typeof a?'undefined':babelHelpers.typeof(a))&&!this.hasNode(a))throw new Error('The parent node must be a node in the graph or null.');for(var c=null===a?this._rootNode:a,d=Array.isArray(b)?b:[b],e=0;e<d.length;e++){if(!this.hasNode(d[e]))throw new Error('Child node(s) cannot be removed from the graph if it they were never added');if(null!==a&&this.getParent(d[e])!==c||null==a&&null!==this.getParent(d[e]))throw new Error('Child node(s) passed to "removeChildren" method must be children of the given parent');this._tree.remove(d[e])}}},{key:'isExhausted',value:function(a){var b=null===a?this._rootNode:a;if(b&&(b.ROOT||-1<this._tree.index(b))){var c=this._node(b);return c&&!0===c.isExhausted}return null}},{key:'setExhausted',value:function(a,b){var c=null===a?this._rootNode:a;if(c&&(c.ROOT||-1<this._tree.index(c))){var d=this._node(c);return d.isExhausted=b,b}return null}},{key:'isTerminal',value:function(a){if(null===a)return!1;if(-1<this._tree.index(a)){var b=this._node(a);return b&&!0===b.isTerminal}return null}},{key:'setTerminal',value:function(a,b){if(null===a)throw new Error('The root node can never be terminal, it must have children.');if(-1<this._tree.index(a)){var c=this._node(a);return c.isTerminal=b,b}return null}},{key:'isSelectable',value:function(a){var b=null===a?this._rootNode:a;if(b&&(b.ROOT||-1<this._tree.index(b))){var c=this._node(b);return c&&!1===c.isSelectable?!1:!0}return null}},{key:'setSelectable',value:function(a,b){var c=null===a?this._rootNode:a;if(c&&(c.ROOT||-1<this._tree.index(c))){var d=this._node(c);return d.isSelectable=b,b}return null}}],[{key:'pathToRoute',value:function(a,b){return a.map(function(a){return'string'===typeof a[b]&&a[b].length?a[b]:null})}}]),a}();var d=window.PxApp=window.PxApp||{};d.AssetGraph=c,d.assetGraph=function(a){return new c(a)}})();