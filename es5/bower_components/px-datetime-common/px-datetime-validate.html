<html><head><link rel="import" href="../app-localize-behavior/app-localize-behavior.html"><script>(function(){var a=window.PxDatetimeBehavior=window.PxDatetimeBehavior||{};a.Validate=[Polymer.AppLocalizeBehavior,{properties:{isValid:{type:Boolean,value:!0,notify:!0},validationErrorMessage:{type:String,value:'invalid'},language:{type:String,value:'en'},useKeyIfMissing:{type:Boolean,value:!0},resources:{type:Object,value:function(){return{en:{"Future dates are not allowed":'Future dates are not allowed',"Past dates are not allowed":'Past dates are not allowed',Year:'Year',Month:'Month',Day:'Day',Hour:'Hour',Minute:'Minute',Second:'Second',Millisecond:'Millisecond',"is not valid":'is not valid',"This hour is not within a 12 hour clock":'This hour is not within a 12 hour clock'}}}}},observers:['_updateValidationEvent(validationErrorMessage)'],_validateInput:function(a,b){var c=Polymer.dom(this.root).querySelectorAll('.cell'),d=this._entryInputString(c);if(d){var e=Px.moment.tz(d,a,b);e.isValid()?(this.set('isValid',!0),this.toggleClass('validation-error',!1,this.$.wrapper),this.fire('px-moment-valid',{element:this})):(this.set('validationErrorMessage',this._determineValidationMessage(e,{})),this.set('isValid',!1),this.toggleClass('validation-error',!0,this.$.wrapper),this.fire('px-moment-invalid',{element:this}))}},_validateField:function(a){var b={},c=Polymer.dom(this.root).querySelector('#date'),d=Polymer.dom(this.root).querySelector('#time');null!==c&&(b.dateCells=Polymer.dom(c.root).querySelectorAll('.cell')),null!==d&&(b.timeCells=Polymer.dom(d.root).querySelectorAll('.cell'));var e=null===c?'':this._entryInputString(b.dateCells),f=null===d?'':this._entryInputString(b.timeCells);if(this.hideDate&&!f||this.hideTime&&!e||!this.hideDate&&!this.hideTime&&(!e||!f)){var g=this.hideDate?d:c;return this._handleIncompleteEntries(a,g,b)}var h=e.trim()+' '+f.trim();h=h.split('\xA0').join(' ');var j=this.hideDate?'':this.dateFormat,k=this.hideTime?'':this.timeFormat,l=j+' '+k,m=Px.moment.tz(h,l,this.timeZone);return this.momentObj&&(!/Y/.test(l)&&m.year(this.momentObj.year()),!/M/.test(l)&&m.month(this.momentObj.month()),!/D/.test(l)&&m.date(this.momentObj.date()),!/[Hhk]/.test(l)&&m.hour(this.momentObj.hour()),!/m/.test(l)&&m.minute(this.momentObj.minute()),!/s/.test(l)&&m.second(this.momentObj.second()),!/S/.test(l)&&m.millisecond(this.momentObj.millisecond())),this._validateMomentObj(m)},_validateMomentObj:function(a){if(null===a)return void this._validField(a);var b={};if(b.futureSelection=this.blockFutureDates&&a.isAfter(Px.moment.tz(Px.moment(),this.timeZone)),b.pastSelection=this.blockPastDates&&a.isBefore(Px.moment.tz(Px.moment(),this.timeZone)),b.pastMaxSelection=this.maxDate&&a.isAfter(this.maxDate),b.beforeMinSelection=this.minDate&&a.isBefore(this.minDate),a.isValid()&&!b.futureSelection&&!b.pastSelection&&!b.pastMaxSelection&&!b.beforeMinSelection){if(this._validField(a),!this.momentObj||!this.momentObj.isSame(a))return a;if(this.momentObj.isSame(a))return'FieldSame'}else return this._invalidField(a,b),!1},_validField:function(){if(!this.hideDate){var a=Polymer.dom(this.root).querySelector('#date');null!==a&&a.toggleClass('validation-error',!1,a.$.wrapper)}if(!this.hideTime){var b=Polymer.dom(this.root).querySelector('#time');null!==b&&b.toggleClass('validation-error',!1,b.$.wrapper)}this.set('fieldIsValid',!0),this.fire('px-moment-valid',{element:this})},_invalidField:function(a,b){this.set('validationErrorMessage',this._determineValidationMessage(a,b)),this.set('fieldIsValid',!1),this.toggleClass('validation-error',!0,this.$.fieldWrapper),this.fire('px-moment-invalid',{element:this})},_entryInputString:function(a){for(var b,c='',d=0;d<a.length;d++){if(b=Polymer.dom(a[d].root).querySelector('#dtEntry').value,''===b)return'';'Z'!==a[d].momentFormat&&(c=c+b+a[d].symbol)}return c},_determineValidationMessage:function(a,b){if(!a)return this.localize('Incomplete');if(b.futureSelection)return this.localize('Future dates are not allowed');if(b.pastSelection)return this.localize('Past dates are not allowed');if(b.pastMaxSelection)return this.localize('Date is past max date');if(b.beforeMinSelection)return this.localize('Date is before min date');var c=a.invalidAt();if(-1!==c)switch(c){case 0:return this.localize('Year')+' '+a._a[c]+' '+this.localize('is not valid');break;case 1:return this.localize('Month')+' '+(a._a[c]+1)+' '+this.localize('is not valid');break;case 2:return this.localize('Day')+' '+a._a[c]+' '+this.localize('is not valid');break;case 3:return this.localize('Hour')+' '+a._a[c]+' '+this.localize('is not valid');break;case 4:return this.localize('Minute')+' '+a._a[c]+' '+this.localize('is not valid');break;case 5:return this.localize('Second')+' '+a._a[c]+' '+this.localize('is not valid');break;case 6:return this.localize('Millisecond')+' '+a._a[c]+' '+this.localize('is not valid');}else if(!0===a.parsingFlags().bigHour)return this.localize('This hour is not within a 12 hour clock')},_updateValidationEvent:function(a){a!==void 0&&this.fire('px-validation-message',{validationErrorMessage:this.validationErrorMessage})},_submitButtonState:function(a){this.set('isSubmitButtonValid',a)},_handleIncompleteEntries:function(a,b,c){if('_momentChanged'===a)return!1;if(!this.required){var d=!!this.hideDate||this._loopOverCellValues(c.dateCells),e=!!this.hideTime||this._loopOverCellValues(c.timeCells);if(d&&e)return b.toggleClass('validation-error',!1,b.$.fieldWrapper),b.set('isValid',!0),'FieldBlank';this._invalidField('',{})}else return this._invalidField('',{}),!1},_loopOverCellValues:function(a){var b=!0;if(a&&a.length)for(i=0;i<a.length;i++){var c=Polymer.dom(a[i].root).querySelectorAll('#dtEntry');if(''!==c[0].value){b=!1;break}}return b}}]})();</script></head><body></body></html>