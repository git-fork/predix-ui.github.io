<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="px-vis-behavior-d3.html"><link rel="import" href="css/px-vis-styles.html"></head><body><dom-module id="px-vis-striping"><template><style include="px-vis-styles"></style></template></dom-module><script>Polymer({is:'px-vis-striping',behaviors:[PxVisBehavior.observerCheck,PxVisBehaviorD3.canvasContext,PxVisBehaviorD3.axes,PxVisBehavior.commonMethods,PxVisBehaviorD3.domainUpdate,PxVisBehavior.dynamicConfigProperties,PxVisBehavior.serieToRedrawOnTop,PxVisBehavior.stripProperties,PxVisBehaviorD3.clipPathBoolean],properties:{drawDebounceTime:{type:Number,value:10}},observers:['_requestCanvasCreation(stripeConfig)','_redraw(canvasContext, domainChanged, stripeData.*, stripeConfig.*)','_drawOnTop(serieToRedrawOnTop)'],attached:function(){this._isDirty&&(this._redraw(),this._isDirty=!1)},detached:function(){this._isDirty=!0},_redraw:function(){this.hasUndefinedArguments(arguments)||!this.preventInitialDrawing&&this.drawCanvas(!0)},drawCanvas:function(a){0<this.drawDebounceTime?this.debounce('drawCanvasStriping',function(){this._drawCanvasDebounced(a)}.bind(this),this.drawDebounceTime):this._drawCanvasDebounced(a)},_drawCanvasDebounced:function(){!this.x||'undefined'===typeof this.domainChanged||null===this.domainChanged||this._isObjEmpty(this.stripeData)||(this.canvasContext.pxClearCanvas(),this._initiateRendering())},_initiateRendering:function(){var a,b=Object.keys(this.stripeConfig);this.clipPath&&this.drawClipPath();for(var c=0;c<b.length;c++)this.canvasContext.fillStyle=this.stripeConfig[b[c]].fillColor,this.canvasContext.strokeStyle=this.stripeConfig[b[c]].fillColor,a=this.stripeConfig[b[c]].dash?this.stripeConfig[b[c]].dash:[5,2],this.canvasContext.setLineDash(a),this.canvasContext.globalAlpha=this.stripeConfig[b[c]].fillOpacity,this.stripeData[b[c]]&&this.stripeData[b[c]].length&&this._renderStripes(this.stripeData[b[c]])},_renderStripes:function(a){for(var b,c,d=0;d<a.length;d++)b=this.x(a[d][0]),c=a[d][1]||0===a[d][1]?this.x(a[d][1])-b:0,0===c?(this.canvasContext.beginPath(),this.canvasContext.moveTo(b,0),this.canvasContext.lineTo(b,this.height),this.canvasContext.stroke()):this.canvasContext.fillRect(b,0,c,this.height)},drawClipPath:function(){var a=Math.max;this.canvasContext.beginPath();var b=a(this.width-this.margin.left-this.margin.right,0),c=a(this.height-this.margin.top-this.margin.bottom,0);this.canvasContext.rect(0,0,b,c),this.canvasContext.clip()},_drawOnTop:function(a){this.hasUndefinedArguments(arguments)||a===this.seriesId&&this.drawCanvas(!1)},_requestCanvasCreation:function(){this.hasUndefinedArguments(arguments)||this.set('canvasLayersConfig.striping',{})}});</script></body></html>