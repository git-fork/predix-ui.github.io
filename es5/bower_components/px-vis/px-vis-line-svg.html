<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="px-vis-behavior-d3.html"><link rel="import" href="px-vis-behavior-common.html"><link rel="import" href="css/px-vis-styles.html"></head><body><dom-module id="px-vis-line-svg"><template><style include="px-vis-styles"></style></template></dom-module><script>Polymer({is:'px-vis-line-svg',behaviors:[PxVisBehavior.observerCheck,PxVisBehaviorD3.svg,PxVisBehaviorD3.lineShared,PxVisBehaviorD3.axes,PxVisBehavior.dataset,PxVisBehavior.mutedSeries,PxVisBehavior.commonMethods,PxVisBehaviorD3.clipPath,PxVisBehavior.completeSeriesConfig,PxVisBehavior.categories,PxVisBehaviorD3.selectedDomain,PxVisBehavior.polarData,PxVisBehavior.dynamicConfigProperties,PxVisBehavior.serieToRedrawOnTop,PxVisBehaviorD3.serieToRedrawOnTopSVG,PxVisBehaviorD3.domainUpdate,PxVisBehavior.preventInitialDrawing,PxVisBehavior.isAttached],properties:{linePath:{type:Object},lineBuilder:{type:Object},lineGroup:{type:Object},strokeWidth:{type:Number,value:1},mutedOpacity:{type:Number},drawDebounceTime:{type:Number,value:10},disablePointerEvents:{type:Boolean,value:!1}},observers:['drawElement(svg, y, domainChanged, chartData.*, completeSeriesConfig.*, counterClockwise, preventInitialDrawing)','isIdInMuted(mutedSeries.*, completeSeriesConfig)','_addClipPath(clipPath)','_drawOnTop(serieToRedrawOnTop)','_disablePointerEvents(disablePointerEvents)'],ready:function(){this._watchConfigProperty('mutedOpacity',0.3)},attached:function(){this._isDirty&&this.drawElement(),this._isDirty=!1},detached:function(){this._isDirty=!0,this.linePath=null,this._doesD3HaveValues(this.lineGroup)&&(this.lineGroup.remove(),this.lineGroup=null)},drawElement:function(){this.hasUndefinedArguments(arguments)||!this.preventInitialDrawing&&(0<this.drawDebounceTime?this.debounce('draw',function(){this._drawElementDebounced()}.bind(this),this.drawDebounceTime):this._drawElementDebounced())},_drawElementDebounced:function(){if(null!==this.domainChanged&&this._doesD3HaveValues(this.svg)&&this.y&&this._doesObjHaveValues(this.completeSeriesConfig)&&this._isAttached&&this.chartData){if(this._resetRenderingContext(),this.parallelCoordinates){var a=this.chartData;this._defineMultiLine(!1)}else if(this.radialLine)this._defineRadialLine(!1,this.multiPath,this.counterClockwise,this.useDegrees),a=this.multiPath?this.chartData:[this.chartData];else{var a=[this.chartData];this._defineSingleLine(!1)}this._isObjEmpty(this.lineGroup)?(this.lineGroup=this.svg.append('g').attr('series-id','line_'+this.seriesId).attr('class','series-line'),this.disablePointerEvents&&this.lineGroup.style('pointer-events','none')):this.lineGroup.attr('series-id','line_'+this.seriesId);var b=this.lineGroup.selectAll('path.series-line').data(a);b.exit().remove(),b.enter().append('path').attr('class','series-line').attr('fill','none').merge(b).attr('d',function(a){return this.line(a)}.bind(this)).attr('series-id',function(a){return this.multiPath?'line_'+a[this.seriesId]:'line_'+this.seriesId}.bind(this)).attr('stroke-width',this.strokeWidth).attr('stroke',function(a){return this.categoryKey?this.completeSeriesConfig[a[this.categoryKey]]?this.completeSeriesConfig[a[this.categoryKey]].color:void 0:this.completeSeriesConfig[this.seriesId].color}.bind(this)).attr('stroke-opacity',this._svgLineOpacity.bind(this)).attr('stroke-dasharray',this.completeSeriesConfig[this.seriesId].dashPattern),this.linePath=this.lineGroup.selectAll('path.series-line'),this._addClipPath(),this.isIdInMuted(),this.fire('px-vis-line-svg-rendering-ended')}},_addClipPath:function(){this.hasUndefinedArguments(arguments)||this.addClipPath(this.lineGroup)},isIdInMuted:function(){this.hasUndefinedArguments(arguments)||(this.multiPath&&this._doesObjHaveValues(this.linePath)?(this.linePath.style('display',function(a){return this.mutedSeries[a[this.seriesId]]?'none':null}.bind(this)),this._colorLine()):this.mutedSeries.hasOwnProperty(this.seriesId)&&this._colorLine())},_colorLine:function(){this.linePath&&this.linePath.attr('stroke',function(a){return this.categoryKey?this.completeSeriesConfig[a[this.categoryKey]]?this.completeSeriesConfig[a[this.categoryKey]].color:void 0:this.completeSeriesConfig[this.seriesId].color}.bind(this)).attr('stroke-opacity',this._svgLineOpacity.bind(this))},_svgLineOpacity:function(a){return this.mutedSeries[this.seriesId]?this.mutedOpacity:this.gradientLine?this._opacityLine(a):1},_drawOnTop:function(a){this.hasUndefinedArguments(arguments)||this.lineGroup&&this.seriesId&&this._drawSVGOnTop(a,this.seriesId,this.lineGroup)},_disablePointerEvents:function(){this.hasUndefinedArguments(arguments)||this._doesD3HaveValues(this.lineGroup)&&this.lineGroup.style('pointer-events','none')}});</script></body></html>