<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="css/px-vis-spark-styles.html"><link rel="import" href="../px-vis/px-vis-line-svg.html"><link rel="import" href="../px-vis/px-vis-scale.html"><link rel="import" href="../px-vis/px-vis-svg.html"><link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="import" href="../px-simple-win-loss-chart/px-simple-win-loss-chart.html"><link rel="import" href="../px-vis/px-vis-behavior-common.html"><link rel="import" href="../px-vis/px-vis-behavior-d3.html"><link rel="import" href="../px-vis/px-vis-area-svg.html"></head><body><dom-module id="px-vis-spark"><template><style include="px-vis-spark-styles"></style><template is="dom-if" if="{{data}}"><div id="wrapper" class="wrapper flex"><template is="dom-if" if="{{_isEqual(type,'line')}}"><px-vis-svg width="[[width]]" height="[[height]]" svg="{{svg}}"></px-vis-svg><px-vis-scale x-axis-type="time" y-axis-type="linear" complete-series-config="[[_seriesConfig]]" data-extents="[[_extents]]" width="[[width]]" height="[[height]]" chart-data="[[data]]" x="{{x}}" y="{{y}}" domain-changed="{{domainChanged}}"></px-vis-scale><px-vis-line-svg svg="[[svg]]" series-id="spark" chart-data="[[data]]" complete-series-config="[[_seriesConfig]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]"></px-vis-line-svg><template is="dom-if" if="{{!disableGradient}}" restamp=""><px-vis-area-svg svg="[[svg]]" series-id="spark" complete-series-config="[[_areaConfig]]" chart-data="[[_stackData]]" x="[[x]]" y="[[y]]" domain-changed="[[domainChanged]]"></px-vis-area-svg></template></template><template is="dom-if" if="{{_isEqual(type,'bar')}}"><px-simple-win-loss-chart class="simpleBar" chart-data="{{data}}" width="{{width}}" height="{{height}}"></px-simple-win-loss-chart></template><template is="dom-if" if="{{_isEqual(type,'winLoss')}}"><px-simple-win-loss-chart class="simpleWinLoss" chart-data="{{data}}" width="{{width}}" height="{{height}}"></px-simple-win-loss-chart></template></div></template></template></dom-module><script>Polymer({is:'px-vis-spark',behaviors:[Polymer.IronResizableBehavior,PxColorsBehavior.dataVisColorTheming,PxColorsBehavior.getSeriesColors,PxVisBehaviorD3.domainUpdateNotify,PxVisBehavior.updateStylesOverride,PxVisBehavior.commonMethods],properties:{type:{type:String,value:'line'},data:{type:Array,value:function(){return[]},observer:'_dataChanged'},_stackData:{type:Object,computed:'_computeStack(data.*, type)'},preventResize:{type:Boolean,value:!1},width:{type:String,value:'300'},height:{type:String,value:'50'},_seriesConfig:{type:Object},_extents:{type:Object,value:function(){return{x:[Infinity,-Infinity],y:[Infinity,-Infinity]}}},_gradient:{type:Object},_gradientStop1:{type:Object},_gradientStop2:{type:Object},_gradientStop3:{type:Object},disableGradient:{type:Boolean,value:!1}},listeners:{"iron-resize":'_onIronResize',"px-data-vis-colors-applied":'_generateSeriesConfig'},observers:['createGradient(svg, _areaConfig)','_adjustGradients(domainChanged)'],_onIronResize:function(){this.preventResize||void 0===this.preventResize||this.debounce('ironresize',function(){var a=Math.max,b=this.$$('#wrapper').getBoundingClientRect();this.set('width',a(b.width,0)),this.set('height',a(b.height,0))},50)},_isEqual:function(c,a){return c===a},_dataChanged:function(){this.set('_extents',{x:[Infinity,-Infinity],y:[Infinity,-Infinity]})},_generateSeriesConfig:function(){this.set('_seriesConfig',{spark:{name:'spark',x:'x',y:'y',color:this._getColor(0)}}),this.set('_areaConfig',{spark:{name:'spark',x:'x',y:'y',color:'url(#sparkGradient)'}})},_computeStack:function(){if(this.data&&0!==this.data.length){if('line'!==this.type)return[];var a=Px.d3.stack();return a.keys(['y']),a(this.data)}},createGradient:function(){this._isD3Empty(this.svg)||(!this._gradient&&(this._gradient=this.svg.append('defs').append('linearGradient').attr('id','sparkGradient').attr('x1',0).attr('x2',0).attr('y1',0).attr('y2',1),this._gradientStop1=this._gradient.append('stop').attr('offset','0%').attr('stop-opacity','0.15'),this._gradientStop2=this._gradient.append('stop').attr('stop-opacity','0.05'),this._gradientStop3=this._gradient.append('stop').attr('stop-opacity','0.15'),this._adjustGradients()),this._gradientStop1.attr('stop-color',this._getColor(0)),this._gradientStop2.attr('stop-color',this._getColor(0)),this._gradientStop3.attr('stop-color',this._getColor(0)))},_adjustGradients:function(){if(this.data&&this._gradientStop3){for(var a=!1,b=0;b<this.data.length;b++)0>this.data[b].y&&(a=!0);if(a){var c=this.y(0),d=this.y.range(),e=100*(c/(d[0]-d[1]));this._gradientStop2.attr('offset',e+'%'),this._gradientStop3.attr('offset','100%')}else this._gradientStop2.attr('offset','70%'),this._gradientStop3.attr('offset','0%')}}});</script></body></html>