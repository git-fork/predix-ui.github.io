<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../px-tooltip/px-tooltip.html"><link rel="import" href="../px-icon-set/px-icon-set.html"><link rel="import" href="../px-icon-set/px-icon.html"><link rel="import" href="px-edit-cell.html"><link rel="import" href="../px-dropdown/px-dropdown.html"><link rel="import" href="css/px-data-table-cell-styles.html"></head><body><dom-module id="px-data-table-cell"><template><style include="px-data-table-cell-styles"></style><span class$="{{_getReaderClass(_editing)}}" on-mouseover="onCellHovered" on-mouseout="onCellUnHovered"><px-edit-cell id="celledit" class$="{{_getEditCellClass(_editing)}}"><template is="dom-if" if="{{_isEqual(cellType, 'string')}}"><input id="celleditinput" type="text" placeholder="{{placeholder}}" class="u-p0 text-input" required$="{{column.required}}" on-input="_cellValueChanged" on-blur="saveCell" value="{{cellValue}}"></template></px-edit-cell><template is="dom-if" if="{{_isEqual(cellType, 'dropdown')}}"><div class="flex__item cell--container"><span role="gridcell"><px-dropdown class="px-dropdown-content" selected="{{cellValue}}" select-by="val" display-value="{{cellDisplayValue}}" on-px-dropdown-selection-changed="saveCell" allow-outside-scroll="true" button-style="bare" items="{{dropdownItems}}" disable-clear=""></px-dropdown></span></div></template><template is="dom-if" if="{{_isEqual(cellType,'string')}}"><div class="flex cell--container"><span role="gridcell" id="cellvalue" class$="{{_getValueCellClass(_editing, cellValidation.passedValidation, cellDisplayValue)}}">{{cellDisplayValue}}<template is="dom-if" if="{{cellDisplayTooltip}}"><px-tooltip orientation="top" smart-orientation="" delay="1000" tooltip-message="{{cellValue}}"></px-tooltip></template></span></div></template><template is="dom-if" if="{{cellEditable}}"><div class="fa fa-fw cell-status--container"><px-icon id="editicon" role="button" aria-label="Click to edit cell" class$="{{_getCellIconClass(_showEditIcon, _editing, cellValidation.passedValidation)}}" icon="{{_getCellIcon(_showEditIcon, _editing, cellValidation.passedValidation)}}"></px-icon><template is="dom-if" if="{{!cellValidation.passedValidation}}"><px-tooltip class="tooltip-font" smart-orientation="" orientation="top" tooltip-message="{{cellValidation.failedValidationErrorMessage}}"></px-tooltip></template></div></template></span><template is="dom-if" if="{{_isEqual(cellType,'html')}}"><aha-html-echo role="gridcell" html="{{cellDisplayValue}}"></aha-html-echo></template></template><script>Polymer({is:'px-data-table-cell',properties:{cellType:{type:String,value:''},cellDisplayValue:{type:String,value:'',observer:'_cellDisplayValueChanged'},cellValue:{type:String,value:''},cellDisplayTooltip:{type:Boolean,value:!1},cellValidation:{type:Object,value:function(){return{passedValidation:!0}},notify:!0},columnName:{type:String,value:''},_editing:{type:Boolean,value:!1,notify:!0,observer:'_editingChanged'},cellEditable:{type:Boolean,value:!1},dropdownItems:{type:Array,value:function(){return[]},notify:!0,observer:'_setDropdownItem'},cellSelected:{type:Boolean,value:!1,observer:'_cellSelected'},cellHighlighted:{type:Object,value:function(){return{value:!1}}},rowHighlighted:{type:Object,value:function(){return{value:!1}}},_showEditIcon:{type:Boolean,value:!1},_editTimeout:{type:Object,value:function(){return{}}},_dropdownItem:{type:Boolean,value:!1},_cellAnchor:{type:HTMLElement,value:function(){return null}}},listeners:{tap:'editCell'},observers:['_updateHighlight(cellHighlighted.value, rowHighlighted.value)'],detached:function(){var a=this.$$('px-tooltip');a&&a.remove()},_cellDisplayValueChanged:function(a){this.$$('.cell--value')!==void 0&&null!==this.$$('.cell--value')&&(a!==void 0&&''!==a?this.$$('.cell--value').classList.remove('empty'):this.$$('.cell--value').classList.add('empty'))},_cellValueChanged:function(){clearTimeout(this._editTimeout),this._editTimeout=setTimeout(function(){this.fire('validate',{newValue:this.$$('#celleditinput').value}),this.fire('px-cell-validate',{newValue:this.$$('#celleditinput').value})}.bind(this),300)},onCellHovered:function(){this.set('_showEditIcon',this.cellEditable)},onCellUnHovered:function(){this.set('_showEditIcon',!1)},_isEqual:function(a,b){return Array.isArray(b)&&this._typeofComparison(b,'object')?void 0:a===b},isNotEqual:function(a,b){return Array.isArray(b)&&this._typeofComparison(b,'object')?void 0:a!==b},_areAnyEqual:function(a,b){if(Array.isArray(b)){for(var c=0,d=b.length;c<d;c++)if(a===b[c])return!0;return!1}return console.log('You must pass an array into this function'),!1},_getReaderClass:function(){var a=this.cellValue,b=[];return b='dropdown'===this.cellType?['flex','ddviewing']:['flex','viewing'],null!==a&&void 0!==a&&(this._typeofComparison(a,'string')||0!==a.trim().length)||b.push('empty'),b.join(' ')},ready:function(){this.addEventListener('exit-edit-mode',this._exitEditMode.bind(this)),this.addEventListener('undo-edit-mode',this._undoEditMode.bind(this)),this.addEventListener('setDropdownItem',this._setDropdownItem),this.toggleClass('td',!0),this.toggleClass('aha-'+this.columnName.replace(/\s/g,'-')+'-td',!0)},attached:function(){this.toggleClass('td__dropdown',this._dropdownItem),this._cellAnchor=this},_setDropdownItem:function(){this.set('_dropdownItem',0<this.dropdownItems.length)},_editingChanged:function(a){a&&this.fire('px-cell-editing')},_exitEditMode:function(){document.activeElement.blur()},_undoEditMode:function(){this.set('_cancelSave',!0),document.activeElement.blur()},editCell:function(){var a=this.$$('.cell--edit'),b=this.$$('.cell--value');this.cellEditable&&'dropdown'!==this.cellType&&'html'!==this.cellType&&(this.set('_editing',!0),this.toggleClass('cell__edit',this._editing),this.set('_undoValue',this.$$('.cell--value').innerText),Polymer.dom(a).querySelector('input,select,textarea').focus())},saveCell:function(a){this._editing=!1,this.toggleClass('cell__edit',this._editing);var b;!0===this._cancelSave?(this.set('_cancelSave',!1),b=this._undoValue,Polymer.dom(this.$$('.cell--edit')).querySelector('input,select,textarea').value=b):this._dropdownItem&&!0===a.detail.selected?b=a.detail.val:b=a.target.value,this.fire('save',{newValue:b}),this.fire('px-cell-save',{newValue:b})},_getEditCellClass:function(a){var b=['cell--edit'];return a||b.push('hidden'),b.join(' ')},_getValueCellClass:function(a,b,c){var d=['cell--value'];return a&&d.push('hidden'),c||d.push('cell--value__empty'),this.toggleClass('cell--value__validation-failed',!b),d.join(' ')},_getCellIcon:function(a,b,c){if(!c)return'px-utl:failure';else if(a)return'px-utl:edit'},_getCellIconClass:function(a,b,c){var d=['cell--status--container--icon'];return c?(b||!a)&&d.push('visuallyhidden'):d.push('cell--value--icon__validation-failed'),d.join(' ')},_cellSelected:function(a){this.rowHighlighted&&this.rowHighlighted.value?this.toggleClass('cell--value__highlight--selected__row',a):this.cellHighlighted&&this.cellHighlighted.value?this.toggleClass('cell--value__highlight--selected',a):this.toggleClass('selected',a)},_updateHighlight:function(a,b){this._clearHighlight(),b&&this.toggleClass(this.rowHighlighted.highlightClass,b),a&&this.toggleClass(this.cellHighlighted.highlightClass,a)},_clearHighlight:function(){this.toggleClass('px-data-table-highlight--high',!1),this.toggleClass('px-data-table-highlight--medium',!1),this.toggleClass('px-data-table-highlight--low',!1)},_typeofComparison:function(a,b){return('undefined'===typeof a?'undefined':babelHelpers.typeof(a))===b||!1}});</script></dom-module><script>Polymer({is:"aha-html-echo",properties:{html:{type:String,value:"",observer:"onHtmlChanged"}},onHtmlChanged:function(){this.html===void 0&&(this.html=""),this.innerHTML=this.html}});</script></body></html>