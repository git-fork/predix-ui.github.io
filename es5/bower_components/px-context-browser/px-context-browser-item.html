<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="import" href="px-context-browser-actions.html"><link rel="import" href="css/px-context-browser-item-styles.html"></head><body><dom-module id="px-context-browser-item"><template><style include="px-context-browser-item-styles"></style><template is="dom-if" if="[[!styleAsFavorite]]"><section class="context-browser-item" asset-action="activate"><div class="context-browser-text"><div class="context-browser-text__label regular">[[label]]</div></div><div class="actions"><template is="dom-if" if="[[canFavorite]]"><px-context-browser-action-favorite class="action" active$="{{favorited}}" asset-action="favorite"></px-context-browser-action-favorite></template><template is="dom-if" if="[[canSelect]]"><px-context-browser-action-select class="action" asset-action="select"></px-context-browser-action-select></template><template is="dom-if" if="[[canOpen]]" restamp=""><px-context-browser-action-open class="action action--open" asset-action="activate"></px-context-browser-action-open></template></div></section></template><template is="dom-if" if="[[styleAsFavorite]]"><section class="context-browser-item" asset-action="select"><div class="context-browser-text"><div class="context-browser-text__label regular">[[label]]</div><div id="breadcrumbs" class="context-browser-text__breadcrumbs context-browser-label--breadcrumbs zeta">[[_truncatedBreadcrumbs]]</div></div><div class="actions"><template is="dom-if" if="[[canFavorite]]"><px-context-browser-action-favorite class="action" active$="{{favorited}}" asset-action="favorite"></px-context-browser-action-favorite></template></div></section></template></template></dom-module><script>Polymer({is:'px-context-browser-item',behaviors:[Polymer.IronResizableBehavior],properties:{label:{type:String},breadcrumbs:{type:Array},_breadcrumbsFontStyles:{type:Object},_breadcrumbsWidth:{type:Number},_truncatedBreadcrumbs:{type:String,computed:'_computeTruncatedBreadcrumbs(breadcrumbs, _breadcrumbsFontStyles, _breadcrumbsWidth)'},selected:{type:Boolean,value:!1,reflectToAttribute:!0},favorited:{type:Boolean,value:!1},styleAsFavorite:{type:Boolean,value:!1,reflectToAttribute:!0},canSelect:{type:Boolean,value:!1},canOpen:{type:Boolean,value:!1},canFavorite:{type:Boolean,value:!1},visible:{type:Boolean,value:!0}},observers:['_handleFavoritesItemVisible(visible, styleAsFavorite)'],listeners:{"iron-resize":'_handleResize'},_handleFavoritesItemVisible:function(a,b){a&&b&&this._updateBreadcrumbsInfo()},_handleResize:function(){this.visible&&this.styleAsFavorite&&this._updateBreadcrumbsInfo()},_updateBreadcrumbsInfo:function(){var a=this;this.debounce('update-breadcrumbs-width',function(){window.requestAnimationFrame(function(){setTimeout(function(){if(!a._breadcrumbsWidth||!a.__breadcrumbsFontStyles){var b=Polymer.dom(a.root).querySelector('#breadcrumbs');if(!b)return;a._breadcrumbsFontStyles=a._getFontStyles(b),a._breadcrumbsWidth=b.getBoundingClientRect().width}})})},5)},_computeTruncatedBreadcrumbs:function(a,b,c){if(a&&b&&c)return this._truncateBreadcrumbs(a,b,c)},_getFontStyles:function(a){var b=window.getComputedStyle(a),c=b.fontSize,d=b.fontFamily;return{size:c,family:d}},_truncateBreadcrumbs:function(a,b,c){if(!a.length)return'';for(var d=this._getTextWidth('\u2026 > ',b),e=this._getTextWidth(' > ',b),f=a.length,g=f;0<g;){var h=a.slice(-1*g),i=h.join(' > ');g<f&&1<f&&(i='... > '+i);var j=this._getTextWidth(i,b);if(c>j)return i;g--}var k=1<f?'... > ':'';return k+a[f-1]},_getTextWidth:function(a,b){var c=this._textMeasureCanvas=this._textMeasureCanvas?this._textMeasureCanvas:document.createElement('canvas'),d=c.getContext('2d');return d.font=b.size+' '+b.family,Math.round(d.measureText(a).width)}});</script></body></html>