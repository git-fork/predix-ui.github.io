(function(){'use strict';Polymer({is:'px-app-nav',behaviors:[Polymer.IronResizableBehavior,PxAppNavBehavior.MeasureText,PxAppBehavior.AssetGraph,PxAppBehavior.AssetSelectable],properties:{collapseAll:{type:Boolean,value:!1,observer:'_handleCollapseAllChanged',notify:!0},collapseAt:{type:Number,observer:'rebuild'},collapseWithIcon:{type:Boolean,value:!1},collapseOpened:{type:Boolean,value:!1,notify:!0},vertical:{type:Boolean,value:!1,reflectToAttribute:!0},verticalOpened:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},visibleItems:{type:Array,notify:!0,readOnly:!0},overflowedItems:{type:Array,notify:!0,readOnly:!0},allCollapsed:{type:Boolean,value:!1,notify:!0,readOnly:!0,computed:'_computeAllCollapsed(overflowedItems,visibleItems)'},anyOverflowed:{type:Boolean,value:!1,notify:!0,readOnly:!0,computed:'_computeAnyOverflowed(overflowedItems,visibleItems)'},someOverflowed:{type:Boolean,value:!1,notify:!0,readOnly:!0,computed:'_computeSomeOverflowed(overflowedItems,visibleItems)'},fitInto:{type:HTMLElement},_availableWidth:{type:Number,observer:'rebuild'}},_statics:{ITEM_PADDING:'1rem',ITEM_ICON_WIDTH:'2rem',ITEM_ICON_PADDING:'0.33rem',OPEN_ICON_WIDTH:'1.33rem',OPEN_ICON_PADDING:'0.2rem'},observers:['_handleItemVisibilityChanged(visibleItems, overflowedItems, visibleItems.*, overflowedItems.*)'],listeners:{"iron-resize":'_handleResize',"px-app-nav-item-tapped":'_itemSelectedByEvent',mouseenter:'_handleMouseEnter',mouseleave:'_handleMouseLeave',"px-app-asset-graph-created":'rebuild',"px-app-nav-rebuilt":'_handleRebuild'},_handleRebuild:function(){if(!this.collapseAll&&!this.vertical&&this.anyOverflowed&&this.collapseOpened){if(!this._collapsedGroup){var a=Polymer.dom(this.root).querySelector('#overflowedGroup');if(!a)return;this._collapsedGroup=a}this._collapsedGroup.refitGroup()}},_handleMouseEnter:function(){this.vertical&&(this._mouseIsOverNav=!0,this.isDebouncerActive('close-nav-on-mouseleave')&&this.cancelDebouncer('close-nav-on-mouseleave'),this._mouseIsOverNav&&!this.verticalOpened&&this._setVerticalOpened(!0))},_handleMouseLeave:function(){this.vertical&&(this._mouseIsOverNav=!1,this.debounce('close-nav-on-mouseleave',function(){!this._mouseIsOverNav&&this.verticalOpened&&this._setVerticalOpened(!1)},250))},_handleItemVisibilityChanged:function(){this.debounce('item-visibility-changed',function(){var a=Polymer.dom(this.root).querySelector('#visible'),b=Polymer.dom(this.root).querySelector('#overflowed');a&&a.render(),b&&b.render()})},_handleCollapseAllChanged:function(a){a&&this.rebuild(),a||(this._availableWidth=null,this._handleResize())},_itemSelectedByEvent:function(a){a.detail.item&&this.select(a.detail.item,'DOM_EVENT')},_handleResize:function(){if(!(this.collapseAll||this.vertical)){var a='measure-available-width';return'number'===typeof this._availableWidth?void(this.isDebouncerActive(a)&&this.cancelDebouncer(a),this.debounce(a,this._measureAvailableWidth.bind(this),100)):void this._measureAvailableWidth()}},_measureAvailableWidth:function(){var a=this;window.requestAnimationFrame(function(){var b=a.$.container,c=a.$.actions;if(b&&c){var d=b.getBoundingClientRect().width,e=c.getBoundingClientRect().width,f=d-e;a._availableWidth!==f&&a.set('_availableWidth',f)}})},rebuild:function(){if(this.items&&Array.isArray(this.items)&&(this.collapseAll||this.vertical||'number'===typeof this._availableWidth)){if(this.vertical)return this._setVisibleItems(this.items.slice(0)),this._setOverflowedItems([]),[this.visibleItems,this.overflowedItems];if(this.collapseAll||0===this._availableWidth||'number'===typeof this.collapseAt&&this._availableWidth<=this.collapseAt)return this._setVisibleItems([]),this._setOverflowedItems(this.items.slice(0)),this.fire('px-app-nav-rebuilt'),[this.visibleItems,this.overflowedItems];var a=this._measureItems(this.items),b=this._fitItems(this.items,a,this._availableWidth),c=b.visible,d=b.overflowed;return 1===c.length&&1<this.items.length?(this._setVisibleItems([]),this._setOverflowedItems(this.items.slice(0)),this.fire('px-app-nav-rebuilt'),[this.visibleItems,this.overflowedItems]):(this._setVisibleItems(c),this._setOverflowedItems(d),this.notifyPath('visibleItems.*'),this.notifyPath('overflowedItems.*'),this.fire('px-app-nav-rebuilt'),[this.visibleItems,this.overflowedItems])}},_fitItems:function(a,b,c){var d=c;if(d<b[0])return{visible:[],overflowed:a.slice(0)};for(var e=0,f=a.length;e<f&&0<d&&!(b[e]>d);)d-=b[e],e++;var g=this._getItemStyles(),h=g.itemPadding,i=g.iconSize,j=2*h+i;if(e!==f&&d<j)for(d-=j;0<e&&0>d;)d+=b[e],e--;return{visible:a.slice(0,e),overflowed:a.slice(e)}},_measureItems:function(a){var b=this._measureItem.bind(this);return a.map(b)},_measureItem:function(a){var b=this._getItemStyles(),c=b.fontFamily,d=b.fontSize,e=b.itemPadding,f=b.iconSize,g=b.iconPadding,h=b.openIconSize,i=b.openIconPadding,j=this._measureText(a[this.keys.label],c,d);if(j){var k=j;return k+=2*e,a[this.keys.icon]&&a[this.keys.icon].length&&(k+=f+g),a[this.keys.children]&&a[this.keys.children].length&&(k+=h+i),k}},_getItemStyles:function(){var a=this;if(!this._fontStyleCache){var b=window.getComputedStyle(this),c=b.fontSize,d=b.fontFamily,e=function(b){return a._remToPx(parseFloat(b))},f=function(b,d){return a._parseSizeStyleVar(b,e(d),parseInt(c))},g=f('--px-app-nav-item-padding',this._statics.ITEM_PADDING),h=f('--px-app-nav-item-icon-size',this._statics.ITEM_ICON_WIDTH),i=e(this._statics.ITEM_ICON_PADDING),j=e(this._statics.OPEN_ICON_WIDTH),k=e(this._statics.OPEN_ICON_PADDING);this._fontStyleCache={fontSize:c,fontFamily:d,itemPadding:g,iconSize:h,iconPadding:i,openIconSize:j,openIconPadding:k}}return this._fontStyleCache},_parseSizeStyleVar:function(a,b,c){var d=this.getComputedStyleValue(a);return'string'===typeof d&&'px'===d.slice(-2)?parseInt(d):'string'===typeof d&&'em'===d.slice(-2)?c*parseFloat(d):'string'===typeof d&&'rem'===d.slice(-2)?this._remToPx(parseFloat(d)):b},_remToPx:function(a){var b=this._documentRemBaseCache=this._documentRemBaseCache||parseInt(window.getComputedStyle(document.documentElement).fontSize);return Math.round(a*b)},_getDropdownLabel:function(a,b,c,d,e){return e&&b&&'object'===('undefined'===typeof b?'undefined':babelHelpers.typeof(b))&&!d?b[c]:e&&a&&'object'===('undefined'===typeof a?'undefined':babelHelpers.typeof(a))&&!d?a[c]:null},_getDropdownIcon:function(a,b,c,d,e,f,g){return f&&!e?'px-utl:overflow':e&&d&&!g?'px-nav:hamburger':e&&d&&g?'px-nav:close':e&&b&&'object'===('undefined'===typeof b?'undefined':babelHelpers.typeof(b))?b[c]:e&&a&&'object'===('undefined'===typeof a?'undefined':babelHelpers.typeof(a))?a[c]:null},_getDropdownWidth:function(a){if(a){var b=parseInt(this.getComputedStyleValue('--px-app-nav-collapsed-width'));return isNaN(b)?320:b}},_getItemProp:function(a,b){return a[b]},_isCollapsedCaratHidden:function(a,b){return!a||b},_isCollapsedDropdownEmpty:function(a,b,c){return b&&!c&&(!a||'object'!==('undefined'===typeof a?'undefined':babelHelpers.typeof(a)))},_isItemSelected:function(a,b){return a&&b&&a===b},_isItemVisible:function(a){return a&&this.visibleItems&&Array.isArray(this.visibleItems)&&-1!==this.visibleItems.indexOf(a)},_isItemOverflowed:function(a){return a&&this.overflowedItems&&Array.isArray(this.overflowedItems)&&-1!==this.overflowedItems.indexOf(a)},_isItemParent:function(a,b){return a.hasOwnProperty(b)&&Array.isArray(a[b])&&0<a[b].length},_isItemNotParent:function(a,b){return!a.hasOwnProperty(b)||!Array.isArray(a[b])||0===a[b].length},_isSelectedOverflowed:function(a,b,c){return a&&c&&Array.isArray(c)&&c.length&&(b?-1!==c.indexOf(b):-1!==c.indexOf(a))},_isIconEmpty:function(a,b){return!a.hasOwnProperty(b)||'string'!==typeof a[b]&&0<=a[b].length},_computeAnyOverflowed:function(a){return Array.isArray(a)&&0<a.length},_computeAllCollapsed:function(a,b){return Array.isArray(a)&&0<a.length&&Array.isArray(b)&&0===b.length},_computeSomeOverflowed:function(a,b){return Array.isArray(a)&&0<a.length&&Array.isArray(b)&&0<b.length}})})();